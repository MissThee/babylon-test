import{x as t,r as h,L as p,O as r}from"./test1.990751a6.js";import{A as n}from"./abstractMesh.8bf71ac2.js";import{P as c}from"./physicsEngine.3d5bd84b.js";import{P as y}from"./physicsJoint.16ce030f.js";import"../entry/index.a3769e15.js";import"./node.0c51c0e0.js";import"./math.axis.aa7ca8fa.js";import"./boundingInfo.71d69726.js";import"./math.functions.ef221795.js";t.prototype.getPhysicsEngine=function(){return this._physicsEngine};t.prototype.enablePhysics=function(s,i){if(s===void 0&&(s=null),this._physicsEngine)return!0;var e=this._getComponent(h.NAME_PHYSICSENGINE);e||(e=new m(this),this._addComponent(e));try{return this._physicsEngine=new c(s,i),this._physicsTimeAccumulator=0,!0}catch(o){return p.Error(o.message),!1}};t.prototype.disablePhysicsEngine=function(){!this._physicsEngine||(this._physicsEngine.dispose(),this._physicsEngine=null)};t.prototype.isPhysicsEnabled=function(){return this._physicsEngine!==void 0};t.prototype.deleteCompoundImpostor=function(s){var i=s.parts[0].mesh;i.physicsImpostor&&(i.physicsImpostor.dispose(),i.physicsImpostor=null)};t.prototype._advancePhysicsEngineStep=function(s){if(this._physicsEngine){var i=this._physicsEngine.getSubTimeStep();if(i>0)for(this._physicsTimeAccumulator+=s;this._physicsTimeAccumulator>i;)this.onBeforePhysicsObservable.notifyObservers(this),this._physicsEngine._step(i/1e3),this.onAfterPhysicsObservable.notifyObservers(this),this._physicsTimeAccumulator-=i;else this.onBeforePhysicsObservable.notifyObservers(this),this._physicsEngine._step(s/1e3),this.onAfterPhysicsObservable.notifyObservers(this)}};Object.defineProperty(n.prototype,"physicsImpostor",{get:function(){return this._physicsImpostor},set:function(s){var i=this;this._physicsImpostor!==s&&(this._disposePhysicsObserver&&this.onDisposeObservable.remove(this._disposePhysicsObserver),this._physicsImpostor=s,s&&(this._disposePhysicsObserver=this.onDisposeObservable.add(function(){i.physicsImpostor&&(i.physicsImpostor.dispose(),i.physicsImpostor=null)})))},enumerable:!0,configurable:!0});n.prototype.getPhysicsImpostor=function(){return this.physicsImpostor};n.prototype.applyImpulse=function(s,i){return this.physicsImpostor?(this.physicsImpostor.applyImpulse(s,i),this):this};n.prototype.setPhysicsLinkWith=function(s,i,e,o){return!this.physicsImpostor||!s.physicsImpostor?this:(this.physicsImpostor.createJoint(s.physicsImpostor,y.HingeJoint,{mainPivot:i,connectedPivot:e,nativeParams:o}),this)};var m=function(){function s(i){var e=this;this.name=h.NAME_PHYSICSENGINE,this.scene=i,this.scene.onBeforePhysicsObservable=new r,this.scene.onAfterPhysicsObservable=new r,this.scene.getDeterministicFrameTime=function(){return e.scene._physicsEngine?e.scene._physicsEngine.getTimeStep()*1e3:1e3/60}}return s.prototype.register=function(){},s.prototype.rebuild=function(){},s.prototype.dispose=function(){this.scene.onBeforePhysicsObservable.clear(),this.scene.onAfterPhysicsObservable.clear(),this.scene._physicsEngine&&this.scene.disablePhysicsEngine()},s}();export{m as PhysicsEngineSceneComponent};
