import{T as S}from"./decorators.033fe02c.js";import{L as y,a as C,O as k}from"./precisionDate.911053b8.js";import{Vector3 as b}from"./math.vector.dbc48609.js";import{Engine as n}from"./engine.030dae1e.js";import{E as x}from"./performanceConfigurator.3a0adc9f.js";var w=function(){function o(i,t,a,e,s){e===void 0&&(e=null);var r=this,c,u,_,f,p;if(this.autoplay=!1,this._loop=!1,this.useCustomAttenuation=!1,this.isPlaying=!1,this.isPaused=!1,this.refDistance=1,this.rolloffFactor=1,this.maxDistance=100,this.distanceModel="linear",this.metadata=null,this.onEndedObservable=new k,this._spatialSound=!1,this._panningModel="equalpower",this._playbackRate=1,this._streaming=!1,this._startTime=0,this._startOffset=0,this._position=b.Zero(),this._localDirection=new b(1,0,0),this._volume=1,this._isReadyToPlay=!1,this._isDirectional=!1,this._coneInnerAngle=360,this._coneOuterAngle=360,this._coneOuterGain=0,this._isOutputConnected=!1,this._urlType="Unknown",this.name=i,a=a||x.LastCreatedScene,!!a)if(this._scene=a,o._SceneComponentInitialization(a),this._readyToPlayCallback=e,this._customAttenuationFunction=function(E,d,A,M,D){return d<A?E*(1-d/A):0},s&&(this.autoplay=s.autoplay||!1,this._loop=s.loop||!1,s.volume!==void 0&&(this._volume=s.volume),this._spatialSound=(c=s.spatialSound)!==null&&c!==void 0?c:!1,this.maxDistance=(u=s.maxDistance)!==null&&u!==void 0?u:100,this.useCustomAttenuation=(_=s.useCustomAttenuation)!==null&&_!==void 0?_:!1,this.rolloffFactor=s.rolloffFactor||1,this.refDistance=s.refDistance||1,this.distanceModel=s.distanceModel||"linear",this._playbackRate=s.playbackRate||1,this._streaming=(f=s.streaming)!==null&&f!==void 0?f:!1,this._length=s.length,this._offset=s.offset),((p=n.audioEngine)===null||p===void 0?void 0:p.canUseWebAudio)&&n.audioEngine.audioContext){this._soundGain=n.audioEngine.audioContext.createGain(),this._soundGain.gain.value=this._volume,this._inputAudioNode=this._soundGain,this._outputAudioNode=this._soundGain,this._spatialSound&&this._createSpatialParameters(),this._scene.mainSoundTrack.addSound(this);var l=!0;if(t)try{typeof t=="string"?this._urlType="String":t instanceof ArrayBuffer?this._urlType="ArrayBuffer":t instanceof HTMLMediaElement?this._urlType="MediaElement":t instanceof MediaStream?this._urlType="MediaStream":Array.isArray(t)&&(this._urlType="Array");var m=[],g=!1;switch(this._urlType){case"MediaElement":this._streaming=!0,this._isReadyToPlay=!0,this._streamingSource=n.audioEngine.audioContext.createMediaElementSource(t),this.autoplay&&this.play(0,this._offset,this._length),this._readyToPlayCallback&&this._readyToPlayCallback();break;case"MediaStream":this._streaming=!0,this._isReadyToPlay=!0,this._streamingSource=n.audioEngine.audioContext.createMediaStreamSource(t),this.autoplay&&this.play(0,this._offset,this._length),this._readyToPlayCallback&&this._readyToPlayCallback();break;case"ArrayBuffer":t.byteLength>0&&(g=!0,this._soundLoaded(t));break;case"String":m.push(t);case"Array":m.length===0&&(m=t);for(var v=function(E){var d=m[E];if(g=s&&s.skipCodecCheck||d.indexOf(".mp3",d.length-4)!==-1&&n.audioEngine.isMP3supported||d.indexOf(".ogg",d.length-4)!==-1&&n.audioEngine.isOGGsupported||d.indexOf(".wav",d.length-4)!==-1||d.indexOf(".m4a",d.length-4)!==-1||d.indexOf(".mp4",d.length-4)!==-1||d.indexOf("blob:")!==-1,g)return h._streaming?(h._htmlAudioElement=new Audio(d),h._htmlAudioElement.controls=!1,h._htmlAudioElement.loop=h.loop,S.SetCorsBehavior(d,h._htmlAudioElement),h._htmlAudioElement.preload="auto",h._htmlAudioElement.addEventListener("canplaythrough",function(){r._isReadyToPlay=!0,r.autoplay&&r.play(0,r._offset,r._length),r._readyToPlayCallback&&r._readyToPlayCallback()}),document.body.appendChild(h._htmlAudioElement),h._htmlAudioElement.load()):h._scene._loadFile(d,function(A){r._soundLoaded(A)},void 0,!0,!0,function(A){A&&y.Error("XHR "+A.status+" error on: "+d+"."),y.Error("Sound creation aborted."),r._scene.mainSoundTrack.removeSound(r)}),"break"},h=this,P=0;P<m.length;P++){var T=v(P);if(T==="break")break}break;default:l=!1;break}l?g||(this._isReadyToPlay=!0,this._readyToPlayCallback&&window.setTimeout(function(){r._readyToPlayCallback&&r._readyToPlayCallback()},1e3)):y.Error("Parameter must be a URL to the sound, an Array of URLs (.mp3 & .ogg) or an ArrayBuffer of the sound.")}catch{y.Error("Unexpected error. Sound creation aborted."),this._scene.mainSoundTrack.removeSound(this)}}else this._scene.mainSoundTrack.addSound(this),n.audioEngine&&!n.audioEngine.WarnedWebAudioUnsupported&&(y.Error("Web Audio is not supported by your browser."),n.audioEngine.WarnedWebAudioUnsupported=!0),this._readyToPlayCallback&&window.setTimeout(function(){r._readyToPlayCallback&&r._readyToPlayCallback()},1e3)}return Object.defineProperty(o.prototype,"loop",{get:function(){return this._loop},set:function(i){i!==this._loop&&(this._loop=i,this.updateOptions({loop:i}))},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"currentTime",{get:function(){var i;if(this._htmlAudioElement)return this._htmlAudioElement.currentTime;var t=this._startOffset;return this.isPlaying&&((i=n.audioEngine)===null||i===void 0?void 0:i.audioContext)&&(t+=n.audioEngine.audioContext.currentTime-this._startTime),t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"spatialSound",{get:function(){return this._spatialSound},set:function(i){var t;this._spatialSound=i,this._spatialSound&&((t=n.audioEngine)===null||t===void 0?void 0:t.canUseWebAudio)&&n.audioEngine.audioContext&&this._createSpatialParameters()},enumerable:!1,configurable:!0}),o.prototype.dispose=function(){var i;!((i=n.audioEngine)===null||i===void 0)&&i.canUseWebAudio&&(this.isPlaying&&this.stop(),this._isReadyToPlay=!1,this.soundTrackId===-1?this._scene.mainSoundTrack.removeSound(this):this._scene.soundTracks&&this._scene.soundTracks[this.soundTrackId].removeSound(this),this._soundGain&&(this._soundGain.disconnect(),this._soundGain=null),this._soundPanner&&(this._soundPanner.disconnect(),this._soundPanner=null),this._soundSource&&(this._soundSource.disconnect(),this._soundSource=null),this._audioBuffer=null,this._htmlAudioElement&&(this._htmlAudioElement.pause(),this._htmlAudioElement.src="",document.body.removeChild(this._htmlAudioElement)),this._streamingSource&&this._streamingSource.disconnect(),this._connectedTransformNode&&this._registerFunc&&(this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._connectedTransformNode=null))},o.prototype.isReady=function(){return this._isReadyToPlay},o.prototype.getClassName=function(){return"Sound"},o.prototype._soundLoaded=function(i){var t=this,a;!(!((a=n.audioEngine)===null||a===void 0)&&a.audioContext)||n.audioEngine.audioContext.decodeAudioData(i,function(e){t._audioBuffer=e,t._isReadyToPlay=!0,t.autoplay&&t.play(0,t._offset,t._length),t._readyToPlayCallback&&t._readyToPlayCallback()},function(e){y.Error("Error while decoding audio data for: "+t.name+" / Error: "+e)})},o.prototype.setAudioBuffer=function(i){var t;!((t=n.audioEngine)===null||t===void 0)&&t.canUseWebAudio&&(this._audioBuffer=i,this._isReadyToPlay=!0)},o.prototype.updateOptions=function(i){var t,a,e,s,r,c,u,_,f,p;i&&(this.loop=(t=i.loop)!==null&&t!==void 0?t:this.loop,this.maxDistance=(a=i.maxDistance)!==null&&a!==void 0?a:this.maxDistance,this.useCustomAttenuation=(e=i.useCustomAttenuation)!==null&&e!==void 0?e:this.useCustomAttenuation,this.rolloffFactor=(s=i.rolloffFactor)!==null&&s!==void 0?s:this.rolloffFactor,this.refDistance=(r=i.refDistance)!==null&&r!==void 0?r:this.refDistance,this.distanceModel=(c=i.distanceModel)!==null&&c!==void 0?c:this.distanceModel,this._playbackRate=(u=i.playbackRate)!==null&&u!==void 0?u:this._playbackRate,this._length=(_=i.length)!==null&&_!==void 0?_:void 0,this._offset=(f=i.offset)!==null&&f!==void 0?f:void 0,this.setVolume((p=i.volume)!==null&&p!==void 0?p:this._volume),this._updateSpatialParameters(),this.isPlaying&&(this._streaming&&this._htmlAudioElement?(this._htmlAudioElement.playbackRate=this._playbackRate,this._htmlAudioElement.loop!==this.loop&&(this._htmlAudioElement.loop=this.loop)):this._soundSource&&(this._soundSource.playbackRate.value=this._playbackRate,this._soundSource.loop!==this.loop&&(this._soundSource.loop=this.loop),this._offset!==void 0&&this._soundSource.loopStart!==this._offset&&(this._soundSource.loopStart=this._offset),this._length!==void 0&&this._length!==this._soundSource.loopEnd&&(this._soundSource.loopEnd=(this._offset|0)+this._length))))},o.prototype._createSpatialParameters=function(){var i,t;((i=n.audioEngine)===null||i===void 0?void 0:i.canUseWebAudio)&&n.audioEngine.audioContext&&(this._scene.headphone&&(this._panningModel="HRTF"),this._soundPanner=(t=this._soundPanner)!==null&&t!==void 0?t:n.audioEngine.audioContext.createPanner(),this._soundPanner&&this._outputAudioNode&&(this._updateSpatialParameters(),this._soundPanner.connect(this._outputAudioNode),this._inputAudioNode=this._soundPanner))},o.prototype._updateSpatialParameters=function(){this._spatialSound&&this._soundPanner&&(this.useCustomAttenuation?(this._soundPanner.distanceModel="linear",this._soundPanner.maxDistance=Number.MAX_VALUE,this._soundPanner.refDistance=1,this._soundPanner.rolloffFactor=1,this._soundPanner.panningModel=this._panningModel):(this._soundPanner.distanceModel=this.distanceModel,this._soundPanner.maxDistance=this.maxDistance,this._soundPanner.refDistance=this.refDistance,this._soundPanner.rolloffFactor=this.rolloffFactor,this._soundPanner.panningModel=this._panningModel))},o.prototype.switchPanningModelToHRTF=function(){this._panningModel="HRTF",this._switchPanningModel()},o.prototype.switchPanningModelToEqualPower=function(){this._panningModel="equalpower",this._switchPanningModel()},o.prototype._switchPanningModel=function(){var i;((i=n.audioEngine)===null||i===void 0?void 0:i.canUseWebAudio)&&this._spatialSound&&this._soundPanner&&(this._soundPanner.panningModel=this._panningModel)},o.prototype.connectToSoundTrackAudioNode=function(i){var t;((t=n.audioEngine)===null||t===void 0?void 0:t.canUseWebAudio)&&this._outputAudioNode&&(this._isOutputConnected&&this._outputAudioNode.disconnect(),this._outputAudioNode.connect(i),this._isOutputConnected=!0)},o.prototype.setDirectionalCone=function(i,t,a){if(t<i){y.Error("setDirectionalCone(): outer angle of the cone must be superior or equal to the inner angle.");return}this._coneInnerAngle=i,this._coneOuterAngle=t,this._coneOuterGain=a,this._isDirectional=!0,this.isPlaying&&this.loop&&(this.stop(),this.play(0,this._offset,this._length))},Object.defineProperty(o.prototype,"directionalConeInnerAngle",{get:function(){return this._coneInnerAngle},set:function(i){var t;if(i!=this._coneInnerAngle){if(this._coneOuterAngle<i){y.Error("directionalConeInnerAngle: outer angle of the cone must be superior or equal to the inner angle.");return}this._coneInnerAngle=i,((t=n.audioEngine)===null||t===void 0?void 0:t.canUseWebAudio)&&this._spatialSound&&this._soundPanner&&(this._soundPanner.coneInnerAngle=this._coneInnerAngle)}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"directionalConeOuterAngle",{get:function(){return this._coneOuterAngle},set:function(i){var t;if(i!=this._coneOuterAngle){if(i<this._coneInnerAngle){y.Error("directionalConeOuterAngle: outer angle of the cone must be superior or equal to the inner angle.");return}this._coneOuterAngle=i,((t=n.audioEngine)===null||t===void 0?void 0:t.canUseWebAudio)&&this._spatialSound&&this._soundPanner&&(this._soundPanner.coneOuterAngle=this._coneOuterAngle)}},enumerable:!1,configurable:!0}),o.prototype.setPosition=function(i){var t;i.equals(this._position)||(this._position.copyFrom(i),((t=n.audioEngine)===null||t===void 0?void 0:t.canUseWebAudio)&&this._spatialSound&&this._soundPanner&&!isNaN(this._position.x)&&!isNaN(this._position.y)&&!isNaN(this._position.z)&&(this._soundPanner.positionX.value=this._position.x,this._soundPanner.positionY.value=this._position.y,this._soundPanner.positionZ.value=this._position.z))},o.prototype.setLocalDirectionToMesh=function(i){var t;this._localDirection=i,((t=n.audioEngine)===null||t===void 0?void 0:t.canUseWebAudio)&&this._connectedTransformNode&&this.isPlaying&&this._updateDirection()},o.prototype._updateDirection=function(){if(!(!this._connectedTransformNode||!this._soundPanner)){var i=this._connectedTransformNode.getWorldMatrix(),t=b.TransformNormal(this._localDirection,i);t.normalize(),this._soundPanner.orientationX.value=t.x,this._soundPanner.orientationY.value=t.y,this._soundPanner.orientationZ.value=t.z}},o.prototype.updateDistanceFromListener=function(){var i;if(((i=n.audioEngine)===null||i===void 0?void 0:i.canUseWebAudio)&&this._connectedTransformNode&&this.useCustomAttenuation&&this._soundGain&&this._scene.activeCamera){var t=this._connectedTransformNode.getDistanceToCamera(this._scene.activeCamera);this._soundGain.gain.value=this._customAttenuationFunction(this._volume,t,this.maxDistance,this.refDistance,this.rolloffFactor)}},o.prototype.setAttenuationFunction=function(i){this._customAttenuationFunction=i},o.prototype.play=function(i,t,a){var e=this,s,r,c,u;if(this._isReadyToPlay&&this._scene.audioEnabled&&((s=n.audioEngine)===null||s===void 0?void 0:s.audioContext))try{this._startOffset<0&&(i=-this._startOffset,this._startOffset=0);var _=i?((r=n.audioEngine)===null||r===void 0?void 0:r.audioContext.currentTime)+i:(c=n.audioEngine)===null||c===void 0?void 0:c.audioContext.currentTime;if((!this._soundSource||!this._streamingSource)&&this._spatialSound&&this._soundPanner&&(!isNaN(this._position.x)&&!isNaN(this._position.y)&&!isNaN(this._position.z)&&(this._soundPanner.positionX.value=this._position.x,this._soundPanner.positionY.value=this._position.y,this._soundPanner.positionZ.value=this._position.z),this._isDirectional&&(this._soundPanner.coneInnerAngle=this._coneInnerAngle,this._soundPanner.coneOuterAngle=this._coneOuterAngle,this._soundPanner.coneOuterGain=this._coneOuterGain,this._connectedTransformNode?this._updateDirection():this._soundPanner.setOrientation(this._localDirection.x,this._localDirection.y,this._localDirection.z))),this._streaming){if(this._streamingSource||(this._streamingSource=n.audioEngine.audioContext.createMediaElementSource(this._htmlAudioElement),this._htmlAudioElement.onended=function(){e._onended()},this._htmlAudioElement.playbackRate=this._playbackRate),this._streamingSource.disconnect(),this._inputAudioNode&&this._streamingSource.connect(this._inputAudioNode),this._htmlAudioElement){var f=function(){var l,m;if(!((l=n.audioEngine)===null||l===void 0)&&l.unlocked){var g=e._htmlAudioElement.play();g!==void 0&&g.catch(function(){var v,h;(v=n.audioEngine)===null||v===void 0||v.lock(),(e.loop||e.autoplay)&&((h=n.audioEngine)===null||h===void 0||h.onAudioUnlockedObservable.addOnce(function(){f()}))})}else(e.loop||e.autoplay)&&((m=n.audioEngine)===null||m===void 0||m.onAudioUnlockedObservable.addOnce(function(){f()}))};f()}}else{var p=function(){var l,m,g;if(!((l=n.audioEngine)===null||l===void 0)&&l.audioContext){if(a=a||e._length,t=t||e._offset,e._soundSource){var v=e._soundSource;v.onended=function(){v.disconnect()}}if(e._soundSource=(m=n.audioEngine)===null||m===void 0?void 0:m.audioContext.createBufferSource(),e._soundSource&&e._inputAudioNode){e._soundSource.buffer=e._audioBuffer,e._soundSource.connect(e._inputAudioNode),e._soundSource.loop=e.loop,t!==void 0&&(e._soundSource.loopStart=t),a!==void 0&&(e._soundSource.loopEnd=(t|0)+a),e._soundSource.playbackRate.value=e._playbackRate,e._soundSource.onended=function(){e._onended()},_=i?((g=n.audioEngine)===null||g===void 0?void 0:g.audioContext.currentTime)+i:n.audioEngine.audioContext.currentTime;var h=e.isPaused?e._startOffset%e._soundSource.buffer.duration:t||0;e._soundSource.start(_,h,e.loop?void 0:a)}}};((u=n.audioEngine)===null||u===void 0?void 0:u.audioContext.state)==="suspended"?setTimeout(function(){var l;((l=n.audioEngine)===null||l===void 0?void 0:l.audioContext.state)==="suspended"?(n.audioEngine.lock(),(e.loop||e.autoplay)&&n.audioEngine.onAudioUnlockedObservable.addOnce(function(){p()})):p()},500):p()}this._startTime=_,this.isPlaying=!0,this.isPaused=!1}catch(l){y.Error("Error while trying to play audio: "+this.name+", "+l.message)}},o.prototype._onended=function(){this.isPlaying=!1,this._startOffset=0,this.onended&&this.onended(),this.onEndedObservable.notifyObservers(this)},o.prototype.stop=function(i){var t=this,a;if(this.isPlaying){if(this._streaming)this._htmlAudioElement?(this._htmlAudioElement.pause(),this._htmlAudioElement.currentTime>0&&(this._htmlAudioElement.currentTime=0)):this._streamingSource.disconnect(),this.isPlaying=!1;else if(((a=n.audioEngine)===null||a===void 0?void 0:a.audioContext)&&this._soundSource){var e=i?n.audioEngine.audioContext.currentTime+i:void 0;this._soundSource.stop(e),e===void 0?(this.isPlaying=!1,this._soundSource.onended=function(){}):this._soundSource.onended=function(){t.isPlaying=!1},this.isPaused||(this._startOffset=0)}}},o.prototype.pause=function(){var i;this.isPlaying&&(this.isPaused=!0,this._streaming?(this._htmlAudioElement?this._htmlAudioElement.pause():this._streamingSource.disconnect(),this.isPlaying=!1):!((i=n.audioEngine)===null||i===void 0)&&i.audioContext&&(this.stop(0),this._startOffset+=n.audioEngine.audioContext.currentTime-this._startTime))},o.prototype.setVolume=function(i,t){var a;((a=n.audioEngine)===null||a===void 0?void 0:a.canUseWebAudio)&&this._soundGain&&(t&&n.audioEngine.audioContext?(this._soundGain.gain.cancelScheduledValues(n.audioEngine.audioContext.currentTime),this._soundGain.gain.setValueAtTime(this._soundGain.gain.value,n.audioEngine.audioContext.currentTime),this._soundGain.gain.linearRampToValueAtTime(i,n.audioEngine.audioContext.currentTime+t)):this._soundGain.gain.value=i),this._volume=i},o.prototype.setPlaybackRate=function(i){this._playbackRate=i,this.isPlaying&&(this._streaming&&this._htmlAudioElement?this._htmlAudioElement.playbackRate=this._playbackRate:this._soundSource&&(this._soundSource.playbackRate.value=this._playbackRate))},o.prototype.getVolume=function(){return this._volume},o.prototype.attachToMesh=function(i){var t=this;this._connectedTransformNode&&this._registerFunc&&(this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._registerFunc=null),this._connectedTransformNode=i,this._spatialSound||(this._spatialSound=!0,this._createSpatialParameters(),this.isPlaying&&this.loop&&(this.stop(),this.play(0,this._offset,this._length))),this._onRegisterAfterWorldMatrixUpdate(this._connectedTransformNode),this._registerFunc=function(a){return t._onRegisterAfterWorldMatrixUpdate(a)},this._connectedTransformNode.registerAfterWorldMatrixUpdate(this._registerFunc)},o.prototype.detachFromMesh=function(){this._connectedTransformNode&&this._registerFunc&&(this._connectedTransformNode.unregisterAfterWorldMatrixUpdate(this._registerFunc),this._registerFunc=null,this._connectedTransformNode=null)},o.prototype._onRegisterAfterWorldMatrixUpdate=function(i){var t;if(!i.getBoundingInfo)this.setPosition(i.absolutePosition);else{var a=i,e=a.getBoundingInfo();this.setPosition(e.boundingSphere.centerWorld)}((t=n.audioEngine)===null||t===void 0?void 0:t.canUseWebAudio)&&this._isDirectional&&this.isPlaying&&this._updateDirection()},o.prototype.clone=function(){var i=this;if(this._streaming)return null;var t=function(){i._isReadyToPlay?(e._audioBuffer=i.getAudioBuffer(),e._isReadyToPlay=!0,e.autoplay&&e.play(0,i._offset,i._length)):window.setTimeout(t,300)},a={autoplay:this.autoplay,loop:this.loop,volume:this._volume,spatialSound:this._spatialSound,maxDistance:this.maxDistance,useCustomAttenuation:this.useCustomAttenuation,rolloffFactor:this.rolloffFactor,refDistance:this.refDistance,distanceModel:this.distanceModel},e=new o(this.name+"_cloned",new ArrayBuffer(0),this._scene,null,a);return this.useCustomAttenuation&&e.setAttenuationFunction(this._customAttenuationFunction),e.setPosition(this._position),e.setPlaybackRate(this._playbackRate),t(),e},o.prototype.getAudioBuffer=function(){return this._audioBuffer},o.prototype.getSoundSource=function(){return this._soundSource},o.prototype.getSoundGain=function(){return this._soundGain},o.prototype.serialize=function(){var i={name:this.name,url:this.name,autoplay:this.autoplay,loop:this.loop,volume:this._volume,spatialSound:this._spatialSound,maxDistance:this.maxDistance,rolloffFactor:this.rolloffFactor,refDistance:this.refDistance,distanceModel:this.distanceModel,playbackRate:this._playbackRate,panningModel:this._panningModel,soundTrackId:this.soundTrackId,metadata:this.metadata};return this._spatialSound&&(this._connectedTransformNode&&(i.connectedMeshId=this._connectedTransformNode.id),i.position=this._position.asArray(),i.refDistance=this.refDistance,i.distanceModel=this.distanceModel,i.isDirectional=this._isDirectional,i.localDirectionToMesh=this._localDirection.asArray(),i.coneInnerAngle=this._coneInnerAngle,i.coneOuterAngle=this._coneOuterAngle,i.coneOuterGain=this._coneOuterGain),i},o.Parse=function(i,t,a,e){var s=i.name,r;i.url?r=a+i.url:r=a+s;var c={autoplay:i.autoplay,loop:i.loop,volume:i.volume,spatialSound:i.spatialSound,maxDistance:i.maxDistance,rolloffFactor:i.rolloffFactor,refDistance:i.refDistance,distanceModel:i.distanceModel,playbackRate:i.playbackRate},u;if(!e)u=new o(s,r,t,function(){t._removePendingData(u)},c),t._addPendingData(u);else{var _=function(){e._isReadyToPlay?(u._audioBuffer=e.getAudioBuffer(),u._isReadyToPlay=!0,u.autoplay&&u.play(0,u._offset,u._length)):window.setTimeout(_,300)};u=new o(s,new ArrayBuffer(0),t,null,c),_()}if(i.position){var f=b.FromArray(i.position);u.setPosition(f)}if(i.isDirectional&&(u.setDirectionalCone(i.coneInnerAngle||360,i.coneOuterAngle||360,i.coneOuterGain||0),i.localDirectionToMesh)){var p=b.FromArray(i.localDirectionToMesh);u.setLocalDirectionToMesh(p)}if(i.connectedMeshId){var l=t.getMeshById(i.connectedMeshId);l&&u.attachToMesh(l)}return i.metadata&&(u.metadata=i.metadata),u},o._SceneComponentInitialization=function(i){throw C("AudioSceneComponent")},o}();export{w as S};
