import{a as yt}from"./tslibtslib.b6e59fa7.js";import{A as Y,R as et,ai as pt,L as tt}from"./@babylonjscore_Misc.329df4d9.js";import{E as bt,P as rt}from"./@babylonjscore_Engines.a7c830c0.js";var R=function(){function n(){}return n.WithinEpsilon=function(t,r,o){return o===void 0&&(o=1401298e-51),Math.abs(t-r)<=o},n.ToHex=function(t){var r=t.toString(16);return t<=15?("0"+r).toUpperCase():r.toUpperCase()},n.Sign=function(t){return t=+t,t===0||isNaN(t)?t:t>0?1:-1},n.Clamp=function(t,r,o){return r===void 0&&(r=0),o===void 0&&(o=1),Math.min(o,Math.max(r,t))},n.Log2=function(t){return Math.log(t)*Math.LOG2E},n.ILog2=function(t){if(Math.log2)return Math.floor(Math.log2(t));if(t<0)return NaN;if(t===0)return-1/0;var r=0;if(t<1){for(;t<1;)r++,t=t*2;r=-r}else if(t>1)for(;t>1;)r++,t=Math.floor(t/2);return r},n.Repeat=function(t,r){return t-Math.floor(t/r)*r},n.Normalize=function(t,r,o){return(t-r)/(o-r)},n.Denormalize=function(t,r,o){return t*(o-r)+r},n.DeltaAngle=function(t,r){var o=n.Repeat(r-t,360);return o>180&&(o-=360),o},n.PingPong=function(t,r){var o=n.Repeat(t,r*2);return r-Math.abs(o-r)},n.SmoothStep=function(t,r,o){var i=n.Clamp(o);return i=-2*i*i*i+3*i*i,r*i+t*(1-i)},n.MoveTowards=function(t,r,o){var i=0;return Math.abs(r-t)<=o?i=r:i=t+n.Sign(r-t)*o,i},n.MoveTowardsAngle=function(t,r,o){var i=n.DeltaAngle(t,r),e=0;return-o<i&&i<o?e=r:(r=t+i,e=n.MoveTowards(t,r,o)),e},n.Lerp=function(t,r,o){return t+(r-t)*o},n.LerpAngle=function(t,r,o){var i=n.Repeat(r-t,360);return i>180&&(i-=360),t+i*n.Clamp(o)},n.InverseLerp=function(t,r,o){var i=0;return t!=r?i=n.Clamp((o-t)/(r-t)):i=0,i},n.Hermite=function(t,r,o,i,e){var a=e*e,s=e*a,h=2*s-3*a+1,u=-2*s+3*a,c=s-2*a+e,f=s-a;return t*h+o*u+r*c+i*f},n.Hermite1stDerivative=function(t,r,o,i,e){var a=e*e;return(a-e)*6*t+(3*a-4*e+1)*r+(-a+e)*6*o+(3*a-2*e)*i},n.RandomRange=function(t,r){return t===r?t:Math.random()*(r-t)+t},n.RangeToPercent=function(t,r,o){return(t-r)/(o-r)},n.PercentToRange=function(t,r,o){return(o-r)*t+r},n.NormalizeRadians=function(t){return t-=n.TwoPi*Math.floor((t+Math.PI)/n.TwoPi),t},n.HCF=function(t,r){var o=t%r;return o===0?r:n.HCF(r,o)},n.TwoPi=Math.PI*2,n}(),nt=1/2.2,ot=2.2,Zt=(1+Math.sqrt(5))/2,C=.001,O=function(n){return parseInt(n.toString().replace(/\W/g,""))},G=function(){function n(t,r){t===void 0&&(t=0),r===void 0&&(r=0),this.x=t,this.y=r}return n.prototype.toString=function(){return"{X: ".concat(this.x," Y: ").concat(this.y,"}")},n.prototype.getClassName=function(){return"Vector2"},n.prototype.getHashCode=function(){var t=O(this.x),r=O(this.y),o=t;return o=o*397^r,o},n.prototype.toArray=function(t,r){return r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,this},n.prototype.fromArray=function(t,r){return r===void 0&&(r=0),n.FromArrayToRef(t,r,this),this},n.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},n.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},n.prototype.copyFromFloats=function(t,r){return this.x=t,this.y=r,this},n.prototype.set=function(t,r){return this.copyFromFloats(t,r)},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.addToRef=function(t,r){return r.x=this.x+t.x,r.y=this.y+t.y,this},n.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this},n.prototype.addVector3=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.subtractToRef=function(t,r){return r.x=this.x-t.x,r.y=this.y-t.y,this},n.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this},n.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this},n.prototype.multiply=function(t){return new n(this.x*t.x,this.y*t.y)},n.prototype.multiplyToRef=function(t,r){return r.x=this.x*t.x,r.y=this.y*t.y,this},n.prototype.multiplyByFloats=function(t,r){return new n(this.x*t,this.y*r)},n.prototype.divide=function(t){return new n(this.x/t.x,this.y/t.y)},n.prototype.divideToRef=function(t,r){return r.x=this.x/t.x,r.y=this.y/t.y,this},n.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},n.prototype.negate=function(){return new n(-this.x,-this.y)},n.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this},n.prototype.negateToRef=function(t){return t.copyFromFloats(this.x*-1,this.y*-1)},n.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this},n.prototype.scale=function(t){var r=new n(0,0);return this.scaleToRef(t,r),r},n.prototype.scaleToRef=function(t,r){return r.x=this.x*t,r.y=this.y*t,this},n.prototype.scaleAndAddToRef=function(t,r){return r.x+=this.x*t,r.y+=this.y*t,this},n.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y},n.prototype.equalsWithEpsilon=function(t,r){return r===void 0&&(r=C),t&&R.WithinEpsilon(this.x,t.x,r)&&R.WithinEpsilon(this.y,t.y,r)},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y))},n.prototype.fract=function(){return new n(this.x-Math.floor(this.x),this.y-Math.floor(this.y))},n.prototype.rotateToRef=function(t,r){var o=Math.cos(t),i=Math.sin(t);return r.x=o*this.x-i*this.y,r.y=i*this.x+o*this.y,this},n.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},n.prototype.normalize=function(){return n.NormalizeToRef(this,this),this},n.prototype.clone=function(){return new n(this.x,this.y)},n.Zero=function(){return new n(0,0)},n.One=function(){return new n(1,1)},Object.defineProperty(n,"ZeroReadOnly",{get:function(){return n._ZeroReadOnly},enumerable:!1,configurable:!0}),n.FromArray=function(t,r){return r===void 0&&(r=0),new n(t[r],t[r+1])},n.FromArrayToRef=function(t,r,o){o.x=t[r],o.y=t[r+1]},n.CatmullRom=function(t,r,o,i,e){var a=e*e,s=e*a,h=.5*(2*r.x+(-t.x+o.x)*e+(2*t.x-5*r.x+4*o.x-i.x)*a+(-t.x+3*r.x-3*o.x+i.x)*s),u=.5*(2*r.y+(-t.y+o.y)*e+(2*t.y-5*r.y+4*o.y-i.y)*a+(-t.y+3*r.y-3*o.y+i.y)*s);return new n(h,u)},n.Clamp=function(t,r,o){var i=t.x;i=i>o.x?o.x:i,i=i<r.x?r.x:i;var e=t.y;return e=e>o.y?o.y:e,e=e<r.y?r.y:e,new n(i,e)},n.Hermite=function(t,r,o,i,e){var a=e*e,s=e*a,h=2*s-3*a+1,u=-2*s+3*a,c=s-2*a+e,f=s-a,p=t.x*h+o.x*u+r.x*c+i.x*f,v=t.y*h+o.y*u+r.y*c+i.y*f;return new n(p,v)},n.Hermite1stDerivative=function(t,r,o,i,e){var a=n.Zero();return this.Hermite1stDerivativeToRef(t,r,o,i,e,a),a},n.Hermite1stDerivativeToRef=function(t,r,o,i,e,a){var s=e*e;a.x=(s-e)*6*t.x+(3*s-4*e+1)*r.x+(-s+e)*6*o.x+(3*s-2*e)*i.x,a.y=(s-e)*6*t.y+(3*s-4*e+1)*r.y+(-s+e)*6*o.y+(3*s-2*e)*i.y},n.Lerp=function(t,r,o){var i=t.x+(r.x-t.x)*o,e=t.y+(r.y-t.y)*o;return new n(i,e)},n.Dot=function(t,r){return t.x*r.x+t.y*r.y},n.Normalize=function(t){var r=n.Zero();return this.NormalizeToRef(t,r),r},n.NormalizeToRef=function(t,r){var o=t.length();o!==0&&(r.x=t.x/o,r.y=t.y/o)},n.Minimize=function(t,r){var o=t.x<r.x?t.x:r.x,i=t.y<r.y?t.y:r.y;return new n(o,i)},n.Maximize=function(t,r){var o=t.x>r.x?t.x:r.x,i=t.y>r.y?t.y:r.y;return new n(o,i)},n.Transform=function(t,r){var o=n.Zero();return n.TransformToRef(t,r,o),o},n.TransformToRef=function(t,r,o){var i=r.m,e=t.x*i[0]+t.y*i[4]+i[12],a=t.x*i[1]+t.y*i[5]+i[13];o.x=e,o.y=a},n.PointInTriangle=function(t,r,o,i){var e=.5*(-o.y*i.x+r.y*(-o.x+i.x)+r.x*(o.y-i.y)+o.x*i.y),a=e<0?-1:1,s=(r.y*i.x-r.x*i.y+(i.y-r.y)*t.x+(r.x-i.x)*t.y)*a,h=(r.x*o.y-r.y*o.x+(r.y-o.y)*t.x+(o.x-r.x)*t.y)*a;return s>0&&h>0&&s+h<2*e*a},n.Distance=function(t,r){return Math.sqrt(n.DistanceSquared(t,r))},n.DistanceSquared=function(t,r){var o=t.x-r.x,i=t.y-r.y;return o*o+i*i},n.Center=function(t,r){return n.CenterToRef(t,r,n.Zero())},n.CenterToRef=function(t,r,o){return o.copyFromFloats((t.x+r.x)/2,(t.y+r.y)/2)},n.DistanceOfPointFromSegment=function(t,r,o){var i=n.DistanceSquared(r,o);if(i===0)return n.Distance(t,r);var e=o.subtract(r),a=Math.max(0,Math.min(1,n.Dot(t.subtract(r),e)/i)),s=r.add(e.multiplyByFloats(a,a));return n.Distance(t,s)},n._ZeroReadOnly=n.Zero(),n}(),y=function(){function n(t,r,o){t===void 0&&(t=0),r===void 0&&(r=0),o===void 0&&(o=0),this._isDirty=!0,this._x=t,this._y=r,this._z=o}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this._isDirty=!0},enumerable:!1,configurable:!0}),n.prototype.toString=function(){return"{X: ".concat(this._x," Y: ").concat(this._y," Z: ").concat(this._z,"}")},n.prototype.getClassName=function(){return"Vector3"},n.prototype.getHashCode=function(){var t=O(this._x),r=O(this._y),o=O(this._z),i=t;return i=i*397^r,i=i*397^o,i},n.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},n.prototype.toArray=function(t,r){return r===void 0&&(r=0),t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,this},n.prototype.fromArray=function(t,r){return r===void 0&&(r=0),n.FromArrayToRef(t,r,this),this},n.prototype.toQuaternion=function(){return W.RotationYawPitchRoll(this._y,this._x,this._z)},n.prototype.addInPlace=function(t){return this.addInPlaceFromFloats(t._x,t._y,t._z)},n.prototype.addInPlaceFromFloats=function(t,r,o){return this.x+=t,this.y+=r,this.z+=o,this},n.prototype.add=function(t){return new n(this._x+t._x,this._y+t._y,this._z+t._z)},n.prototype.addToRef=function(t,r){return r.copyFromFloats(this._x+t._x,this._y+t._y,this._z+t._z)},n.prototype.subtractInPlace=function(t){return this.x-=t._x,this.y-=t._y,this.z-=t._z,this},n.prototype.subtract=function(t){return new n(this._x-t._x,this._y-t._y,this._z-t._z)},n.prototype.subtractToRef=function(t,r){return this.subtractFromFloatsToRef(t._x,t._y,t._z,r)},n.prototype.subtractFromFloats=function(t,r,o){return new n(this._x-t,this._y-r,this._z-o)},n.prototype.subtractFromFloatsToRef=function(t,r,o,i){return i.copyFromFloats(this._x-t,this._y-r,this._z-o)},n.prototype.negate=function(){return new n(-this._x,-this._y,-this._z)},n.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},n.prototype.negateToRef=function(t){return t.copyFromFloats(this._x*-1,this._y*-1,this._z*-1)},n.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this},n.prototype.scale=function(t){return new n(this._x*t,this._y*t,this._z*t)},n.prototype.scaleToRef=function(t,r){return r.copyFromFloats(this._x*t,this._y*t,this._z*t)},n.prototype.applyRotationQuaternionToRef=function(t,r){var o=t.w*this.x+t.y*this.z-t.z*this.y,i=t.w*this.y+t.z*this.x-t.x*this.z,e=t.w*this.z+t.x*this.y-t.y*this.x,a=-t.x*this.x-t.y*this.y-t.z*this.z;return r.x=o*t.w+a*-t.x+i*-t.z-e*-t.y,r.y=i*t.w+a*-t.y+e*-t.x-o*-t.z,r.z=e*t.w+a*-t.z+o*-t.y-i*-t.x,r},n.prototype.applyRotationQuaternionInPlace=function(t){return this.applyRotationQuaternionToRef(t,this)},n.prototype.applyRotationQuaternion=function(t){return this.applyRotationQuaternionToRef(t,n.Zero())},n.prototype.scaleAndAddToRef=function(t,r){return r.addInPlaceFromFloats(this._x*t,this._y*t,this._z*t)},n.prototype.projectOnPlane=function(t,r){var o=n.Zero();return this.projectOnPlaneToRef(t,r,o),o},n.prototype.projectOnPlaneToRef=function(t,r,o){var i=t.normal,e=t.d,a=l.Vector3[0];this.subtractToRef(r,a),a.normalize();var s=n.Dot(a,i);if(Math.abs(s)<Math.pow(10,-10))o.setAll(1/0);else{var h=-(n.Dot(r,i)+e)/s,u=a.scaleInPlace(h);r.addToRef(u,o)}},n.prototype.equals=function(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z},n.prototype.equalsWithEpsilon=function(t,r){return r===void 0&&(r=C),t&&R.WithinEpsilon(this._x,t._x,r)&&R.WithinEpsilon(this._y,t._y,r)&&R.WithinEpsilon(this._z,t._z,r)},n.prototype.equalsToFloats=function(t,r,o){return this._x===t&&this._y===r&&this._z===o},n.prototype.multiplyInPlace=function(t){return this.x*=t._x,this.y*=t._y,this.z*=t._z,this},n.prototype.multiply=function(t){return this.multiplyByFloats(t._x,t._y,t._z)},n.prototype.multiplyToRef=function(t,r){return r.copyFromFloats(this._x*t._x,this._y*t._y,this._z*t._z)},n.prototype.multiplyByFloats=function(t,r,o){return new n(this._x*t,this._y*r,this._z*o)},n.prototype.divide=function(t){return new n(this._x/t._x,this._y/t._y,this._z/t._z)},n.prototype.divideToRef=function(t,r){return r.copyFromFloats(this._x/t._x,this._y/t._y,this._z/t._z)},n.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},n.prototype.minimizeInPlace=function(t){return this.minimizeInPlaceFromFloats(t._x,t._y,t._z)},n.prototype.maximizeInPlace=function(t){return this.maximizeInPlaceFromFloats(t._x,t._y,t._z)},n.prototype.minimizeInPlaceFromFloats=function(t,r,o){return t<this._x&&(this.x=t),r<this._y&&(this.y=r),o<this._z&&(this.z=o),this},n.prototype.maximizeInPlaceFromFloats=function(t,r,o){return t>this._x&&(this.x=t),r>this._y&&(this.y=r),o>this._z&&(this.z=o),this},n.prototype.isNonUniformWithinEpsilon=function(t){var r=Math.abs(this._x),o=Math.abs(this._y);if(!R.WithinEpsilon(r,o,t))return!0;var i=Math.abs(this._z);return!R.WithinEpsilon(r,i,t)||!R.WithinEpsilon(o,i,t)},Object.defineProperty(n.prototype,"isNonUniform",{get:function(){var t=Math.abs(this._x),r=Math.abs(this._y);if(t!==r)return!0;var o=Math.abs(this._z);return t!==o},enumerable:!1,configurable:!0}),n.prototype.floor=function(){return new n(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z))},n.prototype.fract=function(){return new n(this._x-Math.floor(this._x),this._y-Math.floor(this._y),this._z-Math.floor(this._z))},n.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)},n.prototype.lengthSquared=function(){return this._x*this._x+this._y*this._y+this._z*this._z},Object.defineProperty(n.prototype,"hasAZeroComponent",{get:function(){return this._x*this._y*this._z===0},enumerable:!1,configurable:!0}),n.prototype.normalize=function(){return this.normalizeFromLength(this.length())},n.prototype.reorderInPlace=function(t){var r=this;return t=t.toLowerCase(),t==="xyz"?this:(l.Vector3[0].copyFrom(this),["x","y","z"].forEach(function(o,i){r[o]=l.Vector3[0][t[i]]}),this)},n.prototype.rotateByQuaternionToRef=function(t,r){return t.toRotationMatrix(l.Matrix[0]),n.TransformCoordinatesToRef(this,l.Matrix[0],r),r},n.prototype.rotateByQuaternionAroundPointToRef=function(t,r,o){return this.subtractToRef(r,l.Vector3[0]),l.Vector3[0].rotateByQuaternionToRef(t,l.Vector3[0]),r.addToRef(l.Vector3[0],o),o},n.prototype.cross=function(t){return n.Cross(this,t)},n.prototype.normalizeFromLength=function(t){return t===0||t===1?this:this.scaleInPlace(1/t)},n.prototype.normalizeToNew=function(){var t=new n(0,0,0);return this.normalizeToRef(t),t},n.prototype.normalizeToRef=function(t){var r=this.length();return r===0||r===1?t.copyFromFloats(this._x,this._y,this._z):this.scaleToRef(1/r,t)},n.prototype.clone=function(){return new n(this._x,this._y,this._z)},n.prototype.copyFrom=function(t){return this.copyFromFloats(t._x,t._y,t._z)},n.prototype.copyFromFloats=function(t,r,o){return this.x=t,this.y=r,this.z=o,this},n.prototype.set=function(t,r,o){return this.copyFromFloats(t,r,o)},n.prototype.setAll=function(t){return this.x=this.y=this.z=t,this},n.GetClipFactor=function(t,r,o,i){var e=n.Dot(t,o)-i,a=n.Dot(r,o)-i,s=e/(e-a);return s},n.GetAngleBetweenVectors=function(t,r,o){var i=t.normalizeToRef(l.Vector3[1]),e=r.normalizeToRef(l.Vector3[2]),a=n.Dot(i,e);a=R.Clamp(a,-1,1);var s=Math.acos(a),h=l.Vector3[3];return n.CrossToRef(i,e,h),n.Dot(h,o)>0?isNaN(s)?0:s:isNaN(s)?-Math.PI:-Math.acos(a)},n.GetAngleBetweenVectorsOnPlane=function(t,r,o){l.Vector3[0].copyFrom(t);var i=l.Vector3[0];l.Vector3[1].copyFrom(r);var e=l.Vector3[1];l.Vector3[2].copyFrom(o);var a=l.Vector3[2],s=l.Vector3[3],h=l.Vector3[4];i.normalize(),e.normalize(),a.normalize(),n.CrossToRef(a,i,s),n.CrossToRef(s,a,h);var u=Math.atan2(n.Dot(e,s),n.Dot(e,h));return R.NormalizeRadians(u)},n.SlerpToRef=function(t,r,o,i){o=R.Clamp(o,0,1);var e=l.Vector3[0],a=l.Vector3[1];e.copyFrom(t);var s=e.length();e.normalizeFromLength(s),a.copyFrom(r);var h=a.length();a.normalizeFromLength(h);var u=n.Dot(e,a),c,f;if(u<1-C){var p=Math.acos(u),v=1/Math.sin(p);c=Math.sin((1-o)*p)*v,f=Math.sin(o*p)*v}else c=1-o,f=o;e.scaleInPlace(c),a.scaleInPlace(f),i.copyFrom(e).addInPlace(a),i.scaleInPlace(R.Lerp(s,h,o))},n.SmoothToRef=function(t,r,o,i,e){n.SlerpToRef(t,r,i===0?1:o/i,e)},n.FromArray=function(t,r){return r===void 0&&(r=0),new n(t[r],t[r+1],t[r+2])},n.FromFloatArray=function(t,r){return n.FromArray(t,r)},n.FromArrayToRef=function(t,r,o){o.x=t[r],o.y=t[r+1],o.z=t[r+2]},n.FromFloatArrayToRef=function(t,r,o){return n.FromArrayToRef(t,r,o)},n.FromFloatsToRef=function(t,r,o,i){i.copyFromFloats(t,r,o)},n.Zero=function(){return new n(0,0,0)},n.One=function(){return new n(1,1,1)},n.Up=function(){return new n(0,1,0)},Object.defineProperty(n,"UpReadOnly",{get:function(){return n._UpReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(n,"DownReadOnly",{get:function(){return n._DownReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(n,"RightReadOnly",{get:function(){return n._RightReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(n,"LeftReadOnly",{get:function(){return n._LeftReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(n,"LeftHandedForwardReadOnly",{get:function(){return n._LeftHandedForwardReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(n,"RightHandedForwardReadOnly",{get:function(){return n._RightHandedForwardReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ZeroReadOnly",{get:function(){return n._ZeroReadOnly},enumerable:!1,configurable:!0}),n.Down=function(){return new n(0,-1,0)},n.Forward=function(t){return t===void 0&&(t=!1),new n(0,0,t?-1:1)},n.Backward=function(t){return t===void 0&&(t=!1),new n(0,0,t?1:-1)},n.Right=function(){return new n(1,0,0)},n.Left=function(){return new n(-1,0,0)},n.TransformCoordinates=function(t,r){var o=n.Zero();return n.TransformCoordinatesToRef(t,r,o),o},n.TransformCoordinatesToRef=function(t,r,o){n.TransformCoordinatesFromFloatsToRef(t._x,t._y,t._z,r,o)},n.TransformCoordinatesFromFloatsToRef=function(t,r,o,i,e){var a=i.m,s=t*a[0]+r*a[4]+o*a[8]+a[12],h=t*a[1]+r*a[5]+o*a[9]+a[13],u=t*a[2]+r*a[6]+o*a[10]+a[14],c=1/(t*a[3]+r*a[7]+o*a[11]+a[15]);e.x=s*c,e.y=h*c,e.z=u*c},n.TransformNormal=function(t,r){var o=n.Zero();return n.TransformNormalToRef(t,r,o),o},n.TransformNormalToRef=function(t,r,o){this.TransformNormalFromFloatsToRef(t._x,t._y,t._z,r,o)},n.TransformNormalFromFloatsToRef=function(t,r,o,i,e){var a=i.m;e.x=t*a[0]+r*a[4]+o*a[8],e.y=t*a[1]+r*a[5]+o*a[9],e.z=t*a[2]+r*a[6]+o*a[10]},n.CatmullRom=function(t,r,o,i,e){var a=e*e,s=e*a,h=.5*(2*r._x+(-t._x+o._x)*e+(2*t._x-5*r._x+4*o._x-i._x)*a+(-t._x+3*r._x-3*o._x+i._x)*s),u=.5*(2*r._y+(-t._y+o._y)*e+(2*t._y-5*r._y+4*o._y-i._y)*a+(-t._y+3*r._y-3*o._y+i._y)*s),c=.5*(2*r._z+(-t._z+o._z)*e+(2*t._z-5*r._z+4*o._z-i._z)*a+(-t._z+3*r._z-3*o._z+i._z)*s);return new n(h,u,c)},n.Clamp=function(t,r,o){var i=new n;return n.ClampToRef(t,r,o,i),i},n.ClampToRef=function(t,r,o,i){var e=t._x;e=e>o._x?o._x:e,e=e<r._x?r._x:e;var a=t._y;a=a>o._y?o._y:a,a=a<r._y?r._y:a;var s=t._z;s=s>o._z?o._z:s,s=s<r._z?r._z:s,i.copyFromFloats(e,a,s)},n.CheckExtends=function(t,r,o){r.minimizeInPlace(t),o.maximizeInPlace(t)},n.Hermite=function(t,r,o,i,e){var a=e*e,s=e*a,h=2*s-3*a+1,u=-2*s+3*a,c=s-2*a+e,f=s-a,p=t._x*h+o._x*u+r._x*c+i._x*f,v=t._y*h+o._y*u+r._y*c+i._y*f,_=t._z*h+o._z*u+r._z*c+i._z*f;return new n(p,v,_)},n.Hermite1stDerivative=function(t,r,o,i,e){var a=n.Zero();return this.Hermite1stDerivativeToRef(t,r,o,i,e,a),a},n.Hermite1stDerivativeToRef=function(t,r,o,i,e,a){var s=e*e;a.x=(s-e)*6*t.x+(3*s-4*e+1)*r.x+(-s+e)*6*o.x+(3*s-2*e)*i.x,a.y=(s-e)*6*t.y+(3*s-4*e+1)*r.y+(-s+e)*6*o.y+(3*s-2*e)*i.y,a.z=(s-e)*6*t.z+(3*s-4*e+1)*r.z+(-s+e)*6*o.z+(3*s-2*e)*i.z},n.Lerp=function(t,r,o){var i=new n(0,0,0);return n.LerpToRef(t,r,o,i),i},n.LerpToRef=function(t,r,o,i){i.x=t._x+(r._x-t._x)*o,i.y=t._y+(r._y-t._y)*o,i.z=t._z+(r._z-t._z)*o},n.Dot=function(t,r){return t._x*r._x+t._y*r._y+t._z*r._z},n.Cross=function(t,r){var o=n.Zero();return n.CrossToRef(t,r,o),o},n.CrossToRef=function(t,r,o){var i=t._y*r._z-t._z*r._y,e=t._z*r._x-t._x*r._z,a=t._x*r._y-t._y*r._x;o.copyFromFloats(i,e,a)},n.Normalize=function(t){var r=n.Zero();return n.NormalizeToRef(t,r),r},n.NormalizeToRef=function(t,r){t.normalizeToRef(r)},n.Project=function(t,r,o,i){var e=new n;return n.ProjectToRef(t,r,o,i,e),e},n.ProjectToRef=function(t,r,o,i,e){var a=i.width,s=i.height,h=i.x,u=i.y,c=l.Matrix[1];U.FromValuesToRef(a/2,0,0,0,0,-s/2,0,0,0,0,.5,0,h+a/2,s/2+u,.5,1,c);var f=l.Matrix[0];return r.multiplyToRef(o,f),f.multiplyToRef(c,f),n.TransformCoordinatesToRef(t,f,e),e},n._UnprojectFromInvertedMatrixToRef=function(t,r,o){n.TransformCoordinatesToRef(t,r,o);var i=r.m,e=t._x*i[3]+t._y*i[7]+t._z*i[11]+i[15];R.WithinEpsilon(e,1)&&o.scaleInPlace(1/e)},n.UnprojectFromTransform=function(t,r,o,i,e){return this.Unproject(t,r,o,i,e,U.IdentityReadOnly)},n.Unproject=function(t,r,o,i,e,a){var s=n.Zero();return n.UnprojectToRef(t,r,o,i,e,a,s),s},n.UnprojectToRef=function(t,r,o,i,e,a,s){n.UnprojectFloatsToRef(t._x,t._y,t._z,r,o,i,e,a,s)},n.UnprojectFloatsToRef=function(t,r,o,i,e,a,s,h,u){var c,f=l.Matrix[0];a.multiplyToRef(s,f),f.multiplyToRef(h,f),f.invert();var p=l.Vector3[0];p.x=t/i*2-1,p.y=-(r/e*2-1),!((c=bt.LastCreatedEngine)===null||c===void 0)&&c.isNDCHalfZRange?p.z=o:p.z=2*o-1,n._UnprojectFromInvertedMatrixToRef(p,f,u)},n.Minimize=function(t,r){var o=t.clone();return o.minimizeInPlace(r),o},n.Maximize=function(t,r){var o=t.clone();return o.maximizeInPlace(r),o},n.Distance=function(t,r){return Math.sqrt(n.DistanceSquared(t,r))},n.DistanceSquared=function(t,r){var o=t._x-r._x,i=t._y-r._y,e=t._z-r._z;return o*o+i*i+e*e},n.ProjectOnTriangleToRef=function(t,r,o,i,e){var a=l.Vector3[0],s=l.Vector3[1],h=l.Vector3[2],u=l.Vector3[3],c=l.Vector3[4];o.subtractToRef(r,a),i.subtractToRef(r,s),i.subtractToRef(o,h);var f=a.length(),p=s.length(),v=h.length();if(f<C||p<C||v<C)return e.copyFrom(r),n.Distance(t,r);t.subtractToRef(r,c),n.CrossToRef(a,s,u);var _=u.length();if(_<C)return e.copyFrom(r),n.Distance(t,r);u.normalizeFromLength(_);var d=c.length();if(d<C)return e.copyFrom(r),0;c.normalizeFromLength(d);var x=n.Dot(u,c),T=l.Vector3[5],m=l.Vector3[6];T.copyFrom(u).scaleInPlace(-d*x),m.copyFrom(t).addInPlace(T);var A=l.Vector3[4],g=l.Vector3[5],P=l.Vector3[7],z=l.Vector3[8];A.copyFrom(a).scaleInPlace(1/f),z.copyFrom(s).scaleInPlace(1/p),A.addInPlace(z).scaleInPlace(-1),g.copyFrom(a).scaleInPlace(-1/f),z.copyFrom(h).scaleInPlace(1/v),g.addInPlace(z).scaleInPlace(-1),P.copyFrom(h).scaleInPlace(-1/v),z.copyFrom(s).scaleInPlace(-1/p),P.addInPlace(z).scaleInPlace(-1);var M=l.Vector3[9],I;M.copyFrom(m).subtractInPlace(r),n.CrossToRef(A,M,z),I=n.Dot(z,u);var Z=I;M.copyFrom(m).subtractInPlace(o),n.CrossToRef(g,M,z),I=n.Dot(z,u);var V=I;M.copyFrom(m).subtractInPlace(i),n.CrossToRef(P,M,z),I=n.Dot(z,u);var H=I,L=l.Vector3[10],b,F;Z>0&&V<0?(L.copyFrom(a),b=r,F=o):V>0&&H<0?(L.copyFrom(h),b=o,F=i):(L.copyFrom(s).scaleInPlace(-1),b=i,F=r);var S=l.Vector3[9],D=l.Vector3[4];b.subtractToRef(m,z),F.subtractToRef(m,S),n.CrossToRef(z,S,D);var N=n.Dot(D,u)<0;if(!N)return e.copyFrom(m),Math.abs(d*x);var E=l.Vector3[5];n.CrossToRef(L,D,E),E.normalize();var B=l.Vector3[9];B.copyFrom(b).subtractInPlace(m);var k=B.length();if(k<C)return e.copyFrom(b),n.Distance(t,b);B.normalizeFromLength(k);var X=n.Dot(E,B),K=l.Vector3[7];K.copyFrom(m).addInPlace(E.scaleInPlace(k*X)),z.copyFrom(K).subtractInPlace(b),d=L.length(),L.normalizeFromLength(d);var $=n.Dot(z,L)/Math.max(d,C);return $=R.Clamp($,0,1),K.copyFrom(b).addInPlace(L.scaleInPlace($*d)),e.copyFrom(K),n.Distance(t,K)},n.Center=function(t,r){return n.CenterToRef(t,r,n.Zero())},n.CenterToRef=function(t,r,o){return o.copyFromFloats((t._x+r._x)/2,(t._y+r._y)/2,(t._z+r._z)/2)},n.RotationFromAxis=function(t,r,o){var i=n.Zero();return n.RotationFromAxisToRef(t,r,o,i),i},n.RotationFromAxisToRef=function(t,r,o,i){var e=l.Quaternion[0];W.RotationQuaternionFromAxisToRef(t,r,o,e),e.toEulerAnglesToRef(i)},n._UpReadOnly=n.Up(),n._DownReadOnly=n.Down(),n._LeftHandedForwardReadOnly=n.Forward(!1),n._RightHandedForwardReadOnly=n.Forward(!0),n._RightReadOnly=n.Right(),n._LeftReadOnly=n.Left(),n._ZeroReadOnly=n.Zero(),n}(),st=function(){function n(t,r,o,i){this.x=t,this.y=r,this.z=o,this.w=i}return n.prototype.toString=function(){return"{X: ".concat(this.x," Y: ").concat(this.y," Z: ").concat(this.z," W: ").concat(this.w,"}")},n.prototype.getClassName=function(){return"Vector4"},n.prototype.getHashCode=function(){var t=O(this.x),r=O(this.y),o=O(this.z),i=O(this.w),e=t;return e=e*397^r,e=e*397^o,e=e*397^i,e},n.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},n.prototype.toArray=function(t,r){return r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t[r+3]=this.w,this},n.prototype.fromArray=function(t,r){return r===void 0&&(r=0),n.FromArrayToRef(t,r,this),this},n.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},n.prototype.addToRef=function(t,r){return r.x=this.x+t.x,r.y=this.y+t.y,r.z=this.z+t.z,r.w=this.w+t.w,this},n.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},n.prototype.subtractToRef=function(t,r){return r.x=this.x-t.x,r.y=this.y-t.y,r.z=this.z-t.z,r.w=this.w-t.w,this},n.prototype.subtractFromFloats=function(t,r,o,i){return new n(this.x-t,this.y-r,this.z-o,this.w-i)},n.prototype.subtractFromFloatsToRef=function(t,r,o,i,e){return e.x=this.x-t,e.y=this.y-r,e.z=this.z-o,e.w=this.w-i,this},n.prototype.negate=function(){return new n(-this.x,-this.y,-this.z,-this.w)},n.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this},n.prototype.negateToRef=function(t){return t.copyFromFloats(this.x*-1,this.y*-1,this.z*-1,this.w*-1)},n.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.prototype.scale=function(t){return new n(this.x*t,this.y*t,this.z*t,this.w*t)},n.prototype.scaleToRef=function(t,r){return r.x=this.x*t,r.y=this.y*t,r.z=this.z*t,r.w=this.w*t,this},n.prototype.scaleAndAddToRef=function(t,r){return r.x+=this.x*t,r.y+=this.y*t,r.z+=this.z*t,r.w+=this.w*t,this},n.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},n.prototype.equalsWithEpsilon=function(t,r){return r===void 0&&(r=C),t&&R.WithinEpsilon(this.x,t.x,r)&&R.WithinEpsilon(this.y,t.y,r)&&R.WithinEpsilon(this.z,t.z,r)&&R.WithinEpsilon(this.w,t.w,r)},n.prototype.equalsToFloats=function(t,r,o,i){return this.x===t&&this.y===r&&this.z===o&&this.w===i},n.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},n.prototype.multiply=function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},n.prototype.multiplyToRef=function(t,r){return r.x=this.x*t.x,r.y=this.y*t.y,r.z=this.z*t.z,r.w=this.w*t.w,this},n.prototype.multiplyByFloats=function(t,r,o,i){return new n(this.x*t,this.y*r,this.z*o,this.w*i)},n.prototype.divide=function(t){return new n(this.x/t.x,this.y/t.y,this.z/t.z,this.w/t.w)},n.prototype.divideToRef=function(t,r){return r.x=this.x/t.x,r.y=this.y/t.y,r.z=this.z/t.z,r.w=this.w/t.w,this},n.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},n.prototype.minimizeInPlace=function(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this},n.prototype.maximizeInPlace=function(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this},n.prototype.floor=function(){return new n(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))},n.prototype.fract=function(){return new n(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))},n.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},n.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},n.prototype.normalize=function(){var t=this.length();return t===0?this:this.scaleInPlace(1/t)},n.prototype.toVector3=function(){return new y(this.x,this.y,this.z)},n.prototype.clone=function(){return new n(this.x,this.y,this.z,this.w)},n.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},n.prototype.copyFromFloats=function(t,r,o,i){return this.x=t,this.y=r,this.z=o,this.w=i,this},n.prototype.set=function(t,r,o,i){return this.copyFromFloats(t,r,o,i)},n.prototype.setAll=function(t){return this.x=this.y=this.z=this.w=t,this},n.FromArray=function(t,r){return r||(r=0),new n(t[r],t[r+1],t[r+2],t[r+3])},n.FromArrayToRef=function(t,r,o){o.x=t[r],o.y=t[r+1],o.z=t[r+2],o.w=t[r+3]},n.FromFloatArrayToRef=function(t,r,o){n.FromArrayToRef(t,r,o)},n.FromFloatsToRef=function(t,r,o,i,e){e.x=t,e.y=r,e.z=o,e.w=i},n.Zero=function(){return new n(0,0,0,0)},n.One=function(){return new n(1,1,1,1)},Object.defineProperty(n,"ZeroReadOnly",{get:function(){return n._ZeroReadOnly},enumerable:!1,configurable:!0}),n.Normalize=function(t){var r=n.Zero();return n.NormalizeToRef(t,r),r},n.NormalizeToRef=function(t,r){r.copyFrom(t),r.normalize()},n.Minimize=function(t,r){var o=t.clone();return o.minimizeInPlace(r),o},n.Maximize=function(t,r){var o=t.clone();return o.maximizeInPlace(r),o},n.Distance=function(t,r){return Math.sqrt(n.DistanceSquared(t,r))},n.DistanceSquared=function(t,r){var o=t.x-r.x,i=t.y-r.y,e=t.z-r.z,a=t.w-r.w;return o*o+i*i+e*e+a*a},n.Center=function(t,r){return n.CenterToRef(t,r,n.Zero())},n.CenterToRef=function(t,r,o){return o.copyFromFloats((t.x+r.x)/2,(t.y+r.y)/2,(t.z+r.z)/2,(t.w+r.w)/2)},n.TransformCoordinates=function(t,r){var o=n.Zero();return n.TransformCoordinatesToRef(t,r,o),o},n.TransformCoordinatesToRef=function(t,r,o){n.TransformCoordinatesFromFloatsToRef(t._x,t._y,t._z,r,o)},n.TransformCoordinatesFromFloatsToRef=function(t,r,o,i,e){var a=i.m,s=t*a[0]+r*a[4]+o*a[8]+a[12],h=t*a[1]+r*a[5]+o*a[9]+a[13],u=t*a[2]+r*a[6]+o*a[10]+a[14],c=t*a[3]+r*a[7]+o*a[11]+a[15];e.x=s,e.y=h,e.z=u,e.w=c},n.TransformNormal=function(t,r){var o=n.Zero();return n.TransformNormalToRef(t,r,o),o},n.TransformNormalToRef=function(t,r,o){var i=r.m,e=t.x*i[0]+t.y*i[4]+t.z*i[8],a=t.x*i[1]+t.y*i[5]+t.z*i[9],s=t.x*i[2]+t.y*i[6]+t.z*i[10];o.x=e,o.y=a,o.z=s,o.w=t.w},n.TransformNormalFromFloatsToRef=function(t,r,o,i,e,a){var s=e.m;a.x=t*s[0]+r*s[4]+o*s[8],a.y=t*s[1]+r*s[5]+o*s[9],a.z=t*s[2]+r*s[6]+o*s[10],a.w=i},n.FromVector3=function(t,r){return r===void 0&&(r=0),new n(t._x,t._y,t._z,r)},n._ZeroReadOnly=n.Zero(),n}(),W=function(){function n(t,r,o,i){t===void 0&&(t=0),r===void 0&&(r=0),o===void 0&&(o=0),i===void 0&&(i=1),this._isDirty=!0,this._x=t,this._y=r,this._z=o,this._w=i}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"w",{get:function(){return this._w},set:function(t){this._w=t,this._isDirty=!0},enumerable:!1,configurable:!0}),n.prototype.toString=function(){return"{X: ".concat(this._x," Y: ").concat(this._y," Z: ").concat(this._z," W: ").concat(this._w,"}")},n.prototype.getClassName=function(){return"Quaternion"},n.prototype.getHashCode=function(){var t=O(this._x),r=O(this._y),o=O(this._z),i=O(this._w),e=t;return e=e*397^r,e=e*397^o,e=e*397^i,e},n.prototype.asArray=function(){return[this._x,this._y,this._z,this._w]},n.prototype.toArray=function(t,r){return r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t[r+3]=this.w,this},n.prototype.equals=function(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z&&this._w===t._w},n.prototype.equalsWithEpsilon=function(t,r){return r===void 0&&(r=C),t&&R.WithinEpsilon(this._x,t._x,r)&&R.WithinEpsilon(this._y,t._y,r)&&R.WithinEpsilon(this._z,t._z,r)&&R.WithinEpsilon(this._w,t._w,r)},n.prototype.clone=function(){return new n(this._x,this._y,this._z,this._w)},n.prototype.copyFrom=function(t){return this.x=t._x,this.y=t._y,this.z=t._z,this.w=t._w,this},n.prototype.copyFromFloats=function(t,r,o,i){return this.x=t,this.y=r,this.z=o,this.w=i,this},n.prototype.set=function(t,r,o,i){return this.copyFromFloats(t,r,o,i)},n.prototype.add=function(t){return new n(this._x+t._x,this._y+t._y,this._z+t._z,this._w+t._w)},n.prototype.addInPlace=function(t){return this._x+=t._x,this._y+=t._y,this._z+=t._z,this._w+=t._w,this},n.prototype.subtract=function(t){return new n(this._x-t._x,this._y-t._y,this._z-t._z,this._w-t._w)},n.prototype.subtractInPlace=function(t){return this._x-=t._x,this._y-=t._y,this._z-=t._z,this._w-=t._w,this},n.prototype.scale=function(t){return new n(this._x*t,this._y*t,this._z*t,this._w*t)},n.prototype.scaleToRef=function(t,r){return r.x=this._x*t,r.y=this._y*t,r.z=this._z*t,r.w=this._w*t,this},n.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},n.prototype.scaleAndAddToRef=function(t,r){return r.x+=this._x*t,r.y+=this._y*t,r.z+=this._z*t,r.w+=this._w*t,this},n.prototype.multiply=function(t){var r=new n(0,0,0,1);return this.multiplyToRef(t,r),r},n.prototype.multiplyToRef=function(t,r){var o=this._x*t._w+this._y*t._z-this._z*t._y+this._w*t._x,i=-this._x*t._z+this._y*t._w+this._z*t._x+this._w*t._y,e=this._x*t._y-this._y*t._x+this._z*t._w+this._w*t._z,a=-this._x*t._x-this._y*t._y-this._z*t._z+this._w*t._w;return r.copyFromFloats(o,i,e,a),this},n.prototype.multiplyInPlace=function(t){return this.multiplyToRef(t,this),this},n.prototype.conjugateToRef=function(t){return t.copyFromFloats(-this._x,-this._y,-this._z,this._w),this},n.prototype.conjugateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},n.prototype.conjugate=function(){return new n(-this._x,-this._y,-this._z,this._w)},n.prototype.invert=function(){var t=this.conjugate(),r=this.lengthSquared();return r==0||r==1||t.scaleInPlace(1/r),t},n.prototype.invertInPlace=function(){this.conjugateInPlace();var t=this.lengthSquared();return t==0||t==1?this:(this.scaleInPlace(1/t),this)},n.prototype.lengthSquared=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},n.prototype.length=function(){return Math.sqrt(this.lengthSquared())},n.prototype.normalize=function(){var t=this.length();if(t===0)return this;var r=1/t;return this.scaleInPlace(r),this},n.prototype.normalizeToNew=function(){var t=this.length();if(t===0)return this.clone();var r=1/t;return this.scale(r)},n.prototype.toEulerAngles=function(){var t=y.Zero();return this.toEulerAnglesToRef(t),t},n.prototype.toEulerAnglesToRef=function(t){var r=this._z,o=this._x,i=this._y,e=this._w,a=i*r-o*e,s=.4999999;if(a<-s)t.y=2*Math.atan2(i,e),t.x=Math.PI/2,t.z=0;else if(a>s)t.y=2*Math.atan2(i,e),t.x=-Math.PI/2,t.z=0;else{var h=e*e,u=r*r,c=o*o,f=i*i;t.z=Math.atan2(2*(o*i+r*e),-u-c+f+h),t.x=Math.asin(-2*a),t.y=Math.atan2(2*(r*o+i*e),u-c-f+h)}return this},n.prototype.toRotationMatrix=function(t){return U.FromQuaternionToRef(this,t),this},n.prototype.fromRotationMatrix=function(t){return n.FromRotationMatrixToRef(t,this),this},n.FromRotationMatrix=function(t){var r=new n;return n.FromRotationMatrixToRef(t,r),r},n.FromRotationMatrixToRef=function(t,r){var o=t.m,i=o[0],e=o[4],a=o[8],s=o[1],h=o[5],u=o[9],c=o[2],f=o[6],p=o[10],v=i+h+p,_;v>0?(_=.5/Math.sqrt(v+1),r.w=.25/_,r.x=(f-u)*_,r.y=(a-c)*_,r.z=(s-e)*_):i>h&&i>p?(_=2*Math.sqrt(1+i-h-p),r.w=(f-u)/_,r.x=.25*_,r.y=(e+s)/_,r.z=(a+c)/_):h>p?(_=2*Math.sqrt(1+h-i-p),r.w=(a-c)/_,r.x=(e+s)/_,r.y=.25*_,r.z=(u+f)/_):(_=2*Math.sqrt(1+p-i-h),r.w=(s-e)/_,r.x=(a+c)/_,r.y=(u+f)/_,r.z=.25*_)},n.Dot=function(t,r){return t._x*r._x+t._y*r._y+t._z*r._z+t._w*r._w},n.AreClose=function(t,r){var o=n.Dot(t,r);return o>=0},n.SmoothToRef=function(t,r,o,i,e){var a=i===0?1:o/i;a=R.Clamp(a,0,1),n.SlerpToRef(t,r,a,e)},n.Zero=function(){return new n(0,0,0,0)},n.Inverse=function(t){return new n(-t._x,-t._y,-t._z,t._w)},n.InverseToRef=function(t,r){return r.set(-t._x,-t._y,-t._z,t._w),r},n.Identity=function(){return new n(0,0,0,1)},n.IsIdentity=function(t){return t&&t._x===0&&t._y===0&&t._z===0&&t._w===1},n.RotationAxis=function(t,r){return n.RotationAxisToRef(t,r,new n)},n.RotationAxisToRef=function(t,r,o){var i=Math.sin(r/2);return t.normalize(),o.w=Math.cos(r/2),o.x=t._x*i,o.y=t._y*i,o.z=t._z*i,o},n.FromArray=function(t,r){return r||(r=0),new n(t[r],t[r+1],t[r+2],t[r+3])},n.FromArrayToRef=function(t,r,o){o.x=t[r],o.y=t[r+1],o.z=t[r+2],o.w=t[r+3]},n.FromEulerAngles=function(t,r,o){var i=new n;return n.RotationYawPitchRollToRef(r,t,o,i),i},n.FromEulerAnglesToRef=function(t,r,o,i){return n.RotationYawPitchRollToRef(r,t,o,i),i},n.FromEulerVector=function(t){var r=new n;return n.RotationYawPitchRollToRef(t._y,t._x,t._z,r),r},n.FromEulerVectorToRef=function(t,r){return n.RotationYawPitchRollToRef(t._y,t._x,t._z,r),r},n.FromUnitVectorsToRef=function(t,r,o){var i=y.Dot(t,r)+1;return i<C?Math.abs(t.x)>Math.abs(t.z)?o.set(-t.y,t.x,0,0):o.set(0,-t.z,t.y,0):(y.CrossToRef(t,r,w.Vector3[0]),o.set(w.Vector3[0].x,w.Vector3[0].y,w.Vector3[0].z,i)),o.normalize()},n.RotationYawPitchRoll=function(t,r,o){var i=new n;return n.RotationYawPitchRollToRef(t,r,o,i),i},n.RotationYawPitchRollToRef=function(t,r,o,i){var e=o*.5,a=r*.5,s=t*.5,h=Math.sin(e),u=Math.cos(e),c=Math.sin(a),f=Math.cos(a),p=Math.sin(s),v=Math.cos(s);i.x=v*c*u+p*f*h,i.y=p*f*u-v*c*h,i.z=v*f*h-p*c*u,i.w=v*f*u+p*c*h},n.RotationAlphaBetaGamma=function(t,r,o){var i=new n;return n.RotationAlphaBetaGammaToRef(t,r,o,i),i},n.RotationAlphaBetaGammaToRef=function(t,r,o,i){var e=(o+t)*.5,a=(o-t)*.5,s=r*.5;i.x=Math.cos(a)*Math.sin(s),i.y=Math.sin(a)*Math.sin(s),i.z=Math.sin(e)*Math.cos(s),i.w=Math.cos(e)*Math.cos(s)},n.RotationQuaternionFromAxis=function(t,r,o){var i=new n(0,0,0,0);return n.RotationQuaternionFromAxisToRef(t,r,o,i),i},n.RotationQuaternionFromAxisToRef=function(t,r,o,i){var e=l.Matrix[0];U.FromXYZAxesToRef(t.normalize(),r.normalize(),o.normalize(),e),n.FromRotationMatrixToRef(e,i)},n.FromLookDirectionLH=function(t,r){var o=new n;return n.FromLookDirectionLHToRef(t,r,o),o},n.FromLookDirectionLHToRef=function(t,r,o){var i=l.Matrix[0];U.LookDirectionLHToRef(t,r,i),n.FromRotationMatrixToRef(i,o)},n.FromLookDirectionRH=function(t,r){var o=new n;return n.FromLookDirectionRHToRef(t,r,o),o},n.FromLookDirectionRHToRef=function(t,r,o){var i=l.Matrix[0];return U.LookDirectionRHToRef(t,r,i),n.FromRotationMatrixToRef(i,o)},n.Slerp=function(t,r,o){var i=n.Identity();return n.SlerpToRef(t,r,o,i),i},n.SlerpToRef=function(t,r,o,i){var e,a,s=t._x*r._x+t._y*r._y+t._z*r._z+t._w*r._w,h=!1;if(s<0&&(h=!0,s=-s),s>.999999)a=1-o,e=h?-o:o;else{var u=Math.acos(s),c=1/Math.sin(u);a=Math.sin((1-o)*u)*c,e=h?-Math.sin(o*u)*c:Math.sin(o*u)*c}i.x=a*t._x+e*r._x,i.y=a*t._y+e*r._y,i.z=a*t._z+e*r._z,i.w=a*t._w+e*r._w},n.Hermite=function(t,r,o,i,e){var a=e*e,s=e*a,h=2*s-3*a+1,u=-2*s+3*a,c=s-2*a+e,f=s-a,p=t._x*h+o._x*u+r._x*c+i._x*f,v=t._y*h+o._y*u+r._y*c+i._y*f,_=t._z*h+o._z*u+r._z*c+i._z*f,d=t._w*h+o._w*u+r._w*c+i._w*f;return new n(p,v,_,d)},n.Hermite1stDerivative=function(t,r,o,i,e){var a=n.Zero();return this.Hermite1stDerivativeToRef(t,r,o,i,e,a),a},n.Hermite1stDerivativeToRef=function(t,r,o,i,e,a){var s=e*e;a.x=(s-e)*6*t.x+(3*s-4*e+1)*r.x+(-s+e)*6*o.x+(3*s-2*e)*i.x,a.y=(s-e)*6*t.y+(3*s-4*e+1)*r.y+(-s+e)*6*o.y+(3*s-2*e)*i.y,a.z=(s-e)*6*t.z+(3*s-4*e+1)*r.z+(-s+e)*6*o.z+(3*s-2*e)*i.z,a.w=(s-e)*6*t.w+(3*s-4*e+1)*r.w+(-s+e)*6*o.w+(3*s-2*e)*i.w},n}(),U=function(){function n(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this.updateFlag=-1,rt.MatrixTrackPrecisionChange&&rt.MatrixTrackedMatrices.push(this),this._m=new rt.MatrixCurrentType(16),this.markAsUpdated()}return Object.defineProperty(n,"Use64Bits",{get:function(){return rt.MatrixUse64Bits},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"m",{get:function(){return this._m},enumerable:!1,configurable:!0}),n.prototype.markAsUpdated=function(){this.updateFlag=n._UpdateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0},n.prototype._updateIdentityStatus=function(t,r,o,i){r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=!0),this._isIdentity=t,this._isIdentity3x2=t||o,this._isIdentityDirty=this._isIdentity?!1:r,this._isIdentity3x2Dirty=this._isIdentity3x2?!1:i},n.prototype.isIdentity=function(){if(this._isIdentityDirty){this._isIdentityDirty=!1;var t=this._m;this._isIdentity=t[0]===1&&t[1]===0&&t[2]===0&&t[3]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[7]===0&&t[8]===0&&t[9]===0&&t[10]===1&&t[11]===0&&t[12]===0&&t[13]===0&&t[14]===0&&t[15]===1}return this._isIdentity},n.prototype.isIdentityAs3x2=function(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,this._m[0]!==1||this._m[5]!==1||this._m[15]!==1?this._isIdentity3x2=!1:this._m[1]!==0||this._m[2]!==0||this._m[3]!==0||this._m[4]!==0||this._m[6]!==0||this._m[7]!==0||this._m[8]!==0||this._m[9]!==0||this._m[10]!==0||this._m[11]!==0||this._m[12]!==0||this._m[13]!==0||this._m[14]!==0?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2},n.prototype.determinant=function(){if(this._isIdentity===!0)return 1;var t=this._m,r=t[0],o=t[1],i=t[2],e=t[3],a=t[4],s=t[5],h=t[6],u=t[7],c=t[8],f=t[9],p=t[10],v=t[11],_=t[12],d=t[13],x=t[14],T=t[15],m=p*T-x*v,A=f*T-d*v,g=f*x-d*p,P=c*T-_*v,z=c*x-p*_,M=c*d-_*f,I=+(s*m-h*A+u*g),Z=-(a*m-h*P+u*z),V=+(a*A-s*P+u*M),H=-(a*g-s*z+h*M);return r*I+o*Z+i*V+e*H},n.prototype.toArray=function(){return this._m},n.prototype.asArray=function(){return this._m},n.prototype.invert=function(){return this.invertToRef(this),this},n.prototype.reset=function(){return n.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this},n.prototype.add=function(t){var r=new n;return this.addToRef(t,r),r},n.prototype.addToRef=function(t,r){for(var o=this._m,i=r._m,e=t.m,a=0;a<16;a++)i[a]=o[a]+e[a];return r.markAsUpdated(),this},n.prototype.addToSelf=function(t){for(var r=this._m,o=t.m,i=0;i<16;i++)r[i]+=o[i];return this.markAsUpdated(),this},n.prototype.invertToRef=function(t){if(this._isIdentity===!0)return n.IdentityToRef(t),this;var r=this._m,o=r[0],i=r[1],e=r[2],a=r[3],s=r[4],h=r[5],u=r[6],c=r[7],f=r[8],p=r[9],v=r[10],_=r[11],d=r[12],x=r[13],T=r[14],m=r[15],A=v*m-T*_,g=p*m-x*_,P=p*T-x*v,z=f*m-d*_,M=f*T-v*d,I=f*x-d*p,Z=+(h*A-u*g+c*P),V=-(s*A-u*z+c*M),H=+(s*g-h*z+c*I),L=-(s*P-h*M+u*I),b=o*Z+i*V+e*H+a*L;if(b===0)return t.copyFrom(this),this;var F=1/b,S=u*m-T*c,D=h*m-x*c,N=h*T-x*u,E=s*m-d*c,B=s*T-d*u,k=s*x-d*h,X=u*_-v*c,K=h*_-p*c,$=h*v-p*u,ut=s*_-f*c,ct=s*v-f*u,ft=s*p-f*h,xt=-(i*A-e*g+a*P),dt=+(o*A-e*z+a*M),Rt=-(o*g-i*z+a*I),zt=+(o*P-i*M+e*I),wt=+(i*S-e*D+a*N),Tt=-(o*S-e*E+a*B),Ft=+(o*D-i*E+a*k),gt=-(o*N-i*B+e*k),Mt=-(i*X-e*K+a*$),It=+(o*X-e*ut+a*ct),At=-(o*K-i*ut+a*ft),Pt=+(o*$-i*ct+e*ft);return n.FromValuesToRef(Z*F,xt*F,wt*F,Mt*F,V*F,dt*F,Tt*F,It*F,H*F,Rt*F,Ft*F,At*F,L*F,zt*F,gt*F,Pt*F,t),this},n.prototype.addAtIndex=function(t,r){return this._m[t]+=r,this.markAsUpdated(),this},n.prototype.multiplyAtIndex=function(t,r){return this._m[t]*=r,this.markAsUpdated(),this},n.prototype.setTranslationFromFloats=function(t,r,o){return this._m[12]=t,this._m[13]=r,this._m[14]=o,this.markAsUpdated(),this},n.prototype.addTranslationFromFloats=function(t,r,o){return this._m[12]+=t,this._m[13]+=r,this._m[14]+=o,this.markAsUpdated(),this},n.prototype.setTranslation=function(t){return this.setTranslationFromFloats(t._x,t._y,t._z)},n.prototype.getTranslation=function(){return new y(this._m[12],this._m[13],this._m[14])},n.prototype.getTranslationToRef=function(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],this},n.prototype.removeRotationAndScaling=function(){var t=this.m;return n.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t[12],t[13],t[14],t[15],this),this._updateIdentityStatus(t[12]===0&&t[13]===0&&t[14]===0&&t[15]===1),this},n.prototype.multiply=function(t){var r=new n;return this.multiplyToRef(t,r),r},n.prototype.copyFrom=function(t){t.copyToArray(this._m);var r=t;return this.updateFlag=r.updateFlag,this._updateIdentityStatus(r._isIdentity,r._isIdentityDirty,r._isIdentity3x2,r._isIdentity3x2Dirty),this},n.prototype.copyToArray=function(t,r){r===void 0&&(r=0);var o=this._m;return t[r]=o[0],t[r+1]=o[1],t[r+2]=o[2],t[r+3]=o[3],t[r+4]=o[4],t[r+5]=o[5],t[r+6]=o[6],t[r+7]=o[7],t[r+8]=o[8],t[r+9]=o[9],t[r+10]=o[10],t[r+11]=o[11],t[r+12]=o[12],t[r+13]=o[13],t[r+14]=o[14],t[r+15]=o[15],this},n.prototype.multiplyToRef=function(t,r){return this._isIdentity?(r.copyFrom(t),this):t._isIdentity?(r.copyFrom(this),this):(this.multiplyToArray(t,r._m,0),r.markAsUpdated(),this)},n.prototype.multiplyToArray=function(t,r,o){var i=this._m,e=t.m,a=i[0],s=i[1],h=i[2],u=i[3],c=i[4],f=i[5],p=i[6],v=i[7],_=i[8],d=i[9],x=i[10],T=i[11],m=i[12],A=i[13],g=i[14],P=i[15],z=e[0],M=e[1],I=e[2],Z=e[3],V=e[4],H=e[5],L=e[6],b=e[7],F=e[8],S=e[9],D=e[10],N=e[11],E=e[12],B=e[13],k=e[14],X=e[15];return r[o]=a*z+s*V+h*F+u*E,r[o+1]=a*M+s*H+h*S+u*B,r[o+2]=a*I+s*L+h*D+u*k,r[o+3]=a*Z+s*b+h*N+u*X,r[o+4]=c*z+f*V+p*F+v*E,r[o+5]=c*M+f*H+p*S+v*B,r[o+6]=c*I+f*L+p*D+v*k,r[o+7]=c*Z+f*b+p*N+v*X,r[o+8]=_*z+d*V+x*F+T*E,r[o+9]=_*M+d*H+x*S+T*B,r[o+10]=_*I+d*L+x*D+T*k,r[o+11]=_*Z+d*b+x*N+T*X,r[o+12]=m*z+A*V+g*F+P*E,r[o+13]=m*M+A*H+g*S+P*B,r[o+14]=m*I+A*L+g*D+P*k,r[o+15]=m*Z+A*b+g*N+P*X,this},n.prototype.equals=function(t){var r=t;if(!r)return!1;if((this._isIdentity||r._isIdentity)&&!this._isIdentityDirty&&!r._isIdentityDirty)return this._isIdentity&&r._isIdentity;var o=this.m,i=r.m;return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]&&o[4]===i[4]&&o[5]===i[5]&&o[6]===i[6]&&o[7]===i[7]&&o[8]===i[8]&&o[9]===i[9]&&o[10]===i[10]&&o[11]===i[11]&&o[12]===i[12]&&o[13]===i[13]&&o[14]===i[14]&&o[15]===i[15]},n.prototype.clone=function(){var t=new n;return t.copyFrom(this),t},n.prototype.getClassName=function(){return"Matrix"},n.prototype.getHashCode=function(){for(var t=O(this._m[0]),r=1;r<16;r++)t=t*397^O(this._m[r]);return t},n.prototype.decomposeToTransformNode=function(t){return t.rotationQuaternion=t.rotationQuaternion||new W,this.decompose(t.scaling,t.rotationQuaternion,t.position)},n.prototype.decompose=function(t,r,o,i){if(this._isIdentity)return o&&o.setAll(0),t&&t.setAll(1),r&&r.copyFromFloats(0,0,0,1),!0;var e=this._m;if(o&&o.copyFromFloats(e[12],e[13],e[14]),t=t||l.Vector3[0],t.x=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),t.y=Math.sqrt(e[4]*e[4]+e[5]*e[5]+e[6]*e[6]),t.z=Math.sqrt(e[8]*e[8]+e[9]*e[9]+e[10]*e[10]),i){var a=i.scaling.x<0?-1:1,s=i.scaling.y<0?-1:1,h=i.scaling.z<0?-1:1;t.x*=a,t.y*=s,t.z*=h}else this.determinant()<=0&&(t.y*=-1);if(t._x===0||t._y===0||t._z===0)return r&&r.copyFromFloats(0,0,0,1),!1;if(r){var u=1/t._x,c=1/t._y,f=1/t._z;n.FromValuesToRef(e[0]*u,e[1]*u,e[2]*u,0,e[4]*c,e[5]*c,e[6]*c,0,e[8]*f,e[9]*f,e[10]*f,0,0,0,0,1,l.Matrix[0]),W.FromRotationMatrixToRef(l.Matrix[0],r)}return!0},n.prototype.getRow=function(t){if(t<0||t>3)return null;var r=t*4;return new st(this._m[r+0],this._m[r+1],this._m[r+2],this._m[r+3])},n.prototype.setRow=function(t,r){return this.setRowFromFloats(t,r.x,r.y,r.z,r.w)},n.prototype.transpose=function(){return n.Transpose(this)},n.prototype.transposeToRef=function(t){return n.TransposeToRef(this,t),this},n.prototype.setRowFromFloats=function(t,r,o,i,e){if(t<0||t>3)return this;var a=t*4;return this._m[a+0]=r,this._m[a+1]=o,this._m[a+2]=i,this._m[a+3]=e,this.markAsUpdated(),this},n.prototype.scale=function(t){var r=new n;return this.scaleToRef(t,r),r},n.prototype.scaleToRef=function(t,r){for(var o=0;o<16;o++)r._m[o]=this._m[o]*t;return r.markAsUpdated(),this},n.prototype.scaleAndAddToRef=function(t,r){for(var o=0;o<16;o++)r._m[o]+=this._m[o]*t;return r.markAsUpdated(),this},n.prototype.toNormalMatrix=function(t){var r=l.Matrix[0];this.invertToRef(r),r.transposeToRef(t);var o=t._m;n.FromValuesToRef(o[0],o[1],o[2],0,o[4],o[5],o[6],0,o[8],o[9],o[10],0,0,0,0,1,t)},n.prototype.getRotationMatrix=function(){var t=new n;return this.getRotationMatrixToRef(t),t},n.prototype.getRotationMatrixToRef=function(t){var r=l.Vector3[0];if(!this.decompose(r))return n.IdentityToRef(t),this;var o=this._m,i=1/r._x,e=1/r._y,a=1/r._z;return n.FromValuesToRef(o[0]*i,o[1]*i,o[2]*i,0,o[4]*e,o[5]*e,o[6]*e,0,o[8]*a,o[9]*a,o[10]*a,0,0,0,0,1,t),this},n.prototype.toggleModelMatrixHandInPlace=function(){var t=this._m;t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this.markAsUpdated()},n.prototype.toggleProjectionMatrixHandInPlace=function(){var t=this._m;t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this.markAsUpdated()},n.FromArray=function(t,r){r===void 0&&(r=0);var o=new n;return n.FromArrayToRef(t,r,o),o},n.FromArrayToRef=function(t,r,o){for(var i=0;i<16;i++)o._m[i]=t[i+r];o.markAsUpdated()},n.FromFloat32ArrayToRefScaled=function(t,r,o,i){for(var e=0;e<16;e++)i._m[e]=t[e+r]*o;i.markAsUpdated()},Object.defineProperty(n,"IdentityReadOnly",{get:function(){return n._IdentityReadOnly},enumerable:!1,configurable:!0}),n.FromValuesToRef=function(t,r,o,i,e,a,s,h,u,c,f,p,v,_,d,x,T){var m=T._m;m[0]=t,m[1]=r,m[2]=o,m[3]=i,m[4]=e,m[5]=a,m[6]=s,m[7]=h,m[8]=u,m[9]=c,m[10]=f,m[11]=p,m[12]=v,m[13]=_,m[14]=d,m[15]=x,T.markAsUpdated()},n.FromValues=function(t,r,o,i,e,a,s,h,u,c,f,p,v,_,d,x){var T=new n,m=T._m;return m[0]=t,m[1]=r,m[2]=o,m[3]=i,m[4]=e,m[5]=a,m[6]=s,m[7]=h,m[8]=u,m[9]=c,m[10]=f,m[11]=p,m[12]=v,m[13]=_,m[14]=d,m[15]=x,T.markAsUpdated(),T},n.Compose=function(t,r,o){var i=new n;return n.ComposeToRef(t,r,o,i),i},n.ComposeToRef=function(t,r,o,i){var e=i._m,a=r._x,s=r._y,h=r._z,u=r._w,c=a+a,f=s+s,p=h+h,v=a*c,_=a*f,d=a*p,x=s*f,T=s*p,m=h*p,A=u*c,g=u*f,P=u*p,z=t._x,M=t._y,I=t._z;e[0]=(1-(x+m))*z,e[1]=(_+P)*z,e[2]=(d-g)*z,e[3]=0,e[4]=(_-P)*M,e[5]=(1-(v+m))*M,e[6]=(T+A)*M,e[7]=0,e[8]=(d+g)*I,e[9]=(T-A)*I,e[10]=(1-(v+x))*I,e[11]=0,e[12]=o._x,e[13]=o._y,e[14]=o._z,e[15]=1,i.markAsUpdated()},n.Identity=function(){var t=n.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t._updateIdentityStatus(!0),t},n.IdentityToRef=function(t){n.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,t),t._updateIdentityStatus(!0)},n.Zero=function(){var t=n.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return t._updateIdentityStatus(!1),t},n.RotationX=function(t){var r=new n;return n.RotationXToRef(t,r),r},n.Invert=function(t){var r=new n;return t.invertToRef(r),r},n.RotationXToRef=function(t,r){var o=Math.sin(t),i=Math.cos(t);n.FromValuesToRef(1,0,0,0,0,i,o,0,0,-o,i,0,0,0,0,1,r),r._updateIdentityStatus(i===1&&o===0)},n.RotationY=function(t){var r=new n;return n.RotationYToRef(t,r),r},n.RotationYToRef=function(t,r){var o=Math.sin(t),i=Math.cos(t);n.FromValuesToRef(i,0,-o,0,0,1,0,0,o,0,i,0,0,0,0,1,r),r._updateIdentityStatus(i===1&&o===0)},n.RotationZ=function(t){var r=new n;return n.RotationZToRef(t,r),r},n.RotationZToRef=function(t,r){var o=Math.sin(t),i=Math.cos(t);n.FromValuesToRef(i,o,0,0,-o,i,0,0,0,0,1,0,0,0,0,1,r),r._updateIdentityStatus(i===1&&o===0)},n.RotationAxis=function(t,r){var o=new n;return n.RotationAxisToRef(t,r,o),o},n.RotationAxisToRef=function(t,r,o){var i=Math.sin(-r),e=Math.cos(-r),a=1-e;t.normalize();var s=o._m;s[0]=t._x*t._x*a+e,s[1]=t._x*t._y*a-t._z*i,s[2]=t._x*t._z*a+t._y*i,s[3]=0,s[4]=t._y*t._x*a+t._z*i,s[5]=t._y*t._y*a+e,s[6]=t._y*t._z*a-t._x*i,s[7]=0,s[8]=t._z*t._x*a-t._y*i,s[9]=t._z*t._y*a+t._x*i,s[10]=t._z*t._z*a+e,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,o.markAsUpdated()},n.RotationAlignToRef=function(t,r,o){var i=y.Dot(r,t),e=o._m;if(i<-1+C)e[0]=-1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0;else{var a=y.Cross(r,t),s=1/(1+i);e[0]=a._x*a._x*s+i,e[1]=a._y*a._x*s-a._z,e[2]=a._z*a._x*s+a._y,e[3]=0,e[4]=a._x*a._y*s+a._z,e[5]=a._y*a._y*s+i,e[6]=a._z*a._y*s-a._x,e[7]=0,e[8]=a._x*a._z*s-a._y,e[9]=a._y*a._z*s+a._x,e[10]=a._z*a._z*s+i,e[11]=0}e[12]=0,e[13]=0,e[14]=0,e[15]=1,o.markAsUpdated()},n.RotationYawPitchRoll=function(t,r,o){var i=new n;return n.RotationYawPitchRollToRef(t,r,o,i),i},n.RotationYawPitchRollToRef=function(t,r,o,i){W.RotationYawPitchRollToRef(t,r,o,l.Quaternion[0]),l.Quaternion[0].toRotationMatrix(i)},n.Scaling=function(t,r,o){var i=new n;return n.ScalingToRef(t,r,o,i),i},n.ScalingToRef=function(t,r,o,i){n.FromValuesToRef(t,0,0,0,0,r,0,0,0,0,o,0,0,0,0,1,i),i._updateIdentityStatus(t===1&&r===1&&o===1)},n.Translation=function(t,r,o){var i=new n;return n.TranslationToRef(t,r,o,i),i},n.TranslationToRef=function(t,r,o,i){n.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,t,r,o,1,i),i._updateIdentityStatus(t===0&&r===0&&o===0)},n.Lerp=function(t,r,o){var i=new n;return n.LerpToRef(t,r,o,i),i},n.LerpToRef=function(t,r,o,i){for(var e=i._m,a=t.m,s=r.m,h=0;h<16;h++)e[h]=a[h]*(1-o)+s[h]*o;i.markAsUpdated()},n.DecomposeLerp=function(t,r,o){var i=new n;return n.DecomposeLerpToRef(t,r,o,i),i},n.DecomposeLerpToRef=function(t,r,o,i){var e=l.Vector3[0],a=l.Quaternion[0],s=l.Vector3[1];t.decompose(e,a,s);var h=l.Vector3[2],u=l.Quaternion[1],c=l.Vector3[3];r.decompose(h,u,c);var f=l.Vector3[4];y.LerpToRef(e,h,o,f);var p=l.Quaternion[2];W.SlerpToRef(a,u,o,p);var v=l.Vector3[5];y.LerpToRef(s,c,o,v),n.ComposeToRef(f,p,v,i)},n.LookAtLH=function(t,r,o){var i=new n;return n.LookAtLHToRef(t,r,o,i),i},n.LookAtLHToRef=function(t,r,o,i){var e=l.Vector3[0],a=l.Vector3[1],s=l.Vector3[2];r.subtractToRef(t,s),s.normalize(),y.CrossToRef(o,s,e);var h=e.lengthSquared();h===0?e.x=1:e.normalizeFromLength(Math.sqrt(h)),y.CrossToRef(s,e,a),a.normalize();var u=-y.Dot(e,t),c=-y.Dot(a,t),f=-y.Dot(s,t);n.FromValuesToRef(e._x,a._x,s._x,0,e._y,a._y,s._y,0,e._z,a._z,s._z,0,u,c,f,1,i)},n.LookAtRH=function(t,r,o){var i=new n;return n.LookAtRHToRef(t,r,o,i),i},n.LookAtRHToRef=function(t,r,o,i){var e=l.Vector3[0],a=l.Vector3[1],s=l.Vector3[2];t.subtractToRef(r,s),s.normalize(),y.CrossToRef(o,s,e);var h=e.lengthSquared();h===0?e.x=1:e.normalizeFromLength(Math.sqrt(h)),y.CrossToRef(s,e,a),a.normalize();var u=-y.Dot(e,t),c=-y.Dot(a,t),f=-y.Dot(s,t);n.FromValuesToRef(e._x,a._x,s._x,0,e._y,a._y,s._y,0,e._z,a._z,s._z,0,u,c,f,1,i)},n.LookDirectionLH=function(t,r){var o=new n;return n.LookDirectionLHToRef(t,r,o),o},n.LookDirectionLHToRef=function(t,r,o){var i=l.Vector3[0];i.copyFrom(t),i.scaleInPlace(-1);var e=l.Vector3[1];y.CrossToRef(r,i,e),n.FromValuesToRef(e._x,e._y,e._z,0,r._x,r._y,r._z,0,i._x,i._y,i._z,0,0,0,0,1,o)},n.LookDirectionRH=function(t,r){var o=new n;return n.LookDirectionRHToRef(t,r,o),o},n.LookDirectionRHToRef=function(t,r,o){var i=l.Vector3[2];y.CrossToRef(r,t,i),n.FromValuesToRef(i._x,i._y,i._z,0,r._x,r._y,r._z,0,t._x,t._y,t._z,0,0,0,0,1,o)},n.OrthoLH=function(t,r,o,i,e){var a=new n;return n.OrthoLHToRef(t,r,o,i,a,e),a},n.OrthoLHToRef=function(t,r,o,i,e,a){var s=o,h=i,u=2/t,c=2/r,f=2/(h-s),p=-(h+s)/(h-s);n.FromValuesToRef(u,0,0,0,0,c,0,0,0,0,f,0,0,0,p,1,e),a&&e.multiplyToRef(J,e),e._updateIdentityStatus(u===1&&c===1&&f===1&&p===0)},n.OrthoOffCenterLH=function(t,r,o,i,e,a,s){var h=new n;return n.OrthoOffCenterLHToRef(t,r,o,i,e,a,h,s),h},n.OrthoOffCenterLHToRef=function(t,r,o,i,e,a,s,h){var u=e,c=a,f=2/(r-t),p=2/(i-o),v=2/(c-u),_=-(c+u)/(c-u),d=(t+r)/(t-r),x=(i+o)/(o-i);n.FromValuesToRef(f,0,0,0,0,p,0,0,0,0,v,0,d,x,_,1,s),h&&s.multiplyToRef(J,s),s.markAsUpdated()},n.OrthoOffCenterRH=function(t,r,o,i,e,a,s){var h=new n;return n.OrthoOffCenterRHToRef(t,r,o,i,e,a,h,s),h},n.OrthoOffCenterRHToRef=function(t,r,o,i,e,a,s,h){n.OrthoOffCenterLHToRef(t,r,o,i,e,a,s,h),s._m[10]*=-1},n.PerspectiveLH=function(t,r,o,i,e,a){a===void 0&&(a=0);var s=new n,h=o,u=i,c=2*h/t,f=2*h/r,p=(u+h)/(u-h),v=-2*u*h/(u-h),_=Math.tan(a);return n.FromValuesToRef(c,0,0,0,0,f,0,_,0,0,p,1,0,0,v,0,s),e&&s.multiplyToRef(J,s),s._updateIdentityStatus(!1),s},n.PerspectiveFovLH=function(t,r,o,i,e,a,s){a===void 0&&(a=0),s===void 0&&(s=!1);var h=new n;return n.PerspectiveFovLHToRef(t,r,o,i,h,!0,e,a,s),h},n.PerspectiveFovLHToRef=function(t,r,o,i,e,a,s,h,u){a===void 0&&(a=!0),h===void 0&&(h=0),u===void 0&&(u=!1);var c=o,f=i,p=1/Math.tan(t*.5),v=a?p/r:p,_=a?p:p*r,d=u&&c===0?-1:f!==0?(f+c)/(f-c):1,x=u&&c===0?2*f:f!==0?-2*f*c/(f-c):-2*c,T=Math.tan(h);n.FromValuesToRef(v,0,0,0,0,_,0,T,0,0,d,1,0,0,x,0,e),s&&e.multiplyToRef(J,e),e._updateIdentityStatus(!1)},n.PerspectiveFovReverseLHToRef=function(t,r,o,i,e,a,s,h){a===void 0&&(a=!0),h===void 0&&(h=0);var u=1/Math.tan(t*.5),c=a?u/r:u,f=a?u:u*r,p=Math.tan(h);n.FromValuesToRef(c,0,0,0,0,f,0,p,0,0,-o,1,0,0,1,0,e),s&&e.multiplyToRef(J,e),e._updateIdentityStatus(!1)},n.PerspectiveFovRH=function(t,r,o,i,e,a,s){a===void 0&&(a=0),s===void 0&&(s=!1);var h=new n;return n.PerspectiveFovRHToRef(t,r,o,i,h,!0,e,a,s),h},n.PerspectiveFovRHToRef=function(t,r,o,i,e,a,s,h,u){a===void 0&&(a=!0),h===void 0&&(h=0),u===void 0&&(u=!1);var c=o,f=i,p=1/Math.tan(t*.5),v=a?p/r:p,_=a?p:p*r,d=u&&c===0?1:f!==0?-(f+c)/(f-c):-1,x=u&&c===0?2*f:f!==0?-2*f*c/(f-c):-2*c,T=Math.tan(h);n.FromValuesToRef(v,0,0,0,0,_,0,T,0,0,d,-1,0,0,x,0,e),s&&e.multiplyToRef(J,e),e._updateIdentityStatus(!1)},n.PerspectiveFovReverseRHToRef=function(t,r,o,i,e,a,s,h){a===void 0&&(a=!0),h===void 0&&(h=0);var u=1/Math.tan(t*.5),c=a?u/r:u,f=a?u:u*r,p=Math.tan(h);n.FromValuesToRef(c,0,0,0,0,f,0,p,0,0,-o,-1,0,0,-1,0,e),s&&e.multiplyToRef(J,e),e._updateIdentityStatus(!1)},n.PerspectiveFovWebVRToRef=function(t,r,o,i,e,a,s){e===void 0&&(e=!1),s===void 0&&(s=0);var h=e?-1:1,u=Math.tan(t.upDegrees*Math.PI/180),c=Math.tan(t.downDegrees*Math.PI/180),f=Math.tan(t.leftDegrees*Math.PI/180),p=Math.tan(t.rightDegrees*Math.PI/180),v=2/(f+p),_=2/(u+c),d=Math.tan(s),x=i._m;x[0]=v,x[1]=x[2]=x[3]=x[4]=0,x[5]=_,x[6]=0,x[7]=d,x[8]=(f-p)*v*.5,x[9]=-((u-c)*_*.5),x[10]=-o/(r-o),x[11]=1*h,x[12]=x[13]=x[15]=0,x[14]=-(2*o*r)/(o-r),a&&i.multiplyToRef(J,i),i.markAsUpdated()},n.GetFinalMatrix=function(t,r,o,i,e,a){var s=t.width,h=t.height,u=t.x,c=t.y,f=n.FromValues(s/2,0,0,0,0,-h/2,0,0,0,0,a-e,0,u+s/2,h/2+c,e,1),p=l.Matrix[0];return r.multiplyToRef(o,p),p.multiplyToRef(i,p),p.multiply(f)},n.GetAsMatrix2x2=function(t){var r=t.m,o=[r[0],r[1],r[4],r[5]];return rt.MatrixUse64Bits?o:new Float32Array(o)},n.GetAsMatrix3x3=function(t){var r=t.m,o=[r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10]];return rt.MatrixUse64Bits?o:new Float32Array(o)},n.Transpose=function(t){var r=new n;return n.TransposeToRef(t,r),r},n.TransposeToRef=function(t,r){var o=r._m,i=t.m;o[0]=i[0],o[1]=i[4],o[2]=i[8],o[3]=i[12],o[4]=i[1],o[5]=i[5],o[6]=i[9],o[7]=i[13],o[8]=i[2],o[9]=i[6],o[10]=i[10],o[11]=i[14],o[12]=i[3],o[13]=i[7],o[14]=i[11],o[15]=i[15],r.markAsUpdated(),r._updateIdentityStatus(t._isIdentity,t._isIdentityDirty)},n.Reflection=function(t){var r=new n;return n.ReflectionToRef(t,r),r},n.ReflectionToRef=function(t,r){t.normalize();var o=t.normal.x,i=t.normal.y,e=t.normal.z,a=-2*o,s=-2*i,h=-2*e;n.FromValuesToRef(a*o+1,s*o,h*o,0,a*i,s*i+1,h*i,0,a*e,s*e,h*e+1,0,a*t.d,s*t.d,h*t.d,1,r)},n.FromXYZAxesToRef=function(t,r,o,i){n.FromValuesToRef(t._x,t._y,t._z,0,r._x,r._y,r._z,0,o._x,o._y,o._z,0,0,0,0,1,i)},n.FromQuaternionToRef=function(t,r){var o=t._x*t._x,i=t._y*t._y,e=t._z*t._z,a=t._x*t._y,s=t._z*t._w,h=t._z*t._x,u=t._y*t._w,c=t._y*t._z,f=t._x*t._w;r._m[0]=1-2*(i+e),r._m[1]=2*(a+s),r._m[2]=2*(h-u),r._m[3]=0,r._m[4]=2*(a-s),r._m[5]=1-2*(e+o),r._m[6]=2*(c+f),r._m[7]=0,r._m[8]=2*(h+u),r._m[9]=2*(c-f),r._m[10]=1-2*(i+o),r._m[11]=0,r._m[12]=0,r._m[13]=0,r._m[14]=0,r._m[15]=1,r.markAsUpdated()},n._UpdateFlagSeed=0,n._IdentityReadOnly=n.Identity(),n}(),l=function(){function n(){}return n.Vector3=Y.BuildTuple(11,y.Zero),n.Matrix=Y.BuildTuple(2,U.Identity),n.Quaternion=Y.BuildTuple(3,W.Zero),n}(),w=function(){function n(){}return n.Vector2=Y.BuildTuple(3,G.Zero),n.Vector3=Y.BuildTuple(13,y.Zero),n.Vector4=Y.BuildTuple(3,st.Zero),n.Quaternion=Y.BuildTuple(2,W.Zero),n.Matrix=Y.BuildTuple(8,U.Identity),n}();et("BABYLON.Vector2",G);et("BABYLON.Vector3",y);et("BABYLON.Vector4",st);et("BABYLON.Matrix",U);var J=U.FromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1),lt=function(){function n(t,r,o){t===void 0&&(t=0),r===void 0&&(r=0),o===void 0&&(o=0),this.r=t,this.g=r,this.b=o}return n.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"},n.prototype.getClassName=function(){return"Color3"},n.prototype.getHashCode=function(){var t=this.r*255|0;return t=t*397^(this.g*255|0),t=t*397^(this.b*255|0),t},n.prototype.toArray=function(t,r){return r===void 0&&(r=0),t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,this},n.prototype.fromArray=function(t,r){return r===void 0&&(r=0),n.FromArrayToRef(t,r,this),this},n.prototype.toColor4=function(t){return t===void 0&&(t=1),new ht(this.r,this.g,this.b,t)},n.prototype.asArray=function(){return[this.r,this.g,this.b]},n.prototype.toLuminance=function(){return this.r*.3+this.g*.59+this.b*.11},n.prototype.multiply=function(t){return new n(this.r*t.r,this.g*t.g,this.b*t.b)},n.prototype.multiplyToRef=function(t,r){return r.r=this.r*t.r,r.g=this.g*t.g,r.b=this.b*t.b,this},n.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b},n.prototype.equalsFloats=function(t,r,o){return this.r===t&&this.g===r&&this.b===o},n.prototype.scale=function(t){return new n(this.r*t,this.g*t,this.b*t)},n.prototype.scaleInPlace=function(t){return this.r*=t,this.g*=t,this.b*=t,this},n.prototype.scaleToRef=function(t,r){return r.r=this.r*t,r.g=this.g*t,r.b=this.b*t,this},n.prototype.scaleAndAddToRef=function(t,r){return r.r+=this.r*t,r.g+=this.g*t,r.b+=this.b*t,this},n.prototype.clampToRef=function(t,r,o){return t===void 0&&(t=0),r===void 0&&(r=1),o.r=R.Clamp(this.r,t,r),o.g=R.Clamp(this.g,t,r),o.b=R.Clamp(this.b,t,r),this},n.prototype.add=function(t){return new n(this.r+t.r,this.g+t.g,this.b+t.b)},n.prototype.addToRef=function(t,r){return r.r=this.r+t.r,r.g=this.g+t.g,r.b=this.b+t.b,this},n.prototype.subtract=function(t){return new n(this.r-t.r,this.g-t.g,this.b-t.b)},n.prototype.subtractToRef=function(t,r){return r.r=this.r-t.r,r.g=this.g-t.g,r.b=this.b-t.b,this},n.prototype.clone=function(){return new n(this.r,this.g,this.b)},n.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},n.prototype.copyFromFloats=function(t,r,o){return this.r=t,this.g=r,this.b=o,this},n.prototype.set=function(t,r,o){return this.copyFromFloats(t,r,o)},n.prototype.toHexString=function(){var t=Math.round(this.r*255),r=Math.round(this.g*255),o=Math.round(this.b*255);return"#"+R.ToHex(t)+R.ToHex(r)+R.ToHex(o)},n.prototype.toLinearSpace=function(){var t=new n;return this.toLinearSpaceToRef(t),t},n.prototype.toHSV=function(){var t=new n;return this.toHSVToRef(t),t},n.prototype.toHSVToRef=function(t){var r=this.r,o=this.g,i=this.b,e=Math.max(r,o,i),a=Math.min(r,o,i),s=0,h=0,u=e,c=e-a;e!==0&&(h=c/e),e!=a&&(e==r?(s=(o-i)/c,o<i&&(s+=6)):e==o?s=(i-r)/c+2:e==i&&(s=(r-o)/c+4),s*=60),t.r=s,t.g=h,t.b=u},n.prototype.toLinearSpaceToRef=function(t){return t.r=Math.pow(this.r,ot),t.g=Math.pow(this.g,ot),t.b=Math.pow(this.b,ot),this},n.prototype.toGammaSpace=function(){var t=new n;return this.toGammaSpaceToRef(t),t},n.prototype.toGammaSpaceToRef=function(t){return t.r=Math.pow(this.r,nt),t.g=Math.pow(this.g,nt),t.b=Math.pow(this.b,nt),this},n.HSVtoRGBToRef=function(t,r,o,i){var e=o*r,a=t/60,s=e*(1-Math.abs(a%2-1)),h=0,u=0,c=0;a>=0&&a<=1?(h=e,u=s):a>=1&&a<=2?(h=s,u=e):a>=2&&a<=3?(u=e,c=s):a>=3&&a<=4?(u=s,c=e):a>=4&&a<=5?(h=s,c=e):a>=5&&a<=6&&(h=e,c=s);var f=o-e;i.set(h+f,u+f,c+f)},n.FromHSV=function(t,r,o){var i=new n(0,0,0);return n.HSVtoRGBToRef(t,r,o,i),i},n.FromHexString=function(t){if(t.substring(0,1)!=="#"||t.length!==7)return new n(0,0,0);var r=parseInt(t.substring(1,3),16),o=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16);return n.FromInts(r,o,i)},n.FromArray=function(t,r){return r===void 0&&(r=0),new n(t[r],t[r+1],t[r+2])},n.FromArrayToRef=function(t,r,o){r===void 0&&(r=0),o.r=t[r],o.g=t[r+1],o.b=t[r+2]},n.FromInts=function(t,r,o){return new n(t/255,r/255,o/255)},n.Lerp=function(t,r,o){var i=new n(0,0,0);return n.LerpToRef(t,r,o,i),i},n.LerpToRef=function(t,r,o,i){i.r=t.r+(r.r-t.r)*o,i.g=t.g+(r.g-t.g)*o,i.b=t.b+(r.b-t.b)*o},n.Hermite=function(t,r,o,i,e){var a=e*e,s=e*a,h=2*s-3*a+1,u=-2*s+3*a,c=s-2*a+e,f=s-a,p=t.r*h+o.r*u+r.r*c+i.r*f,v=t.g*h+o.g*u+r.g*c+i.g*f,_=t.b*h+o.b*u+r.b*c+i.b*f;return new n(p,v,_)},n.Hermite1stDerivative=function(t,r,o,i,e){var a=n.Black();return this.Hermite1stDerivativeToRef(t,r,o,i,e,a),a},n.Hermite1stDerivativeToRef=function(t,r,o,i,e,a){var s=e*e;a.r=(s-e)*6*t.r+(3*s-4*e+1)*r.r+(-s+e)*6*o.r+(3*s-2*e)*i.r,a.g=(s-e)*6*t.g+(3*s-4*e+1)*r.g+(-s+e)*6*o.g+(3*s-2*e)*i.g,a.b=(s-e)*6*t.b+(3*s-4*e+1)*r.b+(-s+e)*6*o.b+(3*s-2*e)*i.b},n.Red=function(){return new n(1,0,0)},n.Green=function(){return new n(0,1,0)},n.Blue=function(){return new n(0,0,1)},n.Black=function(){return new n(0,0,0)},Object.defineProperty(n,"BlackReadOnly",{get:function(){return n._BlackReadOnly},enumerable:!1,configurable:!0}),n.White=function(){return new n(1,1,1)},n.Purple=function(){return new n(.5,0,.5)},n.Magenta=function(){return new n(1,0,1)},n.Yellow=function(){return new n(1,1,0)},n.Gray=function(){return new n(.5,.5,.5)},n.Teal=function(){return new n(0,1,1)},n.Random=function(){return new n(Math.random(),Math.random(),Math.random())},n._BlackReadOnly=n.Black(),n}(),ht=function(){function n(t,r,o,i){t===void 0&&(t=0),r===void 0&&(r=0),o===void 0&&(o=0),i===void 0&&(i=1),this.r=t,this.g=r,this.b=o,this.a=i}return n.prototype.addInPlace=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this},n.prototype.asArray=function(){return[this.r,this.g,this.b,this.a]},n.prototype.toArray=function(t,r){return r===void 0&&(r=0),t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t[r+3]=this.a,this},n.prototype.fromArray=function(t,r){return r===void 0&&(r=0),n.FromArrayToRef(t,r,this),this},n.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},n.prototype.add=function(t){return new n(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)},n.prototype.subtract=function(t){return new n(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)},n.prototype.subtractToRef=function(t,r){return r.r=this.r-t.r,r.g=this.g-t.g,r.b=this.b-t.b,r.a=this.a-t.a,this},n.prototype.scale=function(t){return new n(this.r*t,this.g*t,this.b*t,this.a*t)},n.prototype.scaleInPlace=function(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this},n.prototype.scaleToRef=function(t,r){return r.r=this.r*t,r.g=this.g*t,r.b=this.b*t,r.a=this.a*t,this},n.prototype.scaleAndAddToRef=function(t,r){return r.r+=this.r*t,r.g+=this.g*t,r.b+=this.b*t,r.a+=this.a*t,this},n.prototype.clampToRef=function(t,r,o){return t===void 0&&(t=0),r===void 0&&(r=1),o.r=R.Clamp(this.r,t,r),o.g=R.Clamp(this.g,t,r),o.b=R.Clamp(this.b,t,r),o.a=R.Clamp(this.a,t,r),this},n.prototype.multiply=function(t){return new n(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)},n.prototype.multiplyToRef=function(t,r){return r.r=this.r*t.r,r.g=this.g*t.g,r.b=this.b*t.b,r.a=this.a*t.a,r},n.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"},n.prototype.getClassName=function(){return"Color4"},n.prototype.getHashCode=function(){var t=this.r*255|0;return t=t*397^(this.g*255|0),t=t*397^(this.b*255|0),t=t*397^(this.a*255|0),t},n.prototype.clone=function(){return new n(this.r,this.g,this.b,this.a)},n.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},n.prototype.copyFromFloats=function(t,r,o,i){return this.r=t,this.g=r,this.b=o,this.a=i,this},n.prototype.set=function(t,r,o,i){return this.copyFromFloats(t,r,o,i)},n.prototype.toHexString=function(t){t===void 0&&(t=!1);var r=Math.round(this.r*255),o=Math.round(this.g*255),i=Math.round(this.b*255);if(t)return"#"+R.ToHex(r)+R.ToHex(o)+R.ToHex(i);var e=Math.round(this.a*255);return"#"+R.ToHex(r)+R.ToHex(o)+R.ToHex(i)+R.ToHex(e)},n.prototype.toLinearSpace=function(){var t=new n;return this.toLinearSpaceToRef(t),t},n.prototype.toLinearSpaceToRef=function(t){return t.r=Math.pow(this.r,ot),t.g=Math.pow(this.g,ot),t.b=Math.pow(this.b,ot),t.a=this.a,this},n.prototype.toGammaSpace=function(){var t=new n;return this.toGammaSpaceToRef(t),t},n.prototype.toGammaSpaceToRef=function(t){return t.r=Math.pow(this.r,nt),t.g=Math.pow(this.g,nt),t.b=Math.pow(this.b,nt),t.a=this.a,this},n.FromHexString=function(t){if(t.substring(0,1)!=="#"||t.length!==9&&t.length!==7)return new n(0,0,0,0);var r=parseInt(t.substring(1,3),16),o=parseInt(t.substring(3,5),16),i=parseInt(t.substring(5,7),16),e=t.length===9?parseInt(t.substring(7,9),16):255;return n.FromInts(r,o,i,e)},n.Lerp=function(t,r,o){var i=new n(0,0,0,0);return n.LerpToRef(t,r,o,i),i},n.LerpToRef=function(t,r,o,i){i.r=t.r+(r.r-t.r)*o,i.g=t.g+(r.g-t.g)*o,i.b=t.b+(r.b-t.b)*o,i.a=t.a+(r.a-t.a)*o},n.Hermite=function(t,r,o,i,e){var a=e*e,s=e*a,h=2*s-3*a+1,u=-2*s+3*a,c=s-2*a+e,f=s-a,p=t.r*h+o.r*u+r.r*c+i.r*f,v=t.g*h+o.g*u+r.g*c+i.g*f,_=t.b*h+o.b*u+r.b*c+i.b*f,d=t.a*h+o.a*u+r.a*c+i.a*f;return new n(p,v,_,d)},n.Hermite1stDerivative=function(t,r,o,i,e){var a=new n;return this.Hermite1stDerivativeToRef(t,r,o,i,e,a),a},n.Hermite1stDerivativeToRef=function(t,r,o,i,e,a){var s=e*e;a.r=(s-e)*6*t.r+(3*s-4*e+1)*r.r+(-s+e)*6*o.r+(3*s-2*e)*i.r,a.g=(s-e)*6*t.g+(3*s-4*e+1)*r.g+(-s+e)*6*o.g+(3*s-2*e)*i.g,a.b=(s-e)*6*t.b+(3*s-4*e+1)*r.b+(-s+e)*6*o.b+(3*s-2*e)*i.b,a.a=(s-e)*6*t.a+(3*s-4*e+1)*r.a+(-s+e)*6*o.a+(3*s-2*e)*i.a},n.FromColor3=function(t,r){return r===void 0&&(r=1),new n(t.r,t.g,t.b,r)},n.FromArray=function(t,r){return r===void 0&&(r=0),new n(t[r],t[r+1],t[r+2],t[r+3])},n.FromArrayToRef=function(t,r,o){r===void 0&&(r=0),o.r=t[r],o.g=t[r+1],o.b=t[r+2],o.a=t[r+3]},n.FromInts=function(t,r,o,i){return new n(t/255,r/255,o/255,i/255)},n.CheckColors4=function(t,r){if(t.length===r*3){for(var o=[],i=0;i<t.length;i+=3){var e=i/3*4;o[e]=t[i],o[e+1]=t[i+1],o[e+2]=t[i+2],o[e+3]=1}return o}return t},n}(),Nt=function(){function n(){}return n.Color3=Y.BuildArray(3,lt.Black),n.Color4=Y.BuildArray(3,function(){return new ht(0,0,0,0)}),n}();et("BABYLON.Color3",lt);et("BABYLON.Color4",ht);var Ut=function(){function n(t,r){this.width=t,this.height=r}return n.prototype.toString=function(){return"{W: ".concat(this.width,", H: ").concat(this.height,"}")},n.prototype.getClassName=function(){return"Size"},n.prototype.getHashCode=function(){var t=this.width|0;return t=t*397^(this.height|0),t},n.prototype.copyFrom=function(t){this.width=t.width,this.height=t.height},n.prototype.copyFromFloats=function(t,r){return this.width=t,this.height=r,this},n.prototype.set=function(t,r){return this.copyFromFloats(t,r)},n.prototype.multiplyByFloats=function(t,r){return new n(this.width*t,this.height*r)},n.prototype.clone=function(){return new n(this.width,this.height)},n.prototype.equals=function(t){return t?this.width===t.width&&this.height===t.height:!1},Object.defineProperty(n.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),n.Zero=function(){return new n(0,0)},n.prototype.add=function(t){var r=new n(this.width+t.width,this.height+t.height);return r},n.prototype.subtract=function(t){var r=new n(this.width-t.width,this.height-t.height);return r},n.Lerp=function(t,r,o){var i=t.width+(r.width-t.width)*o,e=t.height+(r.height-t.height)*o;return new n(i,e)},n}(),Dt=function(){function n(t,r,o,i){this.normal=new y(t,r,o),this.d=i}return n.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},n.prototype.clone=function(){return new n(this.normal.x,this.normal.y,this.normal.z,this.d)},n.prototype.getClassName=function(){return"Plane"},n.prototype.getHashCode=function(){var t=this.normal.getHashCode();return t=t*397^(this.d|0),t},n.prototype.normalize=function(){var t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),r=0;return t!==0&&(r=1/t),this.normal.x*=r,this.normal.y*=r,this.normal.z*=r,this.d*=r,this},n.prototype.transform=function(t){var r=n._TmpMatrix;t.invertToRef(r);var o=r.m,i=this.normal.x,e=this.normal.y,a=this.normal.z,s=this.d,h=i*o[0]+e*o[1]+a*o[2]+s*o[3],u=i*o[4]+e*o[5]+a*o[6]+s*o[7],c=i*o[8]+e*o[9]+a*o[10]+s*o[11],f=i*o[12]+e*o[13]+a*o[14]+s*o[15];return new n(h,u,c,f)},n.prototype.dotCoordinate=function(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d},n.prototype.copyFromPoints=function(t,r,o){var i=r.x-t.x,e=r.y-t.y,a=r.z-t.z,s=o.x-t.x,h=o.y-t.y,u=o.z-t.z,c=e*u-a*h,f=a*s-i*u,p=i*h-e*s,v=Math.sqrt(c*c+f*f+p*p),_;return v!==0?_=1/v:_=0,this.normal.x=c*_,this.normal.y=f*_,this.normal.z=p*_,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this},n.prototype.isFrontFacingTo=function(t,r){var o=y.Dot(this.normal,t);return o<=r},n.prototype.signedDistanceTo=function(t){return y.Dot(t,this.normal)+this.d},n.FromArray=function(t){return new n(t[0],t[1],t[2],t[3])},n.FromPoints=function(t,r,o){var i=new n(0,0,0,0);return i.copyFromPoints(t,r,o),i},n.FromPositionAndNormal=function(t,r){var o=new n(0,0,0,0);return r.normalize(),o.normal=r,o.d=-(r.x*t.x+r.y*t.y+r.z*t.z),o},n.SignedDistanceToPlaneFromPositionAndNormal=function(t,r,o){var i=-(r.x*t.x+r.y*t.y+r.z*t.z);return y.Dot(o,r)+i},n._TmpMatrix=U.Identity(),n}(),Et=function(){function n(){}return n.GetPlanes=function(t){for(var r=[],o=0;o<6;o++)r.push(new Dt(0,0,0,0));return n.GetPlanesToRef(t,r),r},n.GetNearPlaneToRef=function(t,r){var o=t.m;r.normal.x=o[3]+o[2],r.normal.y=o[7]+o[6],r.normal.z=o[11]+o[10],r.d=o[15]+o[14],r.normalize()},n.GetFarPlaneToRef=function(t,r){var o=t.m;r.normal.x=o[3]-o[2],r.normal.y=o[7]-o[6],r.normal.z=o[11]-o[10],r.d=o[15]-o[14],r.normalize()},n.GetLeftPlaneToRef=function(t,r){var o=t.m;r.normal.x=o[3]+o[0],r.normal.y=o[7]+o[4],r.normal.z=o[11]+o[8],r.d=o[15]+o[12],r.normalize()},n.GetRightPlaneToRef=function(t,r){var o=t.m;r.normal.x=o[3]-o[0],r.normal.y=o[7]-o[4],r.normal.z=o[11]-o[8],r.d=o[15]-o[12],r.normalize()},n.GetTopPlaneToRef=function(t,r){var o=t.m;r.normal.x=o[3]-o[1],r.normal.y=o[7]-o[5],r.normal.z=o[11]-o[9],r.d=o[15]-o[13],r.normalize()},n.GetBottomPlaneToRef=function(t,r){var o=t.m;r.normal.x=o[3]+o[1],r.normal.y=o[7]+o[5],r.normal.z=o[11]+o[9],r.d=o[15]+o[13],r.normalize()},n.GetPlanesToRef=function(t,r){n.GetNearPlaneToRef(t,r[0]),n.GetFarPlaneToRef(t,r[1]),n.GetLeftPlaneToRef(t,r[2]),n.GetRightPlaneToRef(t,r[3]),n.GetTopPlaneToRef(t,r[4]),n.GetBottomPlaneToRef(t,r[5])},n}(),_t;(function(n){n[n.LOCAL=0]="LOCAL",n[n.WORLD=1]="WORLD",n[n.BONE=2]="BONE"})(_t||(_t={}));var Bt=function(){function n(){}return n.X=new y(1,0,0),n.Y=new y(0,1,0),n.Z=new y(0,0,1),n}(),vt;(function(n){n[n.X=0]="X",n[n.Y=1]="Y",n[n.Z=2]="Z"})(vt||(vt={}));var it;(function(n){n[n.CW=0]="CW",n[n.CCW=1]="CCW"})(it||(it={}));var kt=function(){function n(){}return n.Interpolate=function(t,r,o,i,e){for(var a=1-3*i+3*r,s=3*i-6*r,h=3*r,u=t,c=0;c<5;c++){var f=u*u,p=f*u,v=a*p+s*f+h*u,_=1/(3*a*f+2*s*u+h);u-=(v-t)*_,u=Math.min(1,Math.max(0,u))}return 3*Math.pow(1-u,2)*u*o+3*(1-u)*Math.pow(u,2)*e+Math.pow(u,3)},n}(),at=function(){function n(t){this._radians=t,this._radians<0&&(this._radians+=2*Math.PI)}return n.prototype.degrees=function(){return this._radians*180/Math.PI},n.prototype.radians=function(){return this._radians},n.BetweenTwoPoints=function(t,r){var o=r.subtract(t),i=Math.atan2(o.y,o.x);return new n(i)},n.FromRadians=function(t){return new n(t)},n.FromDegrees=function(t){return new n(t*Math.PI/180)},n}(),Lt=function(){function n(t,r,o){this.startPoint=t,this.midPoint=r,this.endPoint=o;var i=Math.pow(r.x,2)+Math.pow(r.y,2),e=(Math.pow(t.x,2)+Math.pow(t.y,2)-i)/2,a=(i-Math.pow(o.x,2)-Math.pow(o.y,2))/2,s=(t.x-r.x)*(r.y-o.y)-(r.x-o.x)*(t.y-r.y);this.centerPoint=new G((e*(r.y-o.y)-a*(t.y-r.y))/s,((t.x-r.x)*a-(r.x-o.x)*e)/s),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=at.BetweenTwoPoints(this.centerPoint,this.startPoint);var h=this.startAngle.degrees(),u=at.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),c=at.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();u-h>180&&(u-=360),u-h<-180&&(u+=360),c-u>180&&(c-=360),c-u<-180&&(c+=360),this.orientation=u-h<0?it.CW:it.CCW,this.angle=at.FromDegrees(this.orientation===it.CW?h-c:c-h)}return n}(),Gt=function(){function n(t,r){this._points=new Array,this._length=0,this.closed=!1,this._points.push(new G(t,r))}return n.prototype.addLineTo=function(t,r){if(this.closed)return this;var o=new G(t,r),i=this._points[this._points.length-1];return this._points.push(o),this._length+=o.subtract(i).length(),this},n.prototype.addArcTo=function(t,r,o,i,e){if(e===void 0&&(e=36),this.closed)return this;var a=this._points[this._points.length-1],s=new G(t,r),h=new G(o,i),u=new Lt(a,s,h),c=u.angle.radians()/e;u.orientation===it.CW&&(c*=-1);for(var f=u.startAngle.radians()+c,p=0;p<e;p++){var v=Math.cos(f)*u.radius+u.centerPoint.x,_=Math.sin(f)*u.radius+u.centerPoint.y;this.addLineTo(v,_),f+=c}return this},n.prototype.close=function(){return this.closed=!0,this},n.prototype.length=function(){var t=this._length;if(this.closed){var r=this._points[this._points.length-1],o=this._points[0];t+=o.subtract(r).length()}return t},n.prototype.getPoints=function(){return this._points},n.prototype.getPointAtLengthPosition=function(t){if(t<0||t>1)return G.Zero();for(var r=t*this.length(),o=0,i=0;i<this._points.length;i++){var e=(i+1)%this._points.length,a=this._points[i],s=this._points[e],h=s.subtract(a),u=h.length()+o;if(r>=o&&r<=u){var c=h.normalize(),f=r-o;return new G(a.x+c.x*f,a.y+c.y*f)}o=u}return G.Zero()},n.StartingAt=function(t,r){return new n(t,r)},n}(),Wt=function(){function n(t,r,o,i){r===void 0&&(r=null),i===void 0&&(i=!1),this.path=t,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array,this._pointAtData={id:0,point:y.Zero(),previousPointArrayIndex:0,position:0,subPosition:0,interpolateReady:!1,interpolationMatrix:U.Identity()};for(var e=0;e<t.length;e++)this._curve[e]=t[e].clone();this._raw=o||!1,this._alignTangentsWithPath=i,this._compute(r,i)}return n.prototype.getCurve=function(){return this._curve},n.prototype.getPoints=function(){return this._curve},n.prototype.length=function(){return this._distances[this._distances.length-1]},n.prototype.getTangents=function(){return this._tangents},n.prototype.getNormals=function(){return this._normals},n.prototype.getBinormals=function(){return this._binormals},n.prototype.getDistances=function(){return this._distances},n.prototype.getPointAt=function(t){return this._updatePointAtData(t).point},n.prototype.getTangentAt=function(t,r){return r===void 0&&(r=!1),this._updatePointAtData(t,r),r?y.TransformCoordinates(y.Forward(),this._pointAtData.interpolationMatrix):this._tangents[this._pointAtData.previousPointArrayIndex]},n.prototype.getNormalAt=function(t,r){return r===void 0&&(r=!1),this._updatePointAtData(t,r),r?y.TransformCoordinates(y.Right(),this._pointAtData.interpolationMatrix):this._normals[this._pointAtData.previousPointArrayIndex]},n.prototype.getBinormalAt=function(t,r){return r===void 0&&(r=!1),this._updatePointAtData(t,r),r?y.TransformCoordinates(y.UpReadOnly,this._pointAtData.interpolationMatrix):this._binormals[this._pointAtData.previousPointArrayIndex]},n.prototype.getDistanceAt=function(t){return this.length()*t},n.prototype.getPreviousPointIndexAt=function(t){return this._updatePointAtData(t),this._pointAtData.previousPointArrayIndex},n.prototype.getSubPositionAt=function(t){return this._updatePointAtData(t),this._pointAtData.subPosition},n.prototype.getClosestPositionTo=function(t){for(var r=Number.MAX_VALUE,o=0,i=0;i<this._curve.length-1;i++){var e=this._curve[i+0],a=this._curve[i+1].subtract(e).normalize(),s=this._distances[i+1]-this._distances[i+0],h=Math.min(Math.max(y.Dot(a,t.subtract(e).normalize()),0)*y.Distance(e,t)/s,1),u=y.Distance(e.add(a.scale(h*s)),t);u<r&&(r=u,o=(this._distances[i+0]+s*h)/this.length())}return o},n.prototype.slice=function(t,r){if(t===void 0&&(t=0),r===void 0&&(r=1),t<0&&(t=1-t*-1%1),r<0&&(r=1-r*-1%1),t>r){var o=t;t=r,r=o}var i=this.getCurve(),e=this.getPointAt(t),a=this.getPreviousPointIndexAt(t),s=this.getPointAt(r),h=this.getPreviousPointIndexAt(r)+1,u=[];return t!==0&&(a++,u.push(e)),u.push.apply(u,i.slice(a,h)),(r!==1||t===1)&&u.push(s),new n(u,this.getNormalAt(t),this._raw,this._alignTangentsWithPath)},n.prototype.update=function(t,r,o){r===void 0&&(r=null),o===void 0&&(o=!1);for(var i=0;i<t.length;i++)this._curve[i].x=t[i].x,this._curve[i].y=t[i].y,this._curve[i].z=t[i].z;return this._compute(r,o),this},n.prototype._compute=function(t,r){r===void 0&&(r=!1);var o=this._curve.length;if(!(o<2)){this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[o-1]=this._curve[o-1].subtract(this._curve[o-2]),this._raw||this._tangents[o-1].normalize();var i=this._tangents[0],e=this._normalVector(i,t);this._normals[0]=e,this._raw||this._normals[0].normalize(),this._binormals[0]=y.Cross(i,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(var a,s,h,u,c,f=1;f<o;f++)a=this._getLastNonNullVector(f),f<o-1&&(s=this._getFirstNonNullVector(f),this._tangents[f]=r?s:a.add(s),this._tangents[f].normalize()),this._distances[f]=this._distances[f-1]+this._curve[f].subtract(this._curve[f-1]).length(),h=this._tangents[f],c=this._binormals[f-1],this._normals[f]=y.Cross(c,h),this._raw||(this._normals[f].length()===0?(u=this._normals[f-1],this._normals[f]=u.clone()):this._normals[f].normalize()),this._binormals[f]=y.Cross(h,this._normals[f]),this._raw||this._binormals[f].normalize();this._pointAtData.id=NaN}},n.prototype._getFirstNonNullVector=function(t){for(var r=1,o=this._curve[t+r].subtract(this._curve[t]);o.length()===0&&t+r+1<this._curve.length;)r++,o=this._curve[t+r].subtract(this._curve[t]);return o},n.prototype._getLastNonNullVector=function(t){for(var r=1,o=this._curve[t].subtract(this._curve[t-r]);o.length()===0&&t>r+1;)r++,o=this._curve[t].subtract(this._curve[t-r]);return o},n.prototype._normalVector=function(t,r){var o,i=t.length();if(i===0&&(i=1),r==null){var e=void 0;R.WithinEpsilon(Math.abs(t.y)/i,1,C)?R.WithinEpsilon(Math.abs(t.x)/i,1,C)?R.WithinEpsilon(Math.abs(t.z)/i,1,C)?e=y.Zero():e=new y(0,0,1):e=new y(1,0,0):e=new y(0,-1,0),o=y.Cross(t,e)}else o=y.Cross(t,r),y.CrossToRef(o,t,o);return o.normalize(),o},n.prototype._updatePointAtData=function(t,r){if(r===void 0&&(r=!1),this._pointAtData.id===t)return this._pointAtData.interpolateReady||this._updateInterpolationMatrix(),this._pointAtData;this._pointAtData.id=t;var o=this.getPoints();if(t<=0)return this._setPointAtData(0,0,o[0],0,r);if(t>=1)return this._setPointAtData(1,1,o[o.length-1],o.length-1,r);for(var i=o[0],e,a=0,s=t*this.length(),h=1;h<o.length;h++){e=o[h];var u=y.Distance(i,e);if(a+=u,a===s)return this._setPointAtData(t,1,e,h,r);if(a>s){var c=a-s,f=c/u,p=i.subtract(e),v=e.add(p.scaleInPlace(f));return this._setPointAtData(t,1-f,v,h-1,r)}i=e}return this._pointAtData},n.prototype._setPointAtData=function(t,r,o,i,e){return this._pointAtData.point=o,this._pointAtData.position=t,this._pointAtData.subPosition=r,this._pointAtData.previousPointArrayIndex=i,this._pointAtData.interpolateReady=e,e&&this._updateInterpolationMatrix(),this._pointAtData},n.prototype._updateInterpolationMatrix=function(){this._pointAtData.interpolationMatrix=U.Identity();var t=this._pointAtData.previousPointArrayIndex;if(t!==this._tangents.length-1){var r=t+1,o=this._tangents[t].clone(),i=this._normals[t].clone(),e=this._binormals[t].clone(),a=this._tangents[r].clone(),s=this._normals[r].clone(),h=this._binormals[r].clone(),u=W.RotationQuaternionFromAxis(i,e,o),c=W.RotationQuaternionFromAxis(s,h,a),f=W.Slerp(u,c,this._pointAtData.subPosition);f.toRotationMatrix(this._pointAtData.interpolationMatrix)}},n}(),jt=function(){function n(t){this._length=0,this._points=t,this._length=this._computeLength(t)}return n.CreateQuadraticBezier=function(t,r,o,i){i=i>2?i:3;for(var e=new Array,a=function(h,u,c,f){var p=(1-h)*(1-h)*u+2*h*(1-h)*c+h*h*f;return p},s=0;s<=i;s++)e.push(new y(a(s/i,t.x,r.x,o.x),a(s/i,t.y,r.y,o.y),a(s/i,t.z,r.z,o.z)));return new n(e)},n.CreateCubicBezier=function(t,r,o,i,e){e=e>3?e:4;for(var a=new Array,s=function(u,c,f,p,v){var _=(1-u)*(1-u)*(1-u)*c+3*u*(1-u)*(1-u)*f+3*u*u*(1-u)*p+u*u*u*v;return _},h=0;h<=e;h++)a.push(new y(s(h/e,t.x,r.x,o.x,i.x),s(h/e,t.y,r.y,o.y,i.y),s(h/e,t.z,r.z,o.z,i.z)));return new n(a)},n.CreateHermiteSpline=function(t,r,o,i,e){for(var a=new Array,s=1/e,h=0;h<=e;h++)a.push(y.Hermite(t,r,o,i,h*s));return new n(a)},n.CreateCatmullRomSpline=function(t,r,o){var i=new Array,e=1/r,a=0;if(o){for(var s=t.length,h=0;h<s;h++){a=0;for(var u=0;u<r;u++)i.push(y.CatmullRom(t[h%s],t[(h+1)%s],t[(h+2)%s],t[(h+3)%s],a)),a+=e}i.push(i[0])}else{var c=new Array;c.push(t[0].clone()),Array.prototype.push.apply(c,t),c.push(t[t.length-1].clone());for(var h=0;h<c.length-3;h++){a=0;for(var u=0;u<r;u++)i.push(y.CatmullRom(c[h],c[h+1],c[h+2],c[h+3],a)),a+=e}h--,i.push(y.CatmullRom(c[h],c[h+1],c[h+2],c[h+3],a))}return new n(i)},n.ArcThru3Points=function(t,r,o,i,e,a){i===void 0&&(i=32),e===void 0&&(e=!1),a===void 0&&(a=!1);var s=new Array,h=r.subtract(t),u=o.subtract(r),c=t.subtract(o),f=y.Cross(h,u),p=f.length();if(p<Math.pow(10,-8))return new n(s);var v=h.lengthSquared(),_=u.lengthSquared(),d=c.lengthSquared(),x=f.lengthSquared(),T=h.length(),m=u.length(),A=c.length(),g=.5*T*m*A/p,P=y.Dot(h,c),z=y.Dot(h,u),M=y.Dot(u,c),I=-.5*_*P/x,Z=-.5*d*z/x,V=-.5*v*M/x,H=t.scale(I).add(r.scale(Z)).add(o.scale(V)),L=t.subtract(H),b=L.normalize(),F=y.Cross(f,b).normalize();if(a){for(var S=2*Math.PI/i,D=0;D<=2*Math.PI;D+=S)s.push(H.add(b.scale(g*Math.cos(D)).add(F.scale(g*Math.sin(D)))));s.push(t)}else{var S=1/i,D=0,N=y.Zero();do N=H.add(b.scale(g*Math.cos(D)).add(F.scale(g*Math.sin(D)))),s.push(N),D+=S;while(!N.equalsWithEpsilon(o,g*S*1.1));s.push(o),e&&s.push(t)}return new n(s)},n.prototype.getPoints=function(){return this._points},n.prototype.length=function(){return this._length},n.prototype.continue=function(t){for(var r=this._points[this._points.length-1],o=this._points.slice(),i=t.getPoints(),e=1;e<i.length;e++)o.push(i[e].subtract(i[0]).add(r));var a=new n(o);return a},n.prototype._computeLength=function(t){for(var r=0,o=1;o<t.length;o++)r+=t[o].subtract(t[o-1]).length();return r},n}(),mt=function(){function n(){}return n.extractMinAndMaxIndexed=function(t,r,o,i,e,a){for(var s=o;s<o+i;s++){var h=r[s]*3,u=t[h],c=t[h+1],f=t[h+2];e.minimizeInPlaceFromFloats(u,c,f),a.maximizeInPlaceFromFloats(u,c,f)}},n.extractMinAndMax=function(t,r,o,i,e,a){for(var s=r,h=r*i;s<r+o;s++,h+=i){var u=t[h],c=t[h+1],f=t[h+2];e.minimizeInPlaceFromFloats(u,c,f),a.maximizeInPlaceFromFloats(u,c,f)}},yt([pt.filter(function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=t[0],i=t[1];return!Array.isArray(o)&&!Array.isArray(i)})],n,"extractMinAndMaxIndexed",null),yt([pt.filter(function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=t[0];return!Array.isArray(o)})],n,"extractMinAndMax",null),n}();function Yt(n,t,r,o,i){i===void 0&&(i=null);var e=new y(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new y(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return mt.extractMinAndMaxIndexed(n,t,r,o,e,a),i&&(e.x-=e.x*i.x+i.y,e.y-=e.y*i.x+i.y,e.z-=e.z*i.x+i.y,a.x+=a.x*i.x+i.y,a.y+=a.y*i.x+i.y,a.z+=a.z*i.x+i.y),{minimum:e,maximum:a}}function Xt(n,t,r,o,i){o===void 0&&(o=null);var e=new y(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),a=new y(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return i||(i=3),mt.extractMinAndMax(n,t,r,i,e,a),o&&(e.x-=e.x*o.x+o.y,e.y-=e.y*o.x+o.y,e.z-=e.z*o.x+o.y,a.x+=a.x*o.x+o.y,a.y+=a.y*o.x+o.y,a.z+=a.z*o.x+o.y),{minimum:e,maximum:a}}var qt=function(){function n(t,r,o,i){this.x=t,this.y=r,this.width=o,this.height=i}return n.prototype.toGlobal=function(t,r){return new n(this.x*t,this.y*r,this.width*t,this.height*r)},n.prototype.toGlobalToRef=function(t,r,o){return o.x=this.x*t,o.y=this.y*r,o.width=this.width*t,o.height=this.height*r,this},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n}(),Qt=function(){function n(t,r,o){t===void 0&&(t=y.Zero()),r===void 0&&(r=y.Up()),o===void 0&&(o=G.Zero()),this.position=t,this.normal=r,this.uv=o}return n.prototype.clone=function(){return new n(this.position.clone(),this.normal.clone(),this.uv.clone())},n}(),j=[Math.sqrt(1/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(3/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(15/(4*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(5/(16*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(15/(16*Math.PI))],Ct=[function(){return 1},function(n){return n.y},function(n){return n.z},function(n){return n.x},function(n){return n.x*n.y},function(n){return n.y*n.z},function(n){return 3*n.z*n.z-1},function(n){return n.x*n.z},function(n){return n.x*n.x-n.y*n.y}],q=function(n,t){return j[n]*Ct[n](t)},Q=[Math.PI,2*Math.PI/3,2*Math.PI/3,2*Math.PI/3,Math.PI/4,Math.PI/4,Math.PI/4,Math.PI/4,Math.PI/4],Ht=function(){function n(){this.preScaled=!1,this.l00=y.Zero(),this.l1_1=y.Zero(),this.l10=y.Zero(),this.l11=y.Zero(),this.l2_2=y.Zero(),this.l2_1=y.Zero(),this.l20=y.Zero(),this.l21=y.Zero(),this.l22=y.Zero()}return n.prototype.addLight=function(t,r,o){w.Vector3[0].set(r.r,r.g,r.b);var i=w.Vector3[0],e=w.Vector3[1];i.scaleToRef(o,e),e.scaleToRef(q(0,t),w.Vector3[2]),this.l00.addInPlace(w.Vector3[2]),e.scaleToRef(q(1,t),w.Vector3[2]),this.l1_1.addInPlace(w.Vector3[2]),e.scaleToRef(q(2,t),w.Vector3[2]),this.l10.addInPlace(w.Vector3[2]),e.scaleToRef(q(3,t),w.Vector3[2]),this.l11.addInPlace(w.Vector3[2]),e.scaleToRef(q(4,t),w.Vector3[2]),this.l2_2.addInPlace(w.Vector3[2]),e.scaleToRef(q(5,t),w.Vector3[2]),this.l2_1.addInPlace(w.Vector3[2]),e.scaleToRef(q(6,t),w.Vector3[2]),this.l20.addInPlace(w.Vector3[2]),e.scaleToRef(q(7,t),w.Vector3[2]),this.l21.addInPlace(w.Vector3[2]),e.scaleToRef(q(8,t),w.Vector3[2]),this.l22.addInPlace(w.Vector3[2])},n.prototype.scaleInPlace=function(t){this.l00.scaleInPlace(t),this.l1_1.scaleInPlace(t),this.l10.scaleInPlace(t),this.l11.scaleInPlace(t),this.l2_2.scaleInPlace(t),this.l2_1.scaleInPlace(t),this.l20.scaleInPlace(t),this.l21.scaleInPlace(t),this.l22.scaleInPlace(t)},n.prototype.convertIncidentRadianceToIrradiance=function(){this.l00.scaleInPlace(Q[0]),this.l1_1.scaleInPlace(Q[1]),this.l10.scaleInPlace(Q[2]),this.l11.scaleInPlace(Q[3]),this.l2_2.scaleInPlace(Q[4]),this.l2_1.scaleInPlace(Q[5]),this.l20.scaleInPlace(Q[6]),this.l21.scaleInPlace(Q[7]),this.l22.scaleInPlace(Q[8])},n.prototype.convertIrradianceToLambertianRadiance=function(){this.scaleInPlace(1/Math.PI)},n.prototype.preScaleForRendering=function(){this.preScaled=!0,this.l00.scaleInPlace(j[0]),this.l1_1.scaleInPlace(j[1]),this.l10.scaleInPlace(j[2]),this.l11.scaleInPlace(j[3]),this.l2_2.scaleInPlace(j[4]),this.l2_1.scaleInPlace(j[5]),this.l20.scaleInPlace(j[6]),this.l21.scaleInPlace(j[7]),this.l22.scaleInPlace(j[8])},n.prototype.updateFromArray=function(t){return y.FromArrayToRef(t[0],0,this.l00),y.FromArrayToRef(t[1],0,this.l1_1),y.FromArrayToRef(t[2],0,this.l10),y.FromArrayToRef(t[3],0,this.l11),y.FromArrayToRef(t[4],0,this.l2_2),y.FromArrayToRef(t[5],0,this.l2_1),y.FromArrayToRef(t[6],0,this.l20),y.FromArrayToRef(t[7],0,this.l21),y.FromArrayToRef(t[8],0,this.l22),this},n.prototype.updateFromFloatsArray=function(t){return y.FromFloatsToRef(t[0],t[1],t[2],this.l00),y.FromFloatsToRef(t[3],t[4],t[5],this.l1_1),y.FromFloatsToRef(t[6],t[7],t[8],this.l10),y.FromFloatsToRef(t[9],t[10],t[11],this.l11),y.FromFloatsToRef(t[12],t[13],t[14],this.l2_2),y.FromFloatsToRef(t[15],t[16],t[17],this.l2_1),y.FromFloatsToRef(t[18],t[19],t[20],this.l20),y.FromFloatsToRef(t[21],t[22],t[23],this.l21),y.FromFloatsToRef(t[24],t[25],t[26],this.l22),this},n.FromArray=function(t){var r=new n;return r.updateFromArray(t)},n.FromPolynomial=function(t){var r=new n;return r.l00=t.xx.scale(.376127).add(t.yy.scale(.376127)).add(t.zz.scale(.376126)),r.l1_1=t.y.scale(.977204),r.l10=t.z.scale(.977204),r.l11=t.x.scale(.977204),r.l2_2=t.xy.scale(1.16538),r.l2_1=t.yz.scale(1.16538),r.l20=t.zz.scale(1.34567).subtract(t.xx.scale(.672834)).subtract(t.yy.scale(.672834)),r.l21=t.zx.scale(1.16538),r.l22=t.xx.scale(1.16538).subtract(t.yy.scale(1.16538)),r.l1_1.scaleInPlace(-1),r.l11.scaleInPlace(-1),r.l2_1.scaleInPlace(-1),r.l21.scaleInPlace(-1),r.scaleInPlace(Math.PI),r},n}(),Kt=function(){function n(){this.x=y.Zero(),this.y=y.Zero(),this.z=y.Zero(),this.xx=y.Zero(),this.yy=y.Zero(),this.zz=y.Zero(),this.xy=y.Zero(),this.yz=y.Zero(),this.zx=y.Zero()}return Object.defineProperty(n.prototype,"preScaledHarmonics",{get:function(){return this._harmonics||(this._harmonics=Ht.FromPolynomial(this)),this._harmonics.preScaled||this._harmonics.preScaleForRendering(),this._harmonics},enumerable:!1,configurable:!0}),n.prototype.addAmbient=function(t){w.Vector3[0].copyFromFloats(t.r,t.g,t.b);var r=w.Vector3[0];this.xx.addInPlace(r),this.yy.addInPlace(r),this.zz.addInPlace(r)},n.prototype.scaleInPlace=function(t){this.x.scaleInPlace(t),this.y.scaleInPlace(t),this.z.scaleInPlace(t),this.xx.scaleInPlace(t),this.yy.scaleInPlace(t),this.zz.scaleInPlace(t),this.yz.scaleInPlace(t),this.zx.scaleInPlace(t),this.xy.scaleInPlace(t)},n.prototype.updateFromHarmonics=function(t){return this._harmonics=t,this.x.copyFrom(t.l11),this.x.scaleInPlace(1.02333).scaleInPlace(-1),this.y.copyFrom(t.l1_1),this.y.scaleInPlace(1.02333).scaleInPlace(-1),this.z.copyFrom(t.l10),this.z.scaleInPlace(1.02333),this.xx.copyFrom(t.l00),w.Vector3[0].copyFrom(t.l20).scaleInPlace(.247708),w.Vector3[1].copyFrom(t.l22).scaleInPlace(.429043),this.xx.scaleInPlace(.886277).subtractInPlace(w.Vector3[0]).addInPlace(w.Vector3[1]),this.yy.copyFrom(t.l00),this.yy.scaleInPlace(.886277).subtractInPlace(w.Vector3[0]).subtractInPlace(w.Vector3[1]),this.zz.copyFrom(t.l00),w.Vector3[0].copyFrom(t.l20).scaleInPlace(.495417),this.zz.scaleInPlace(.886277).addInPlace(w.Vector3[0]),this.yz.copyFrom(t.l2_1),this.yz.scaleInPlace(.858086).scaleInPlace(-1),this.zx.copyFrom(t.l21),this.zx.scaleInPlace(.858086).scaleInPlace(-1),this.xy.copyFrom(t.l2_2),this.xy.scaleInPlace(.858086),this.scaleInPlace(1/Math.PI),this},n.FromHarmonics=function(t){var r=new n;return r.updateFromHarmonics(t)},n.FromArray=function(t){var r=new n;return y.FromArrayToRef(t[0],0,r.x),y.FromArrayToRef(t[1],0,r.y),y.FromArrayToRef(t[2],0,r.z),y.FromArrayToRef(t[3],0,r.xx),y.FromArrayToRef(t[4],0,r.yy),y.FromArrayToRef(t[5],0,r.zz),y.FromArrayToRef(t[6],0,r.yz),y.FromArrayToRef(t[7],0,r.zx),y.FromArrayToRef(t[8],0,r.xy),r},n}(),Jt=function(){function n(t,r){t===void 0&&(t=0),r===void 0&&(r=0),this.x=t,this.y=r,t!==Math.floor(t)&&tt.Warn("x is not an integer, floor(x) used"),r!==Math.floor(r)&&tt.Warn("y is not an integer, floor(y) used")}return n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.rotate60About=function(t){var r=this.x;return this.x=t.x+t.y-this.y,this.y=r+this.y-t.x,this},n.prototype.rotateNeg60About=function(t){var r=this.x;return this.x=r+this.y-t.y,this.y=t.x+t.y-r,this},n.prototype.rotate120=function(t,r){t!==Math.floor(t)&&tt.Warn("m not an integer only floor(m) used"),r!==Math.floor(r)&&tt.Warn("n not an integer only floor(n) used");var o=this.x;return this.x=t-o-this.y,this.y=r+o,this},n.prototype.rotateNeg120=function(t,r){t!==Math.floor(t)&&tt.Warn("m is not an integer, floor(m) used"),r!==Math.floor(r)&&tt.Warn("n is not an integer,   floor(n) used");var o=this.x;return this.x=this.y-r,this.y=t+r-o-this.y,this},n.prototype.toCartesianOrigin=function(t,r){var o=y.Zero();return o.x=t.x+2*this.x*r+this.y*r,o.y=t.y+Math.sqrt(3)*this.y*r,o},n.Zero=function(){return new n(0,0)},n}();export{Bt as A,kt as B,lt as C,C as E,Et as F,U as M,Dt as P,W as Q,Ut as S,w as T,G as V,Jt as _,y as a,ht as b,st as c,R as d,_t as e,qt as f,vt as g,Nt as h,Kt as i,nt as j,Yt as k,Xt as l,Wt as m,Gt as n,Qt as o,Zt as p,Ht as q,ot as r,jt as s};
