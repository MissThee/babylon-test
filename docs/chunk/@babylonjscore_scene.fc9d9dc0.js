import{_ as H,b as K}from"./tslibtslib.b6e59fa7.js";import{_ as C,P as Y,U as Z,a as I,av as F,T as x,aw as J,ax as $,ay as Q,O as h,j as T,m as k,f as U,I as ee,az as L}from"./@babylonjscore_Misc.d81f49ec.js";import{T as w,F as q,a as N,b as te,C as G,M as re}from"./@babylonjscore_Maths.f3ef132c.js";import{A as ie}from"./@babylonjscore_abstractScene.d5c48c49.js";import{U as se,I as j}from"./@babylonjscore_Materials.00e32dae.js";import{P as V}from"./@babylonjscore_Collisions.6bd46217.js";import{A as W}from"./@babylonjscore_Actions.7cce3f43.js";import{c as z}from"./@babylonjscore_PostProcesses.4413212a.js";import{R as ne}from"./@babylonjscore_Rendering.3a43e73e.js";import{a as v}from"./@babylonjscore_sceneComponent.4b70ec43.js";import{E}from"./@babylonjscore_Engines.7287f97a.js";import{I as A}from"./@babylonjscore_Inputs.ab1ffb62.js";import{a as ae}from"./@babylonjscore_Lights.ab2a2b54.js";var m=function(l){H(i,l);function i(e,t){var r=l.call(this)||this;r._inputManager=new A(r),r.cameraToUseForPointers=null,r._isScene=!0,r._blockEntityCollection=!1,r.autoClear=!0,r.autoClearDepthAndStencil=!0,r.clearColor=new te(.2,.2,.3,1),r.ambientColor=new G(0,0,0),r.environmentIntensity=1,r._forceWireframe=!1,r._skipFrustumClipping=!1,r._forcePointsCloud=!1,r.animationsEnabled=!0,r._animationPropertiesOverride=null,r.useConstantAnimationDeltaTime=!1,r.constantlyUpdateMeshUnderPointer=!1,r.hoverCursor="pointer",r.defaultCursor="",r.doNotHandleCursors=!1,r.preventDefaultOnPointerDown=!0,r.preventDefaultOnPointerUp=!0,r.metadata=null,r.reservedDataStore=null,r.disableOfflineSupportExceptionRules=new Array,r.onDisposeObservable=new h,r._onDisposeObserver=null,r.onBeforeRenderObservable=new h,r._onBeforeRenderObserver=null,r.onAfterRenderObservable=new h,r.onAfterRenderCameraObservable=new h,r._onAfterRenderObserver=null,r.onBeforeAnimationsObservable=new h,r.onAfterAnimationsObservable=new h,r.onBeforeDrawPhaseObservable=new h,r.onAfterDrawPhaseObservable=new h,r.onReadyObservable=new h,r.onBeforeCameraRenderObservable=new h,r._onBeforeCameraRenderObserver=null,r.onAfterCameraRenderObservable=new h,r._onAfterCameraRenderObserver=null,r.onBeforeActiveMeshesEvaluationObservable=new h,r.onAfterActiveMeshesEvaluationObservable=new h,r.onBeforeParticlesRenderingObservable=new h,r.onAfterParticlesRenderingObservable=new h,r.onDataLoadedObservable=new h,r.onNewCameraAddedObservable=new h,r.onCameraRemovedObservable=new h,r.onNewLightAddedObservable=new h,r.onLightRemovedObservable=new h,r.onNewGeometryAddedObservable=new h,r.onGeometryRemovedObservable=new h,r.onNewTransformNodeAddedObservable=new h,r.onTransformNodeRemovedObservable=new h,r.onNewMeshAddedObservable=new h,r.onMeshRemovedObservable=new h,r.onNewSkeletonAddedObservable=new h,r.onSkeletonRemovedObservable=new h,r.onNewMaterialAddedObservable=new h,r.onNewMultiMaterialAddedObservable=new h,r.onMaterialRemovedObservable=new h,r.onMultiMaterialRemovedObservable=new h,r.onNewTextureAddedObservable=new h,r.onTextureRemovedObservable=new h,r.onBeforeRenderTargetsRenderObservable=new h,r.onAfterRenderTargetsRenderObservable=new h,r.onBeforeStepObservable=new h,r.onAfterStepObservable=new h,r.onActiveCameraChanged=new h,r.onBeforeRenderingGroupObservable=new h,r.onAfterRenderingGroupObservable=new h,r.onMeshImportedObservable=new h,r.onAnimationFileImportedObservable=new h,r._registeredForLateAnimationBindings=new T(256),r.skipPointerMovePicking=!1,r.skipPointerDownPicking=!1,r.skipPointerUpPicking=!1,r.onPrePointerObservable=new h,r.onPointerObservable=new h,r.onPreKeyboardObservable=new h,r.onKeyboardObservable=new h,r._useRightHandedSystem=!1,r._timeAccumulator=0,r._currentStepId=0,r._currentInternalStep=0,r._fogEnabled=!0,r._fogMode=i.FOGMODE_NONE,r.fogColor=new G(.2,.2,.3),r.fogDensity=.1,r.fogStart=0,r.fogEnd=1e3,r.needsPreviousWorldMatrices=!1,r._shadowsEnabled=!0,r._lightsEnabled=!0,r.activeCameras=new Array,r._texturesEnabled=!0,r.physicsEnabled=!0,r.particlesEnabled=!0,r.spritesEnabled=!0,r._skeletonsEnabled=!0,r.lensFlaresEnabled=!0,r.collisionsEnabled=!0,r.gravity=new N(0,-9.807,0),r.postProcessesEnabled=!0,r.renderTargetsEnabled=!0,r.dumpNextRenderTargets=!1,r.customRenderTargets=new Array,r.importedMeshesFiles=new Array,r.probesEnabled=!0,r._meshesForIntersections=new T(256),r.proceduralTexturesEnabled=!0,r._totalVertices=new k,r._activeIndices=new k,r._activeParticles=new k,r._activeBones=new k,r._animationTime=0,r.animationTimeScale=1,r._renderId=0,r._frameId=0,r._executeWhenReadyTimeoutId=null,r._intermediateRendering=!1,r._defaultFrameBufferCleared=!1,r._viewUpdateFlag=-1,r._projectionUpdateFlag=-1,r._toBeDisposed=new Array(256),r._activeRequests=new Array,r._pendingData=new Array,r._isDisposed=!1,r.dispatchAllSubMeshesOfActiveMeshes=!1,r._activeMeshes=new U(256),r._processedMaterials=new U(256),r._renderTargets=new T(256),r._materialsRenderTargets=new T(256),r._activeParticleSystems=new U(256),r._activeSkeletons=new T(32),r._softwareSkinnedMeshes=new T(32),r._activeAnimatables=new Array,r._transformMatrix=re.Zero(),r.requireLightSorting=!1,r._components=[],r._serializableComponents=[],r._transientComponents=[],r._beforeCameraUpdateStage=v.Create(),r._beforeClearStage=v.Create(),r._beforeRenderTargetClearStage=v.Create(),r._gatherRenderTargetsStage=v.Create(),r._gatherActiveCameraRenderTargetsStage=v.Create(),r._isReadyForMeshStage=v.Create(),r._beforeEvaluateActiveMeshStage=v.Create(),r._evaluateSubMeshStage=v.Create(),r._preActiveMeshStage=v.Create(),r._cameraDrawRenderTargetStage=v.Create(),r._beforeCameraDrawStage=v.Create(),r._beforeRenderTargetDrawStage=v.Create(),r._beforeRenderingGroupDrawStage=v.Create(),r._beforeRenderingMeshStage=v.Create(),r._afterRenderingMeshStage=v.Create(),r._afterRenderingGroupDrawStage=v.Create(),r._afterCameraDrawStage=v.Create(),r._afterRenderTargetDrawStage=v.Create(),r._afterRenderStage=v.Create(),r._pointerMoveStage=v.Create(),r._pointerDownStage=v.Create(),r._pointerUpStage=v.Create(),r._geometriesByUniqueId=null,r._defaultMeshCandidates={data:[],length:0},r._defaultSubMeshCandidates={data:[],length:0},r._preventFreeActiveMeshesAndRenderingGroups=!1,r._activeMeshesFrozen=!1,r._activeMeshesFrozenButKeepClipping=!1,r._skipEvaluateActiveMeshesCompletely=!1,r._allowPostProcessClearColor=!0,r.getDeterministicFrameTime=function(){return r._engine.getTimeStep()},r._blockMaterialDirtyMechanism=!1,r._perfCollector=null,r.onComputePressureChanged=new h;var s=K({useGeometryUniqueIdsMap:!0,useMaterialMeshMap:!0,useClonedMeshMap:!0,virtual:!1},t);return r._engine=e||E.LastCreatedEngine,s.virtual?r._engine._virtualScenes.push(r):(E._LastCreatedScene=r,r._engine.scenes.push(r)),r._uid=null,r._renderingManager=new ne(r),z&&(r.postProcessManager=new z(r)),ee()&&r.attachControl(),r._createUbo(),j&&(r._imageProcessingConfiguration=new j),r.setDefaultCandidateProviders(),s.useGeometryUniqueIdsMap&&(r._geometriesByUniqueId={}),r.useMaterialMeshMap=s.useMaterialMeshMap,r.useClonedMeshMap=s.useClonedMeshMap,(!t||!t.virtual)&&r._engine.onNewSceneAddedObservable.notifyObservers(r),L.IsAvailable&&(r._computePressureObserver=new L(function(n){r.onComputePressureChanged.notifyObservers(n)},{cpuUtilizationThresholds:[.25,.5,.75,.9],cpuSpeedThresholds:[.5]}),r._computePressureObserver.observe()),r}return i.DefaultMaterialFactory=function(e){throw C("StandardMaterial")},i.CollisionCoordinatorFactory=function(){throw C("DefaultCollisionCoordinator")},Object.defineProperty(i.prototype,"environmentTexture",{get:function(){return this._environmentTexture},set:function(e){this._environmentTexture!==e&&(this._environmentTexture=e,this.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"imageProcessingConfiguration",{get:function(){return this._imageProcessingConfiguration},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"forceWireframe",{get:function(){return this._forceWireframe},set:function(e){this._forceWireframe!==e&&(this._forceWireframe=e,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"skipFrustumClipping",{get:function(){return this._skipFrustumClipping},set:function(e){this._skipFrustumClipping!==e&&(this._skipFrustumClipping=e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"forcePointsCloud",{get:function(){return this._forcePointsCloud},set:function(e){this._forcePointsCloud!==e&&(this._forcePointsCloud=e,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"animationPropertiesOverride",{get:function(){return this._animationPropertiesOverride},set:function(e){this._animationPropertiesOverride=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onDispose",{set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"beforeRender",{set:function(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),e&&(this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"afterRender",{set:function(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),e&&(this._onAfterRenderObserver=this.onAfterRenderObservable.add(e))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"beforeCameraRender",{set:function(e){this._onBeforeCameraRenderObserver&&this.onBeforeCameraRenderObservable.remove(this._onBeforeCameraRenderObserver),this._onBeforeCameraRenderObserver=this.onBeforeCameraRenderObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"afterCameraRender",{set:function(e){this._onAfterCameraRenderObserver&&this.onAfterCameraRenderObservable.remove(this._onAfterCameraRenderObserver),this._onAfterCameraRenderObserver=this.onAfterCameraRenderObservable.add(e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"unTranslatedPointer",{get:function(){return this._inputManager.unTranslatedPointer},enumerable:!1,configurable:!0}),Object.defineProperty(i,"DragMovementThreshold",{get:function(){return A.DragMovementThreshold},set:function(e){A.DragMovementThreshold=e},enumerable:!1,configurable:!0}),Object.defineProperty(i,"LongPressDelay",{get:function(){return A.LongPressDelay},set:function(e){A.LongPressDelay=e},enumerable:!1,configurable:!0}),Object.defineProperty(i,"DoubleClickDelay",{get:function(){return A.DoubleClickDelay},set:function(e){A.DoubleClickDelay=e},enumerable:!1,configurable:!0}),Object.defineProperty(i,"ExclusiveDoubleClickMode",{get:function(){return A.ExclusiveDoubleClickMode},set:function(e){A.ExclusiveDoubleClickMode=e},enumerable:!1,configurable:!0}),i.prototype.bindEyePosition=function(e,t,r){var s;t===void 0&&(t="vEyePosition"),r===void 0&&(r=!1);var n=this._forcedViewPosition?this._forcedViewPosition:this._mirroredCameraPosition?this._mirroredCameraPosition:(s=this.activeCamera.globalPosition)!==null&&s!==void 0?s:this.activeCamera.devicePosition,a=this.useRightHandedSystem===(this._mirroredCameraPosition!=null);return w.Vector4[0].set(n.x,n.y,n.z,a?-1:1),e&&(r?e.setFloat3(t,w.Vector4[0].x,w.Vector4[0].y,w.Vector4[0].z):e.setVector4(t,w.Vector4[0])),w.Vector4[0]},i.prototype.finalizeSceneUbo=function(){var e=this.getSceneUniformBuffer(),t=this.bindEyePosition(null);return e.updateFloat4("vEyePosition",t.x,t.y,t.z,t.w),e.update(),e},Object.defineProperty(i.prototype,"useRightHandedSystem",{get:function(){return this._useRightHandedSystem},set:function(e){this._useRightHandedSystem!==e&&(this._useRightHandedSystem=e,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),i.prototype.setStepId=function(e){this._currentStepId=e},i.prototype.getStepId=function(){return this._currentStepId},i.prototype.getInternalStep=function(){return this._currentInternalStep},Object.defineProperty(i.prototype,"fogEnabled",{get:function(){return this._fogEnabled},set:function(e){this._fogEnabled!==e&&(this._fogEnabled=e,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fogMode",{get:function(){return this._fogMode},set:function(e){this._fogMode!==e&&(this._fogMode=e,this.markAllMaterialsAsDirty(16))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"prePass",{get:function(){return!!this.prePassRenderer&&this.prePassRenderer.defaultRT.enabled},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"shadowsEnabled",{get:function(){return this._shadowsEnabled},set:function(e){this._shadowsEnabled!==e&&(this._shadowsEnabled=e,this.markAllMaterialsAsDirty(2))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lightsEnabled",{get:function(){return this._lightsEnabled},set:function(e){this._lightsEnabled!==e&&(this._lightsEnabled=e,this.markAllMaterialsAsDirty(2))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"activeCamera",{get:function(){return this._activeCamera},set:function(e){e!==this._activeCamera&&(this._activeCamera=e,this.onActiveCameraChanged.notifyObservers(this))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"defaultMaterial",{get:function(){return this._defaultMaterial||(this._defaultMaterial=i.DefaultMaterialFactory(this)),this._defaultMaterial},set:function(e){this._defaultMaterial=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"texturesEnabled",{get:function(){return this._texturesEnabled},set:function(e){this._texturesEnabled!==e&&(this._texturesEnabled=e,this.markAllMaterialsAsDirty(1))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"skeletonsEnabled",{get:function(){return this._skeletonsEnabled},set:function(e){this._skeletonsEnabled!==e&&(this._skeletonsEnabled=e,this.markAllMaterialsAsDirty(8))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"collisionCoordinator",{get:function(){return this._collisionCoordinator||(this._collisionCoordinator=i.CollisionCoordinatorFactory(),this._collisionCoordinator.init(this)),this._collisionCoordinator},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"frustumPlanes",{get:function(){return this._frustumPlanes},enumerable:!1,configurable:!0}),i.prototype._registerTransientComponents=function(){if(this._transientComponents.length>0){for(var e=0,t=this._transientComponents;e<t.length;e++){var r=t[e];r.register()}this._transientComponents.length=0}},i.prototype._addComponent=function(e){this._components.push(e),this._transientComponents.push(e);var t=e;t.addFromContainer&&t.serialize&&this._serializableComponents.push(t)},i.prototype._getComponent=function(e){for(var t=0,r=this._components;t<r.length;t++){var s=r[t];if(s.name===e)return s}return null},i.prototype.getClassName=function(){return"Scene"},i.prototype._getDefaultMeshCandidates=function(){return this._defaultMeshCandidates.data=this.meshes,this._defaultMeshCandidates.length=this.meshes.length,this._defaultMeshCandidates},i.prototype._getDefaultSubMeshCandidates=function(e){return this._defaultSubMeshCandidates.data=e.subMeshes,this._defaultSubMeshCandidates.length=e.subMeshes.length,this._defaultSubMeshCandidates},i.prototype.setDefaultCandidateProviders=function(){this.getActiveMeshCandidates=this._getDefaultMeshCandidates.bind(this),this.getActiveSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this),this.getIntersectingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this),this.getCollidingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this)},Object.defineProperty(i.prototype,"meshUnderPointer",{get:function(){return this._inputManager.meshUnderPointer},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"pointerX",{get:function(){return this._inputManager.pointerX},set:function(e){this._inputManager.pointerX=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"pointerY",{get:function(){return this._inputManager.pointerY},set:function(e){this._inputManager.pointerY=e},enumerable:!1,configurable:!0}),i.prototype.getCachedMaterial=function(){return this._cachedMaterial},i.prototype.getCachedEffect=function(){return this._cachedEffect},i.prototype.getCachedVisibility=function(){return this._cachedVisibility},i.prototype.isCachedMaterialInvalid=function(e,t,r){return r===void 0&&(r=1),this._cachedEffect!==t||this._cachedMaterial!==e||this._cachedVisibility!==r},i.prototype.getEngine=function(){return this._engine},i.prototype.getTotalVertices=function(){return this._totalVertices.current},Object.defineProperty(i.prototype,"totalVerticesPerfCounter",{get:function(){return this._totalVertices},enumerable:!1,configurable:!0}),i.prototype.getActiveIndices=function(){return this._activeIndices.current},Object.defineProperty(i.prototype,"totalActiveIndicesPerfCounter",{get:function(){return this._activeIndices},enumerable:!1,configurable:!0}),i.prototype.getActiveParticles=function(){return this._activeParticles.current},Object.defineProperty(i.prototype,"activeParticlesPerfCounter",{get:function(){return this._activeParticles},enumerable:!1,configurable:!0}),i.prototype.getActiveBones=function(){return this._activeBones.current},Object.defineProperty(i.prototype,"activeBonesPerfCounter",{get:function(){return this._activeBones},enumerable:!1,configurable:!0}),i.prototype.getActiveMeshes=function(){return this._activeMeshes},i.prototype.getAnimationRatio=function(){return this._animationRatio!==void 0?this._animationRatio:1},i.prototype.getRenderId=function(){return this._renderId},i.prototype.getFrameId=function(){return this._frameId},i.prototype.incrementRenderId=function(){this._renderId++},i.prototype._createUbo=function(){this.setSceneUniformBuffer(this.createSceneUniformBuffer())},i.prototype.simulatePointerMove=function(e,t){return this._inputManager.simulatePointerMove(e,t),this},i.prototype.simulatePointerDown=function(e,t){return this._inputManager.simulatePointerDown(e,t),this},i.prototype.simulatePointerUp=function(e,t,r){return this._inputManager.simulatePointerUp(e,t,r),this},i.prototype.isPointerCaptured=function(e){return e===void 0&&(e=0),this._inputManager.isPointerCaptured(e)},i.prototype.attachControl=function(e,t,r){e===void 0&&(e=!0),t===void 0&&(t=!0),r===void 0&&(r=!0),this._inputManager.attachControl(e,t,r)},i.prototype.detachControl=function(){this._inputManager.detachControl()},i.prototype.isReady=function(e){if(e===void 0&&(e=!0),this._isDisposed)return!1;var t,r=this.getEngine(),s=!0;for(this._pendingData.length>0&&(s=!1),e&&(this._processedMaterials.reset(),this._materialsRenderTargets.reset()),t=0;t<this.meshes.length;t++){var n=this.meshes[t];if(!(!n.subMeshes||n.subMeshes.length===0)){if(!n.isReady(!0)){s=!1;continue}for(var a=n.hasThinInstances||n.getClassName()==="InstancedMesh"||n.getClassName()==="InstancedLinesMesh"||r.getCaps().instancedArrays&&n.instances.length>0,o=0,u=this._isReadyForMeshStage;o<u.length;o++){var f=u[o];f.action(n,a)||(s=!1)}if(!!e){var d=n.material||this.defaultMaterial;if(d)if(d._storeEffectOnSubMeshes)for(var c=0,_=n.subMeshes;c<_.length;c++){var p=_[c],g=p.getMaterial();g&&g.hasRenderTargetTextures&&g.getRenderTargetTextures!=null&&this._processedMaterials.indexOf(g)===-1&&(this._processedMaterials.push(g),this._materialsRenderTargets.concatWithNoDuplicate(g.getRenderTargetTextures()))}else d.hasRenderTargetTextures&&d.getRenderTargetTextures!=null&&this._processedMaterials.indexOf(d)===-1&&(this._processedMaterials.push(d),this._materialsRenderTargets.concatWithNoDuplicate(d.getRenderTargetTextures()))}}}if(!s||!r.areAllEffectsReady())return!1;if(e)for(t=0;t<this._materialsRenderTargets.length;++t){var b=this._materialsRenderTargets.data[t];if(!b.isReadyForRendering())return!1}for(t=0;t<this.geometries.length;t++){var y=this.geometries[t];if(y.delayLoadState===2)return!1}if(this.activeCameras&&this.activeCameras.length>0)for(var S=0,M=this.activeCameras;S<M.length;S++){var B=M[S];if(!B.isReady(!0))return!1}else if(this.activeCamera&&!this.activeCamera.isReady(!0))return!1;for(var O=0,R=this.particleSystems;O<R.length;O++){var P=R[O];if(!P.isReady())return!1}return!0},i.prototype.resetCachedMaterial=function(){this._cachedMaterial=null,this._cachedEffect=null,this._cachedVisibility=null},i.prototype.registerBeforeRender=function(e){this.onBeforeRenderObservable.add(e)},i.prototype.unregisterBeforeRender=function(e){this.onBeforeRenderObservable.removeCallback(e)},i.prototype.registerAfterRender=function(e){this.onAfterRenderObservable.add(e)},i.prototype.unregisterAfterRender=function(e){this.onAfterRenderObservable.removeCallback(e)},i.prototype._executeOnceBeforeRender=function(e){var t=this,r=function(){e(),setTimeout(function(){t.unregisterBeforeRender(r)})};this.registerBeforeRender(r)},i.prototype.executeOnceBeforeRender=function(e,t){var r=this;t!==void 0?setTimeout(function(){r._executeOnceBeforeRender(e)},t):this._executeOnceBeforeRender(e)},i.prototype.addPendingData=function(e){this._pendingData.push(e)},i.prototype.removePendingData=function(e){var t=this.isLoading,r=this._pendingData.indexOf(e);r!==-1&&this._pendingData.splice(r,1),t&&!this.isLoading&&this.onDataLoadedObservable.notifyObservers(this)},i.prototype.getWaitingItemsCount=function(){return this._pendingData.length},Object.defineProperty(i.prototype,"isLoading",{get:function(){return this._pendingData.length>0},enumerable:!1,configurable:!0}),i.prototype.executeWhenReady=function(e,t){t===void 0&&(t=!1),this.onReadyObservable.add(e),this._executeWhenReadyTimeoutId===null&&this._checkIsReady(t)},i.prototype.whenReadyAsync=function(e){var t=this;return e===void 0&&(e=!1),new Promise(function(r){t.executeWhenReady(function(){r()},e)})},i.prototype._checkIsReady=function(e){var t=this;if(e===void 0&&(e=!1),this._registerTransientComponents(),this.isReady(e)){this.onReadyObservable.notifyObservers(this),this.onReadyObservable.clear(),this._executeWhenReadyTimeoutId=null;return}if(this._isDisposed){this.onReadyObservable.clear(),this._executeWhenReadyTimeoutId=null;return}this._executeWhenReadyTimeoutId=setTimeout(function(){t._checkIsReady(e)},100)},Object.defineProperty(i.prototype,"animatables",{get:function(){return this._activeAnimatables},enumerable:!1,configurable:!0}),i.prototype.resetLastAnimationTimeFrame=function(){this._animationTimeLast=Y.Now},i.prototype.getViewMatrix=function(){return this._viewMatrix},i.prototype.getProjectionMatrix=function(){return this._projectionMatrix},i.prototype.getTransformMatrix=function(){return this._transformMatrix},i.prototype.setTransformMatrix=function(e,t,r,s){!r&&!s&&this._multiviewSceneUbo&&(this._multiviewSceneUbo.dispose(),this._multiviewSceneUbo=null),!(this._viewUpdateFlag===e.updateFlag&&this._projectionUpdateFlag===t.updateFlag)&&(this._viewUpdateFlag=e.updateFlag,this._projectionUpdateFlag=t.updateFlag,this._viewMatrix=e,this._projectionMatrix=t,this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._frustumPlanes?q.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=q.GetPlanes(this._transformMatrix),this._multiviewSceneUbo&&this._multiviewSceneUbo.useUbo?this._updateMultiviewUbo(r,s):this._sceneUbo.useUbo&&(this._sceneUbo.updateMatrix("viewProjection",this._transformMatrix),this._sceneUbo.updateMatrix("view",this._viewMatrix),this._sceneUbo.updateMatrix("projection",this._projectionMatrix)))},i.prototype.getSceneUniformBuffer=function(){return this._multiviewSceneUbo?this._multiviewSceneUbo:this._sceneUbo},i.prototype.createSceneUniformBuffer=function(e){var t=new se(this._engine,void 0,!1,e!=null?e:"scene");return t.addUniform("viewProjection",16),t.addUniform("view",16),t.addUniform("projection",16),t.addUniform("vEyePosition",4),t},i.prototype.setSceneUniformBuffer=function(e){this._sceneUbo=e,this._viewUpdateFlag=-1,this._projectionUpdateFlag=-1},i.prototype.getUniqueId=function(){return Z.UniqueId},i.prototype.addMesh=function(e,t){var r=this;t===void 0&&(t=!1),!this._blockEntityCollection&&(this.meshes.push(e),e._resyncLightSources(),e.parent||e._addToSceneRootNodes(),this.onNewMeshAddedObservable.notifyObservers(e),t&&e.getChildMeshes().forEach(function(s){r.addMesh(s)}))},i.prototype.removeMesh=function(e,t){var r=this;t===void 0&&(t=!1);var s=this.meshes.indexOf(e);return s!==-1&&(this.meshes[s]=this.meshes[this.meshes.length-1],this.meshes.pop(),e.parent||e._removeFromSceneRootNodes()),this._inputManager._invalidateMesh(e),this.onMeshRemovedObservable.notifyObservers(e),t&&e.getChildMeshes().forEach(function(n){r.removeMesh(n)}),s},i.prototype.addTransformNode=function(e){this._blockEntityCollection||e.getScene()===this&&e._indexInSceneTransformNodesArray!==-1||(e._indexInSceneTransformNodesArray=this.transformNodes.length,this.transformNodes.push(e),e.parent||e._addToSceneRootNodes(),this.onNewTransformNodeAddedObservable.notifyObservers(e))},i.prototype.removeTransformNode=function(e){var t=e._indexInSceneTransformNodesArray;if(t!==-1){if(t!==this.transformNodes.length-1){var r=this.transformNodes[this.transformNodes.length-1];this.transformNodes[t]=r,r._indexInSceneTransformNodesArray=t}e._indexInSceneTransformNodesArray=-1,this.transformNodes.pop(),e.parent||e._removeFromSceneRootNodes()}return this.onTransformNodeRemovedObservable.notifyObservers(e),t},i.prototype.removeSkeleton=function(e){var t=this.skeletons.indexOf(e);return t!==-1&&(this.skeletons.splice(t,1),this.onSkeletonRemovedObservable.notifyObservers(e),this._executeActiveContainerCleanup(this._activeSkeletons)),t},i.prototype.removeMorphTargetManager=function(e){var t=this.morphTargetManagers.indexOf(e);return t!==-1&&this.morphTargetManagers.splice(t,1),t},i.prototype.removeLight=function(e){var t=this.lights.indexOf(e);if(t!==-1){for(var r=0,s=this.meshes;r<s.length;r++){var n=s[r];n._removeLightSource(e,!1)}this.lights.splice(t,1),this.sortLightsByPriority(),e.parent||e._removeFromSceneRootNodes()}return this.onLightRemovedObservable.notifyObservers(e),t},i.prototype.removeCamera=function(e){var t=this.cameras.indexOf(e);if(t!==-1&&(this.cameras.splice(t,1),e.parent||e._removeFromSceneRootNodes()),this.activeCameras){var r=this.activeCameras.indexOf(e);r!==-1&&this.activeCameras.splice(r,1)}return this.activeCamera===e&&(this.cameras.length>0?this.activeCamera=this.cameras[0]:this.activeCamera=null),this.onCameraRemovedObservable.notifyObservers(e),t},i.prototype.removeParticleSystem=function(e){var t=this.particleSystems.indexOf(e);return t!==-1&&(this.particleSystems.splice(t,1),this._executeActiveContainerCleanup(this._activeParticleSystems)),t},i.prototype.removeAnimation=function(e){var t=this.animations.indexOf(e);return t!==-1&&this.animations.splice(t,1),t},i.prototype.stopAnimation=function(e,t,r){},i.prototype.removeAnimationGroup=function(e){var t=this.animationGroups.indexOf(e);return t!==-1&&this.animationGroups.splice(t,1),t},i.prototype.removeMultiMaterial=function(e){var t=this.multiMaterials.indexOf(e);return t!==-1&&this.multiMaterials.splice(t,1),this.onMultiMaterialRemovedObservable.notifyObservers(e),t},i.prototype.removeMaterial=function(e){var t=e._indexInSceneMaterialArray;if(t!==-1&&t<this.materials.length){if(t!==this.materials.length-1){var r=this.materials[this.materials.length-1];this.materials[t]=r,r._indexInSceneMaterialArray=t}e._indexInSceneMaterialArray=-1,this.materials.pop()}return this.onMaterialRemovedObservable.notifyObservers(e),t},i.prototype.removeActionManager=function(e){var t=this.actionManagers.indexOf(e);return t!==-1&&this.actionManagers.splice(t,1),t},i.prototype.removeTexture=function(e){var t=this.textures.indexOf(e);return t!==-1&&this.textures.splice(t,1),this.onTextureRemovedObservable.notifyObservers(e),t},i.prototype.addLight=function(e){if(!this._blockEntityCollection){this.lights.push(e),this.sortLightsByPriority(),e.parent||e._addToSceneRootNodes();for(var t=0,r=this.meshes;t<r.length;t++){var s=r[t];s.lightSources.indexOf(e)===-1&&(s.lightSources.push(e),s._resyncLightSources())}this.onNewLightAddedObservable.notifyObservers(e)}},i.prototype.sortLightsByPriority=function(){this.requireLightSorting&&this.lights.sort(ae.CompareLightsPriority)},i.prototype.addCamera=function(e){this._blockEntityCollection||(this.cameras.push(e),this.onNewCameraAddedObservable.notifyObservers(e),e.parent||e._addToSceneRootNodes())},i.prototype.addSkeleton=function(e){this._blockEntityCollection||(this.skeletons.push(e),this.onNewSkeletonAddedObservable.notifyObservers(e))},i.prototype.addParticleSystem=function(e){this._blockEntityCollection||this.particleSystems.push(e)},i.prototype.addAnimation=function(e){this._blockEntityCollection||this.animations.push(e)},i.prototype.addAnimationGroup=function(e){this._blockEntityCollection||this.animationGroups.push(e)},i.prototype.addMultiMaterial=function(e){this._blockEntityCollection||(this.multiMaterials.push(e),this.onNewMultiMaterialAddedObservable.notifyObservers(e))},i.prototype.addMaterial=function(e){this._blockEntityCollection||e.getScene()===this&&e._indexInSceneMaterialArray!==-1||(e._indexInSceneMaterialArray=this.materials.length,this.materials.push(e),this.onNewMaterialAddedObservable.notifyObservers(e))},i.prototype.addMorphTargetManager=function(e){this._blockEntityCollection||this.morphTargetManagers.push(e)},i.prototype.addGeometry=function(e){this._blockEntityCollection||(this._geometriesByUniqueId&&(this._geometriesByUniqueId[e.uniqueId]=this.geometries.length),this.geometries.push(e))},i.prototype.addActionManager=function(e){this.actionManagers.push(e)},i.prototype.addTexture=function(e){this._blockEntityCollection||(this.textures.push(e),this.onNewTextureAddedObservable.notifyObservers(e))},i.prototype.switchActiveCamera=function(e,t){t===void 0&&(t=!0);var r=this._engine.getInputElement();!r||(this.activeCamera&&this.activeCamera.detachControl(),this.activeCamera=e,t&&e.attachControl())},i.prototype.setActiveCameraById=function(e){var t=this.getCameraById(e);return t?(this.activeCamera=t,t):null},i.prototype.setActiveCameraByName=function(e){var t=this.getCameraByName(e);return t?(this.activeCamera=t,t):null},i.prototype.getAnimationGroupByName=function(e){for(var t=0;t<this.animationGroups.length;t++)if(this.animationGroups[t].name===e)return this.animationGroups[t];return null},i.prototype.getMaterialByUniqueID=function(e){for(var t=0;t<this.materials.length;t++)if(this.materials[t].uniqueId===e)return this.materials[t];return null},i.prototype.getMaterialById=function(e){for(var t=0;t<this.materials.length;t++)if(this.materials[t].id===e)return this.materials[t];return null},i.prototype.getLastMaterialById=function(e,t){t===void 0&&(t=!1);for(var r=this.materials.length-1;r>=0;r--)if(this.materials[r].id===e)return this.materials[r];if(t){for(var r=this.multiMaterials.length-1;r>=0;r--)if(this.multiMaterials[r].id===e)return this.multiMaterials[r]}return null},i.prototype.getMaterialByName=function(e){for(var t=0;t<this.materials.length;t++)if(this.materials[t].name===e)return this.materials[t];return null},i.prototype.getTextureByUniqueId=function(e){for(var t=0;t<this.textures.length;t++)if(this.textures[t].uniqueId===e)return this.textures[t];return null},i.prototype.getTextureByName=function(e){for(var t=0;t<this.textures.length;t++)if(this.textures[t].name===e)return this.textures[t];return null},i.prototype.getCameraById=function(e){for(var t=0;t<this.cameras.length;t++)if(this.cameras[t].id===e)return this.cameras[t];return null},i.prototype.getCameraByUniqueId=function(e){for(var t=0;t<this.cameras.length;t++)if(this.cameras[t].uniqueId===e)return this.cameras[t];return null},i.prototype.getCameraByName=function(e){for(var t=0;t<this.cameras.length;t++)if(this.cameras[t].name===e)return this.cameras[t];return null},i.prototype.getBoneById=function(e){for(var t=0;t<this.skeletons.length;t++)for(var r=this.skeletons[t],s=0;s<r.bones.length;s++)if(r.bones[s].id===e)return r.bones[s];return null},i.prototype.getBoneByName=function(e){for(var t=0;t<this.skeletons.length;t++)for(var r=this.skeletons[t],s=0;s<r.bones.length;s++)if(r.bones[s].name===e)return r.bones[s];return null},i.prototype.getLightByName=function(e){for(var t=0;t<this.lights.length;t++)if(this.lights[t].name===e)return this.lights[t];return null},i.prototype.getLightById=function(e){for(var t=0;t<this.lights.length;t++)if(this.lights[t].id===e)return this.lights[t];return null},i.prototype.getLightByUniqueId=function(e){for(var t=0;t<this.lights.length;t++)if(this.lights[t].uniqueId===e)return this.lights[t];return null},i.prototype.getParticleSystemById=function(e){for(var t=0;t<this.particleSystems.length;t++)if(this.particleSystems[t].id===e)return this.particleSystems[t];return null},i.prototype.getGeometryById=function(e){for(var t=0;t<this.geometries.length;t++)if(this.geometries[t].id===e)return this.geometries[t];return null},i.prototype._getGeometryByUniqueId=function(e){if(this._geometriesByUniqueId){var t=this._geometriesByUniqueId[e];if(t!==void 0)return this.geometries[t]}else for(var t=0;t<this.geometries.length;t++)if(this.geometries[t].uniqueId===e)return this.geometries[t];return null},i.prototype.pushGeometry=function(e,t){return!t&&this._getGeometryByUniqueId(e.uniqueId)?!1:(this.addGeometry(e),this.onNewGeometryAddedObservable.notifyObservers(e),!0)},i.prototype.removeGeometry=function(e){var t;if(this._geometriesByUniqueId){if(t=this._geometriesByUniqueId[e.uniqueId],t===void 0)return!1}else if(t=this.geometries.indexOf(e),t<0)return!1;if(t!==this.geometries.length-1){var r=this.geometries[this.geometries.length-1];r&&(this.geometries[t]=r,this._geometriesByUniqueId&&(this._geometriesByUniqueId[r.uniqueId]=t,this._geometriesByUniqueId[e.uniqueId]=void 0))}return this.geometries.pop(),this.onGeometryRemovedObservable.notifyObservers(e),!0},i.prototype.getGeometries=function(){return this.geometries},i.prototype.getMeshById=function(e){for(var t=0;t<this.meshes.length;t++)if(this.meshes[t].id===e)return this.meshes[t];return null},i.prototype.getMeshesById=function(e){return this.meshes.filter(function(t){return t.id===e})},i.prototype.getTransformNodeById=function(e){for(var t=0;t<this.transformNodes.length;t++)if(this.transformNodes[t].id===e)return this.transformNodes[t];return null},i.prototype.getTransformNodeByUniqueId=function(e){for(var t=0;t<this.transformNodes.length;t++)if(this.transformNodes[t].uniqueId===e)return this.transformNodes[t];return null},i.prototype.getTransformNodesById=function(e){return this.transformNodes.filter(function(t){return t.id===e})},i.prototype.getMeshByUniqueId=function(e){for(var t=0;t<this.meshes.length;t++)if(this.meshes[t].uniqueId===e)return this.meshes[t];return null},i.prototype.getLastMeshById=function(e){for(var t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===e)return this.meshes[t];return null},i.prototype.getLastEntryById=function(e){var t;for(t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===e)return this.meshes[t];for(t=this.transformNodes.length-1;t>=0;t--)if(this.transformNodes[t].id===e)return this.transformNodes[t];for(t=this.cameras.length-1;t>=0;t--)if(this.cameras[t].id===e)return this.cameras[t];for(t=this.lights.length-1;t>=0;t--)if(this.lights[t].id===e)return this.lights[t];return null},i.prototype.getNodeById=function(e){var t=this.getMeshById(e);if(t)return t;var r=this.getTransformNodeById(e);if(r)return r;var s=this.getLightById(e);if(s)return s;var n=this.getCameraById(e);if(n)return n;var a=this.getBoneById(e);return a||null},i.prototype.getNodeByName=function(e){var t=this.getMeshByName(e);if(t)return t;var r=this.getTransformNodeByName(e);if(r)return r;var s=this.getLightByName(e);if(s)return s;var n=this.getCameraByName(e);if(n)return n;var a=this.getBoneByName(e);return a||null},i.prototype.getMeshByName=function(e){for(var t=0;t<this.meshes.length;t++)if(this.meshes[t].name===e)return this.meshes[t];return null},i.prototype.getTransformNodeByName=function(e){for(var t=0;t<this.transformNodes.length;t++)if(this.transformNodes[t].name===e)return this.transformNodes[t];return null},i.prototype.getLastSkeletonById=function(e){for(var t=this.skeletons.length-1;t>=0;t--)if(this.skeletons[t].id===e)return this.skeletons[t];return null},i.prototype.getSkeletonByUniqueId=function(e){for(var t=0;t<this.skeletons.length;t++)if(this.skeletons[t].uniqueId===e)return this.skeletons[t];return null},i.prototype.getSkeletonById=function(e){for(var t=0;t<this.skeletons.length;t++)if(this.skeletons[t].id===e)return this.skeletons[t];return null},i.prototype.getSkeletonByName=function(e){for(var t=0;t<this.skeletons.length;t++)if(this.skeletons[t].name===e)return this.skeletons[t];return null},i.prototype.getMorphTargetManagerById=function(e){for(var t=0;t<this.morphTargetManagers.length;t++)if(this.morphTargetManagers[t].uniqueId===e)return this.morphTargetManagers[t];return null},i.prototype.getMorphTargetById=function(e){for(var t=0;t<this.morphTargetManagers.length;++t)for(var r=this.morphTargetManagers[t],s=0;s<r.numTargets;++s){var n=r.getTarget(s);if(n.id===e)return n}return null},i.prototype.getMorphTargetByName=function(e){for(var t=0;t<this.morphTargetManagers.length;++t)for(var r=this.morphTargetManagers[t],s=0;s<r.numTargets;++s){var n=r.getTarget(s);if(n.name===e)return n}return null},i.prototype.getPostProcessByName=function(e){for(var t=0;t<this.postProcesses.length;++t){var r=this.postProcesses[t];if(r.name===e)return r}return null},i.prototype.isActiveMesh=function(e){return this._activeMeshes.indexOf(e)!==-1},Object.defineProperty(i.prototype,"uid",{get:function(){return this._uid||(this._uid=I.RandomId()),this._uid},enumerable:!1,configurable:!0}),i.prototype.addExternalData=function(e,t){return this._externalData||(this._externalData=new F),this._externalData.add(e,t)},i.prototype.getExternalData=function(e){return this._externalData?this._externalData.get(e):null},i.prototype.getOrAddExternalDataWithFactory=function(e,t){return this._externalData||(this._externalData=new F),this._externalData.getOrAddWithFactory(e,t)},i.prototype.removeExternalData=function(e){return this._externalData.remove(e)},i.prototype._evaluateSubMesh=function(e,t,r){if(r.hasInstances||r.isAnInstance||this.dispatchAllSubMeshesOfActiveMeshes||this._skipFrustumClipping||t.alwaysSelectAsActiveMesh||t.subMeshes.length===1||e.isInFrustum(this._frustumPlanes)){for(var s=0,n=this._evaluateSubMeshStage;s<n.length;s++){var a=n[s];a.action(t,e)}var o=e.getMaterial();o!=null&&(o.hasRenderTargetTextures&&o.getRenderTargetTextures!=null&&this._processedMaterials.indexOf(o)===-1&&(this._processedMaterials.push(o),this._materialsRenderTargets.concatWithNoDuplicate(o.getRenderTargetTextures())),this._renderingManager.dispatch(e,t,o))}},i.prototype.freeProcessedMaterials=function(){this._processedMaterials.dispose()},Object.defineProperty(i.prototype,"blockfreeActiveMeshesAndRenderingGroups",{get:function(){return this._preventFreeActiveMeshesAndRenderingGroups},set:function(e){this._preventFreeActiveMeshesAndRenderingGroups!==e&&(e&&(this.freeActiveMeshes(),this.freeRenderingGroups()),this._preventFreeActiveMeshesAndRenderingGroups=e)},enumerable:!1,configurable:!0}),i.prototype.freeActiveMeshes=function(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._activeMeshes.dispose(),this.activeCamera&&this.activeCamera._activeMeshes&&this.activeCamera._activeMeshes.dispose(),this.activeCameras))for(var e=0;e<this.activeCameras.length;e++){var t=this.activeCameras[e];t&&t._activeMeshes&&t._activeMeshes.dispose()}},i.prototype.freeRenderingGroups=function(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._renderingManager&&this._renderingManager.freeRenderingGroups(),this.textures))for(var e=0;e<this.textures.length;e++){var t=this.textures[e];t&&t.renderList&&t.freeRenderingGroups()}},i.prototype._isInIntermediateRendering=function(){return this._intermediateRendering},i.prototype.freezeActiveMeshes=function(e,t,r,s,n){var a=this;return e===void 0&&(e=!1),s===void 0&&(s=!0),n===void 0&&(n=!1),this.executeWhenReady(function(){if(!a.activeCamera){r&&r("No active camera found");return}if(a._frustumPlanes||a.updateTransformMatrix(),a._evaluateActiveMeshes(),a._activeMeshesFrozen=!0,a._activeMeshesFrozenButKeepClipping=n,a._skipEvaluateActiveMeshesCompletely=e,s)for(var o=0;o<a._activeMeshes.length;o++)a._activeMeshes.data[o]._freeze();t&&t()}),this},i.prototype.unfreezeActiveMeshes=function(){for(var e=0;e<this.meshes.length;e++){var t=this.meshes[e];t._internalAbstractMeshDataInfo&&(t._internalAbstractMeshDataInfo._isActive=!1)}for(var e=0;e<this._activeMeshes.length;e++)this._activeMeshes.data[e]._unFreeze();return this._activeMeshesFrozen=!1,this},i.prototype._executeActiveContainerCleanup=function(e){var t=this._engine.snapshotRendering&&this._engine.snapshotRenderingMode===1;!t&&this._activeMeshesFrozen&&this._activeMeshes.length||this.onBeforeRenderObservable.addOnce(function(){return e.dispose()})},i.prototype._evaluateActiveMeshes=function(){var e;if(this._engine.snapshotRendering&&this._engine.snapshotRenderingMode===1){this._activeMeshes.length>0&&((e=this.activeCamera)===null||e===void 0||e._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset());return}if(this._activeMeshesFrozen&&this._activeMeshes.length){if(!this._skipEvaluateActiveMeshesCompletely)for(var t=this._activeMeshes.length,r=0;r<t;r++){var s=this._activeMeshes.data[r];s.computeWorldMatrix()}if(this._activeParticleSystems)for(var n=this._activeParticleSystems.length,r=0;r<n;r++)this._activeParticleSystems.data[r].animate();return}if(!!this.activeCamera){this.onBeforeActiveMeshesEvaluationObservable.notifyObservers(this),this.activeCamera._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset(),this._materialsRenderTargets.reset();for(var a=0,o=this._beforeEvaluateActiveMeshStage;a<o.length;a++){var u=o[a];u.action()}for(var f=this.getActiveMeshCandidates(),d=f.length,r=0;r<d;r++){var s=f.data[r];if(s._internalAbstractMeshDataInfo._currentLODIsUpToDate=!1,!s.isBlocked&&(this._totalVertices.addCount(s.getTotalVertices(),!1),!(!s.isReady()||!s.isEnabled()||s.scaling.hasAZeroComponent))){s.computeWorldMatrix(),s.actionManager&&s.actionManager.hasSpecificTriggers2(12,13)&&this._meshesForIntersections.pushNoDuplicate(s);var c=this.customLODSelector?this.customLODSelector(s,this.activeCamera):s.getLOD(this.activeCamera);if(s._internalAbstractMeshDataInfo._currentLOD=c,s._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0,c!=null&&(c!==s&&c.billboardMode!==0&&c.computeWorldMatrix(),s._preActivate(),s.isVisible&&s.visibility>0&&(s.layerMask&this.activeCamera.layerMask)!==0&&(this._skipFrustumClipping||s.alwaysSelectAsActiveMesh||s.isInFrustum(this._frustumPlanes)))){this._activeMeshes.push(s),this.activeCamera._activeMeshes.push(s),c!==s&&c._activate(this._renderId,!1);for(var _=0,p=this._preActiveMeshStage;_<p.length;_++){var u=p[_];u.action(s)}s._activate(this._renderId,!1)&&(s.isAnInstance?s._internalAbstractMeshDataInfo._actAsRegularMesh&&(c=s):c._internalAbstractMeshDataInfo._onlyForInstances=!1,c._internalAbstractMeshDataInfo._isActive=!0,this._activeMesh(s,c)),s._postActivate()}}}if(this.onAfterActiveMeshesEvaluationObservable.notifyObservers(this),this.particlesEnabled){this.onBeforeParticlesRenderingObservable.notifyObservers(this);for(var g=0;g<this.particleSystems.length;g++){var b=this.particleSystems[g];if(!(!b.isStarted()||!b.emitter)){var y=b.emitter;(!y.position||y.isEnabled())&&(this._activeParticleSystems.push(b),b.animate(),this._renderingManager.dispatchParticles(b))}}this.onAfterParticlesRenderingObservable.notifyObservers(this)}}},i.prototype._activeMesh=function(e,t){if(this._skeletonsEnabled&&t.skeleton!==null&&t.skeleton!==void 0&&(this._activeSkeletons.pushNoDuplicate(t.skeleton)&&(t.skeleton.prepare(),this._activeBones.addCount(t.skeleton.bones.length,!1)),t.computeBonesUsingShaders||this._softwareSkinnedMeshes.pushNoDuplicate(t)),t&&t.subMeshes&&t.subMeshes.length>0)for(var r=this.getActiveSubMeshCandidates(t),s=r.length,n=0;n<s;n++){var a=r.data[n];this._evaluateSubMesh(a,t,e)}},i.prototype.updateTransformMatrix=function(e){if(!!this.activeCamera)if(this.activeCamera._renderingMultiview){var t=this.activeCamera._rigCameras[0],r=this.activeCamera._rigCameras[1];this.setTransformMatrix(t.getViewMatrix(),t.getProjectionMatrix(e),r.getViewMatrix(),r.getProjectionMatrix(e))}else this.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(e))},i.prototype._bindFrameBuffer=function(e,t){t===void 0&&(t=!0),e&&e._multiviewTexture?e._multiviewTexture._bindFrameBuffer():e&&e.outputRenderTarget?e.outputRenderTarget._bindFrameBuffer():this._engine._currentFrameBufferIsDefaultFrameBuffer()||this._engine.restoreDefaultFramebuffer(),t&&this._clearFrameBuffer(e)},i.prototype._clearFrameBuffer=function(e){if(!(e&&e._multiviewTexture))if(e&&e.outputRenderTarget){var t=e.outputRenderTarget;t.onClearObservable.hasObservers()?t.onClearObservable.notifyObservers(this._engine):t.skipInitialClear||(this.autoClear&&this._engine.clear(t.clearColor||this.clearColor,!t._cleared,!0,!0),t._cleared=!0)}else this._defaultFrameBufferCleared?this._engine.clear(null,!1,!0,!0):(this._defaultFrameBufferCleared=!0,this._clear())},i.prototype._renderForCamera=function(e,t,r){var s,n,a;if(r===void 0&&(r=!0),!(e&&e._skipRendering)){var o=this._engine;if(this._activeCamera=e,!this.activeCamera)throw new Error("Active camera not set");if(o.setViewport(this.activeCamera.viewport),this.resetCachedMaterial(),this._renderId++,!this.prePass&&r){var u=!0;e._renderingMultiview&&e.outputRenderTarget&&(u=e.outputRenderTarget.skipInitialClear,this.autoClear&&(e.outputRenderTarget.skipInitialClear=!1)),this._bindFrameBuffer(this._activeCamera),e._renderingMultiview&&e.outputRenderTarget&&(e.outputRenderTarget.skipInitialClear=u)}this.updateTransformMatrix(),this.onBeforeCameraRenderObservable.notifyObservers(this.activeCamera),this._evaluateActiveMeshes();for(var f=0;f<this._softwareSkinnedMeshes.length;f++){var d=this._softwareSkinnedMeshes.data[f];d.applySkeleton(d.skeleton)}this.onBeforeRenderTargetsRenderObservable.notifyObservers(this),this._renderTargets.concatWithNoDuplicate(this._materialsRenderTargets),e.customRenderTargets&&e.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(e.customRenderTargets),t&&t.customRenderTargets&&t.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(t.customRenderTargets),this.environmentTexture&&this.environmentTexture.isRenderTarget&&this._renderTargets.pushNoDuplicate(this.environmentTexture);for(var c=0,_=this._gatherActiveCameraRenderTargetsStage;c<_.length;c++){var p=_[c];p.action(this._renderTargets)}var g=!1;if(this.renderTargetsEnabled){if(this._intermediateRendering=!0,this._renderTargets.length>0){I.StartPerformanceCounter("Render targets",this._renderTargets.length>0);for(var b=0;b<this._renderTargets.length;b++){var y=this._renderTargets.data[b];if(y._shouldRender()){this._renderId++;var S=y.activeCamera&&y.activeCamera!==this.activeCamera;y.render(S,this.dumpNextRenderTargets),g=!0}}I.EndPerformanceCounter("Render targets",this._renderTargets.length>0),this._renderId++}for(var M=0,B=this._cameraDrawRenderTargetStage;M<B.length;M++){var p=B[M];g=p.action(this.activeCamera)||g}this._intermediateRendering=!1}this._engine.currentRenderPassId=(a=(n=(s=e.outputRenderTarget)===null||s===void 0?void 0:s.renderPassId)!==null&&n!==void 0?n:e.renderPassId)!==null&&a!==void 0?a:0,g&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1),this.onAfterRenderTargetsRenderObservable.notifyObservers(this),this.postProcessManager&&!e._multiviewTexture&&!this.prePass&&this.postProcessManager._prepareFrame();for(var O=0,R=this._beforeCameraDrawStage;O<R.length;O++){var p=R[O];p.action(this.activeCamera)}this.onBeforeDrawPhaseObservable.notifyObservers(this),o.snapshotRendering&&o.snapshotRenderingMode===1&&this.finalizeSceneUbo(),this._renderingManager.render(null,null,!0,!0),this.onAfterDrawPhaseObservable.notifyObservers(this);for(var P=0,D=this._afterCameraDrawStage;P<D.length;P++){var p=D[P];p.action(this.activeCamera)}if(this.postProcessManager&&!e._multiviewTexture){var X=e.outputRenderTarget?e.outputRenderTarget.renderTarget:void 0;this.postProcessManager._finalizeFrame(e.isIntermediate,X)}this._renderTargets.reset(),this.onAfterCameraRenderObservable.notifyObservers(this.activeCamera)}},i.prototype._processSubCameras=function(e,t){if(t===void 0&&(t=!0),e.cameraRigMode===0||e._renderingMultiview){e._renderingMultiview&&!this._multiviewSceneUbo&&this._createMultiviewUbo(),this._renderForCamera(e,void 0,t),this.onAfterRenderCameraObservable.notifyObservers(e);return}if(e._useMultiviewToSingleView)this._renderMultiviewToSingleView(e);else{this.onBeforeCameraRenderObservable.notifyObservers(e);for(var r=0;r<e._rigCameras.length;r++)this._renderForCamera(e._rigCameras[r],e)}this._activeCamera=e,this.updateTransformMatrix(),this.onAfterRenderCameraObservable.notifyObservers(e)},i.prototype._checkIntersections=function(){for(var e=0;e<this._meshesForIntersections.length;e++){var t=this._meshesForIntersections.data[e];if(!!t.actionManager)for(var r=function(n){var a=t.actionManager.actions[n];if(a.trigger===12||a.trigger===13){var o=a.getTriggerParameter(),u=o.mesh?o.mesh:o,f=u.intersectsMesh(t,o.usePreciseIntersection),d=t._intersectionsInProgress.indexOf(u);f&&d===-1?a.trigger===12?(a._executeCurrent(W.CreateNew(t,void 0,u)),t._intersectionsInProgress.push(u)):a.trigger===13&&t._intersectionsInProgress.push(u):!f&&d>-1&&(a.trigger===13&&a._executeCurrent(W.CreateNew(t,void 0,u)),(!t.actionManager.hasSpecificTrigger(13,function(c){var _=c.mesh?c.mesh:c;return u===_})||a.trigger===13)&&t._intersectionsInProgress.splice(d,1))}},s=0;t.actionManager&&s<t.actionManager.actions.length;s++)r(s)}},i.prototype._advancePhysicsEngineStep=function(e){},i.prototype._animate=function(){},i.prototype.animate=function(){if(this._engine.isDeterministicLockStep()){var e=Math.max(i.MinDeltaTime,Math.min(this._engine.getDeltaTime(),i.MaxDeltaTime))+this._timeAccumulator,t=this._engine.getTimeStep(),r=1e3/t/1e3,s=0,n=this._engine.getLockstepMaxSteps(),a=Math.floor(e/t);for(a=Math.min(a,n);e>0&&s<a;)this.onBeforeStepObservable.notifyObservers(this),this._animationRatio=t*r,this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(t),this.onAfterStepObservable.notifyObservers(this),this._currentStepId++,s++,e-=t;this._timeAccumulator=e<0?0:e}else{var e=this.useConstantAnimationDeltaTime?16:Math.max(i.MinDeltaTime,Math.min(this._engine.getDeltaTime(),i.MaxDeltaTime));this._animationRatio=e*(60/1e3),this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(e)}},i.prototype._clear=function(){(this.autoClearDepthAndStencil||this.autoClear)&&this._engine.clear(this.clearColor,this.autoClear||this.forceWireframe||this.forcePointsCloud,this.autoClearDepthAndStencil,this.autoClearDepthAndStencil)},i.prototype._checkCameraRenderTarget=function(e){var t;if((e==null?void 0:e.outputRenderTarget)&&!(e!=null&&e.isRigCamera)&&(e.outputRenderTarget._cleared=!1),!((t=e==null?void 0:e.rigCameras)===null||t===void 0)&&t.length)for(var r=0;r<e.rigCameras.length;++r){var s=e.rigCameras[r].outputRenderTarget;s&&(s._cleared=!1)}},i.prototype.resetDrawCache=function(e){if(!!this.meshes)for(var t=0,r=this.meshes;t<r.length;t++){var s=r[t];s.resetDrawCache(e)}},i.prototype.render=function(e,t){var r,s,n;if(e===void 0&&(e=!0),t===void 0&&(t=!1),!this.isDisposed){this.onReadyObservable.hasObservers()&&this._executeWhenReadyTimeoutId===null&&this._checkIsReady(),this._frameId++,this._defaultFrameBufferCleared=!1,this._checkCameraRenderTarget(this.activeCamera),!((r=this.activeCameras)===null||r===void 0)&&r.length&&this.activeCameras.forEach(this._checkCameraRenderTarget),this._registerTransientComponents(),this._activeParticles.fetchNewFrame(),this._totalVertices.fetchNewFrame(),this._activeIndices.fetchNewFrame(),this._activeBones.fetchNewFrame(),this._meshesForIntersections.reset(),this.resetCachedMaterial(),this.onBeforeAnimationsObservable.notifyObservers(this),this.actionManager&&this.actionManager.processTrigger(11),t||this.animate();for(var a=0,o=this._beforeCameraUpdateStage;a<o.length;a++){var u=o[a];u.action()}if(e){if(this.activeCameras&&this.activeCameras.length>0)for(var f=0;f<this.activeCameras.length;f++){var d=this.activeCameras[f];if(d.update(),d.cameraRigMode!==0)for(var c=0;c<d._rigCameras.length;c++)d._rigCameras[c].update()}else if(this.activeCamera&&(this.activeCamera.update(),this.activeCamera.cameraRigMode!==0))for(var c=0;c<this.activeCamera._rigCameras.length;c++)this.activeCamera._rigCameras[c].update()}this.onBeforeRenderObservable.notifyObservers(this);var _=this.getEngine();this.onBeforeRenderTargetsRenderObservable.notifyObservers(this);var p=!((s=this.activeCameras)===null||s===void 0)&&s.length?this.activeCameras[0]:this.activeCamera;if(this.renderTargetsEnabled){I.StartPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!0;for(var g=0;g<this.customRenderTargets.length;g++){var b=this.customRenderTargets[g];if(b._shouldRender()){if(this._renderId++,this.activeCamera=b.activeCamera||this.activeCamera,!this.activeCamera)throw new Error("Active camera not set");_.setViewport(this.activeCamera.viewport),this.updateTransformMatrix(),b.render(p!==this.activeCamera,this.dumpNextRenderTargets)}}I.EndPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!1,this._renderId++}this._engine.currentRenderPassId=(n=p==null?void 0:p.renderPassId)!==null&&n!==void 0?n:0,this.activeCamera=p,this._activeCamera&&this._activeCamera.cameraRigMode!==22&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1),this.onAfterRenderTargetsRenderObservable.notifyObservers(this);for(var y=0,S=this._beforeClearStage;y<S.length;y++){var u=S[y];u.action()}this._clearFrameBuffer(this.activeCamera);for(var M=0,B=this._gatherRenderTargetsStage;M<B.length;M++){var u=B[M];u.action(this._renderTargets)}var O=this._activeCamera;if(this.activeCameras&&this.activeCameras.length>0)for(var f=0;f<this.activeCameras.length;f++)this._processSubCameras(this.activeCameras[f],f>0);else{if(!this.activeCamera)throw new Error("No camera defined");this._processSubCameras(this.activeCamera,!!this.activeCamera.outputRenderTarget)}this._activeCamera=O,this._checkIntersections();for(var R=0,P=this._afterRenderStage;R<P.length;R++){var u=P[R];u.action()}if(this.afterRender&&this.afterRender(),this.onAfterRenderObservable.notifyObservers(this),this._toBeDisposed.length){for(var c=0;c<this._toBeDisposed.length;c++){var D=this._toBeDisposed[c];D&&D.dispose()}this._toBeDisposed.length=0}this.dumpNextRenderTargets&&(this.dumpNextRenderTargets=!1),this._activeBones.addCount(0,!0),this._activeIndices.addCount(0,!0),this._activeParticles.addCount(0,!0),this._engine.restoreDefaultFramebuffer()}},i.prototype.freezeMaterials=function(){for(var e=0;e<this.materials.length;e++)this.materials[e].freeze()},i.prototype.unfreezeMaterials=function(){for(var e=0;e<this.materials.length;e++)this.materials[e].unfreeze()},i.prototype.dispose=function(){var e;if(!this.isDisposed){this.beforeRender=null,this.afterRender=null,this.metadata=null,this.skeletons.length=0,this.morphTargetManagers.length=0,this._transientComponents.length=0,this._isReadyForMeshStage.clear(),this._beforeEvaluateActiveMeshStage.clear(),this._evaluateSubMeshStage.clear(),this._preActiveMeshStage.clear(),this._cameraDrawRenderTargetStage.clear(),this._beforeCameraDrawStage.clear(),this._beforeRenderTargetDrawStage.clear(),this._beforeRenderingGroupDrawStage.clear(),this._beforeRenderingMeshStage.clear(),this._afterRenderingMeshStage.clear(),this._afterRenderingGroupDrawStage.clear(),this._afterCameraDrawStage.clear(),this._afterRenderTargetDrawStage.clear(),this._afterRenderStage.clear(),this._beforeCameraUpdateStage.clear(),this._beforeClearStage.clear(),this._gatherRenderTargetsStage.clear(),this._gatherActiveCameraRenderTargetsStage.clear(),this._pointerMoveStage.clear(),this._pointerDownStage.clear(),this._pointerUpStage.clear(),this.importedMeshesFiles=new Array,this.stopAllAnimations&&this.stopAllAnimations(),this.resetCachedMaterial(),this.activeCamera&&(this.activeCamera._activeMeshes.dispose(),this.activeCamera=null),this._activeMeshes.dispose(),this._renderingManager.dispose(),this._processedMaterials.dispose(),this._activeParticleSystems.dispose(),this._activeSkeletons.dispose(),this._softwareSkinnedMeshes.dispose(),this._renderTargets.dispose(),this._materialsRenderTargets.dispose(),this._registeredForLateAnimationBindings.dispose(),this._meshesForIntersections.dispose(),this._toBeDisposed.length=0;for(var t=this._activeRequests.slice(),r=0,s=t;r<s.length;r++){var n=s[r];n.abort()}this._activeRequests.length=0,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onBeforeRenderObservable.clear(),this.onAfterRenderObservable.clear(),this.onBeforeRenderTargetsRenderObservable.clear(),this.onAfterRenderTargetsRenderObservable.clear(),this.onAfterStepObservable.clear(),this.onBeforeStepObservable.clear(),this.onBeforeActiveMeshesEvaluationObservable.clear(),this.onAfterActiveMeshesEvaluationObservable.clear(),this.onBeforeParticlesRenderingObservable.clear(),this.onAfterParticlesRenderingObservable.clear(),this.onBeforeDrawPhaseObservable.clear(),this.onAfterDrawPhaseObservable.clear(),this.onBeforeAnimationsObservable.clear(),this.onAfterAnimationsObservable.clear(),this.onDataLoadedObservable.clear(),this.onBeforeRenderingGroupObservable.clear(),this.onAfterRenderingGroupObservable.clear(),this.onMeshImportedObservable.clear(),this.onBeforeCameraRenderObservable.clear(),this.onAfterCameraRenderObservable.clear(),this.onReadyObservable.clear(),this.onNewCameraAddedObservable.clear(),this.onCameraRemovedObservable.clear(),this.onNewLightAddedObservable.clear(),this.onLightRemovedObservable.clear(),this.onNewGeometryAddedObservable.clear(),this.onGeometryRemovedObservable.clear(),this.onNewTransformNodeAddedObservable.clear(),this.onTransformNodeRemovedObservable.clear(),this.onNewMeshAddedObservable.clear(),this.onMeshRemovedObservable.clear(),this.onNewSkeletonAddedObservable.clear(),this.onSkeletonRemovedObservable.clear(),this.onNewMaterialAddedObservable.clear(),this.onNewMultiMaterialAddedObservable.clear(),this.onMaterialRemovedObservable.clear(),this.onMultiMaterialRemovedObservable.clear(),this.onNewTextureAddedObservable.clear(),this.onTextureRemovedObservable.clear(),this.onPrePointerObservable.clear(),this.onPointerObservable.clear(),this.onPreKeyboardObservable.clear(),this.onKeyboardObservable.clear(),this.onActiveCameraChanged.clear(),this.onComputePressureChanged.clear(),(e=this._computePressureObserver)===null||e===void 0||e.unobserve(),this._computePressureObserver=void 0,this.detachControl();var a=this._engine.getInputElement();if(a)for(var o=0;o<this.cameras.length;o++)this.cameras[o].detachControl();this._disposeList(this.animationGroups),this._disposeList(this.lights),this._disposeList(this.meshes,function(f){return f.dispose(!0)}),this._disposeList(this.transformNodes,function(f){return f.dispose(!0)}),this._disposeList(this.cameras),this._defaultMaterial&&this._defaultMaterial.dispose(),this._disposeList(this.multiMaterials),this._disposeList(this.materials),this._disposeList(this.particleSystems),this._disposeList(this.postProcesses),this._disposeList(this.textures),this._disposeList(this.morphTargetManagers),this._sceneUbo.dispose(),this._multiviewSceneUbo&&this._multiviewSceneUbo.dispose(),this.postProcessManager.dispose(),this._disposeList(this._components);var u=this._engine.scenes.indexOf(this);u>-1&&this._engine.scenes.splice(u,1),E._LastCreatedScene===this&&(this._engine.scenes.length>0?E._LastCreatedScene=this._engine.scenes[this._engine.scenes.length-1]:E._LastCreatedScene=null),u=this._engine._virtualScenes.indexOf(this),u>-1&&this._engine._virtualScenes.splice(u,1),this._engine.wipeCaches(!0),this._isDisposed=!0}},i.prototype._disposeList=function(e,t){var r=e.slice(0);t=t!=null?t:function(o){return o.dispose()};for(var s=0,n=r;s<n.length;s++){var a=n[s];t(a)}e.length=0},Object.defineProperty(i.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),i.prototype.clearCachedVertexData=function(){for(var e=0;e<this.meshes.length;e++){var t=this.meshes[e],r=t.geometry;r&&r.clearCachedData()}},i.prototype.cleanCachedTextureBuffer=function(){for(var e=0,t=this.textures;e<t.length;e++){var r=t[e],s=r._buffer;s&&(r._buffer=null)}},i.prototype.getWorldExtends=function(e){var t=new N(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),r=new N(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return e=e||function(){return!0},this.meshes.filter(e).forEach(function(s){if(s.computeWorldMatrix(!0),!(!s.subMeshes||s.subMeshes.length===0||s.infiniteDistance)){var n=s.getBoundingInfo(),a=n.boundingBox.minimumWorld,o=n.boundingBox.maximumWorld;N.CheckExtends(a,t,r),N.CheckExtends(o,t,r)}}),{min:t,max:r}},i.prototype.createPickingRay=function(e,t,r,s,n){throw C("Ray")},i.prototype.createPickingRayToRef=function(e,t,r,s,n,a,o){throw C("Ray")},i.prototype.createPickingRayInCameraSpace=function(e,t,r){throw C("Ray")},i.prototype.createPickingRayInCameraSpaceToRef=function(e,t,r,s){throw C("Ray")},i.prototype.pick=function(e,t,r,s,n,a){var o=new V;return o._pickingUnavailable=!0,o},i.prototype.pickWithBoundingInfo=function(e,t,r,s,n){var a=new V;return a._pickingUnavailable=!0,a},i.prototype.pickWithRay=function(e,t,r,s){throw C("Ray")},i.prototype.multiPick=function(e,t,r,s,n){throw C("Ray")},i.prototype.multiPickWithRay=function(e,t,r){throw C("Ray")},i.prototype.setPointerOverMesh=function(e,t,r){this._inputManager.setPointerOverMesh(e,t,r)},i.prototype.getPointerOverMesh=function(){return this._inputManager.getPointerOverMesh()},i.prototype._rebuildGeometries=function(){for(var e=0,t=this.geometries;e<t.length;e++){var r=t[e];r._rebuild()}for(var s=0,n=this.meshes;s<n.length;s++){var a=n[s];a._rebuild()}this.postProcessManager&&this.postProcessManager._rebuild();for(var o=0,u=this._components;o<u.length;o++){var f=u[o];f.rebuild()}for(var d=0,c=this.particleSystems;d<c.length;d++){var _=c[d];_.rebuild()}if(this.spriteManagers)for(var p=0,g=this.spriteManagers;p<g.length;p++){var b=g[p];b.rebuild()}},i.prototype._rebuildTextures=function(){for(var e=0,t=this.textures;e<t.length;e++){var r=t[e];r._rebuild()}this.markAllMaterialsAsDirty(1)},i.prototype._getByTags=function(e,t,r){if(t===void 0)return e;var s=[];r=r||function(o){};for(var n in e){var a=e[n];x&&x.MatchesQuery(a,t)&&(s.push(a),r(a))}return s},i.prototype.getMeshesByTags=function(e,t){return this._getByTags(this.meshes,e,t)},i.prototype.getCamerasByTags=function(e,t){return this._getByTags(this.cameras,e,t)},i.prototype.getLightsByTags=function(e,t){return this._getByTags(this.lights,e,t)},i.prototype.getMaterialByTags=function(e,t){return this._getByTags(this.materials,e,t).concat(this._getByTags(this.multiMaterials,e,t))},i.prototype.getTransformNodesByTags=function(e,t){return this._getByTags(this.transformNodes,e,t)},i.prototype.setRenderingOrder=function(e,t,r,s){t===void 0&&(t=null),r===void 0&&(r=null),s===void 0&&(s=null),this._renderingManager.setRenderingOrder(e,t,r,s)},i.prototype.setRenderingAutoClearDepthStencil=function(e,t,r,s){r===void 0&&(r=!0),s===void 0&&(s=!0),this._renderingManager.setRenderingAutoClearDepthStencil(e,t,r,s)},i.prototype.getAutoClearDepthStencilSetup=function(e){return this._renderingManager.getAutoClearDepthStencilSetup(e)},Object.defineProperty(i.prototype,"blockMaterialDirtyMechanism",{get:function(){return this._blockMaterialDirtyMechanism},set:function(e){this._blockMaterialDirtyMechanism!==e&&(this._blockMaterialDirtyMechanism=e,e||this.markAllMaterialsAsDirty(63))},enumerable:!1,configurable:!0}),i.prototype.markAllMaterialsAsDirty=function(e,t){if(!this._blockMaterialDirtyMechanism)for(var r=0,s=this.materials;r<s.length;r++){var n=s[r];t&&!t(n)||n.markAsDirty(e)}},i.prototype._loadFile=function(e,t,r,s,n,a,o){var u=this,f=J(e,t,r,s?this.offlineProvider:void 0,n,a,o);return this._activeRequests.push(f),f.onCompleteObservable.add(function(d){u._activeRequests.splice(u._activeRequests.indexOf(d),1)}),f},i.prototype._loadFileAsync=function(e,t,r,s,n){var a=this;return new Promise(function(o,u){a._loadFile(e,function(f){o(f)},t,r,s,function(f,d){u(d)},n)})},i.prototype._requestFile=function(e,t,r,s,n,a,o){var u=this,f=$(e,t,r,s?this.offlineProvider:void 0,n,a,o);return this._activeRequests.push(f),f.onCompleteObservable.add(function(d){u._activeRequests.splice(u._activeRequests.indexOf(d),1)}),f},i.prototype._requestFileAsync=function(e,t,r,s,n){var a=this;return new Promise(function(o,u){a._requestFile(e,function(f){o(f)},t,r,s,function(f){u(f)},n)})},i.prototype._readFile=function(e,t,r,s,n){var a=this,o=Q(e,t,r,s,n);return this._activeRequests.push(o),o.onCompleteObservable.add(function(u){a._activeRequests.splice(a._activeRequests.indexOf(u),1)}),o},i.prototype._readFileAsync=function(e,t,r){var s=this;return new Promise(function(n,a){s._readFile(e,function(o){n(o)},t,r,function(o){a(o)})})},i.prototype.getPerfCollector=function(){throw C("performanceViewerSceneExtension")},i.FOGMODE_NONE=0,i.FOGMODE_EXP=1,i.FOGMODE_EXP2=2,i.FOGMODE_LINEAR=3,i.MinDeltaTime=1,i.MaxDeltaTime=1e3,i}(ie);m.prototype.setActiveCameraByID=function(l){return this.setActiveCameraById(l)};m.prototype.getLastMaterialByID=function(l){return this.getLastMaterialById(l)};m.prototype.getMaterialByID=function(l){return this.getMaterialById(l)};m.prototype.getTextureByUniqueID=function(l){return this.getTextureByUniqueId(l)};m.prototype.getCameraByID=function(l){return this.getCameraById(l)};m.prototype.getCameraByUniqueID=function(l){return this.getCameraByUniqueId(l)};m.prototype.getBoneByID=function(l){return this.getBoneById(l)};m.prototype.getLightByID=function(l){return this.getLightById(l)};m.prototype.getLightByUniqueID=function(l){return this.getLightByUniqueId(l)};m.prototype.getParticleSystemByID=function(l){return this.getParticleSystemById(l)};m.prototype.getGeometryByID=function(l){return this.getGeometryById(l)};m.prototype.getMeshByID=function(l){return this.getMeshById(l)};m.prototype.getMeshesByID=function(l){return this.getMeshesById(l)};m.prototype.getTransformNodeByID=function(l){return this.getTransformNodeById(l)};m.prototype.getTransformNodeByUniqueID=function(l){return this.getTransformNodeByUniqueId(l)};m.prototype.getTransformNodesByID=function(l){return this.getTransformNodesById(l)};m.prototype.getMeshByUniqueID=function(l){return this.getMeshByUniqueId(l)};m.prototype.getLastMeshByID=function(l){return this.getLastMeshById(l)};m.prototype.getLastEntryByID=function(l){return this.getLastEntryById(l)};m.prototype.getNodeByID=function(l){return this.getNodeById(l)};m.prototype.getLastSkeletonByID=function(l){return this.getLastSkeletonById(l)};export{m as S};
