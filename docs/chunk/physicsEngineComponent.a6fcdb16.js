import{L as h,O as r}from"./precisionDate.911053b8.js";import{A as n}from"./abstractMesh.2a621fb8.js";import{a as t,S as p}from"./scene.600fc970.js";import{P as c}from"./physicsEngine.7712aca7.js";import{P as y}from"./physicsJoint.eb621db1.js";import"./performanceConfigurator.3a0adc9f.js";import"./math.vector.dbc48609.js";import"./arrayTools.49f8ffa1.js";import"./engine.030dae1e.js";import"./perfCounter.20926986.js";import"./engine.dynamicBuffer.1561c86f.js";import"./math.plane.3df9f77f.js";import"./decorators.033fe02c.js";import"./math.color.a4c793a9.js";import"./node.c2e9b9af.js";import"./math.axis.99d5e86d.js";import"./boundingInfo.536615f6.js";import"./lightConstants.3b1d6040.js";import"./math.functions.8d0abdec.js";t.prototype.getPhysicsEngine=function(){return this._physicsEngine};t.prototype.enablePhysics=function(s,i){if(s===void 0&&(s=null),this._physicsEngine)return!0;var e=this._getComponent(p.NAME_PHYSICSENGINE);e||(e=new m(this),this._addComponent(e));try{return this._physicsEngine=new c(s,i),this._physicsTimeAccumulator=0,!0}catch(o){return h.Error(o.message),!1}};t.prototype.disablePhysicsEngine=function(){!this._physicsEngine||(this._physicsEngine.dispose(),this._physicsEngine=null)};t.prototype.isPhysicsEnabled=function(){return this._physicsEngine!==void 0};t.prototype.deleteCompoundImpostor=function(s){var i=s.parts[0].mesh;i.physicsImpostor&&(i.physicsImpostor.dispose(),i.physicsImpostor=null)};t.prototype._advancePhysicsEngineStep=function(s){if(this._physicsEngine){var i=this._physicsEngine.getSubTimeStep();if(i>0)for(this._physicsTimeAccumulator+=s;this._physicsTimeAccumulator>i;)this.onBeforePhysicsObservable.notifyObservers(this),this._physicsEngine._step(i/1e3),this.onAfterPhysicsObservable.notifyObservers(this),this._physicsTimeAccumulator-=i;else this.onBeforePhysicsObservable.notifyObservers(this),this._physicsEngine._step(s/1e3),this.onAfterPhysicsObservable.notifyObservers(this)}};Object.defineProperty(n.prototype,"physicsImpostor",{get:function(){return this._physicsImpostor},set:function(s){var i=this;this._physicsImpostor!==s&&(this._disposePhysicsObserver&&this.onDisposeObservable.remove(this._disposePhysicsObserver),this._physicsImpostor=s,s&&(this._disposePhysicsObserver=this.onDisposeObservable.add(function(){i.physicsImpostor&&(i.physicsImpostor.dispose(),i.physicsImpostor=null)})))},enumerable:!0,configurable:!0});n.prototype.getPhysicsImpostor=function(){return this.physicsImpostor};n.prototype.applyImpulse=function(s,i){return this.physicsImpostor?(this.physicsImpostor.applyImpulse(s,i),this):this};n.prototype.setPhysicsLinkWith=function(s,i,e,o){return!this.physicsImpostor||!s.physicsImpostor?this:(this.physicsImpostor.createJoint(s.physicsImpostor,y.HingeJoint,{mainPivot:i,connectedPivot:e,nativeParams:o}),this)};var m=function(){function s(i){var e=this;this.name=p.NAME_PHYSICSENGINE,this.scene=i,this.scene.onBeforePhysicsObservable=new r,this.scene.onAfterPhysicsObservable=new r,this.scene.getDeterministicFrameTime=function(){return e.scene._physicsEngine?e.scene._physicsEngine.getTimeStep()*1e3:1e3/60}}return s.prototype.register=function(){},s.prototype.rebuild=function(){},s.prototype.dispose=function(){this.scene.onBeforePhysicsObservable.clear(),this.scene.onAfterPhysicsObservable.clear(),this.scene._physicsEngine&&this.scene.disablePhysicsEngine()},s}();export{m as PhysicsEngineSceneComponent};
